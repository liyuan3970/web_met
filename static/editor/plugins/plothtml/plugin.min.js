tinymce.PluginManager.add('plothtml', function (editor, url) {


  var openDialog = function () {
    return editor.windowManager.open({
      title: '画图:',
      body: {
        type: 'panel',
        width:1200,
        items: [
          {
            type: 'htmlpanel', // component type
            html: '<div id="test_plot" style="width:100%;height:400px;border:3px solid black"></div>'
          }
        ]
      },
      buttons: [
        {
          type: 'cancel',
          text: '关闭'
        },
        {
          type: 'submit',
          text: '插入',
          primary: true
        }
      ],
      onSubmit: function (api) {
        var data = api.getData();
        // console.log(data)
        // 将输入框内容插入到内容区光标位置
        var chartDom = document.getElementById('test_plot');
        var myChart = echarts.init(chartDom);
        var option;

        option = {
          xAxis: {
            type: 'category',
            data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']
          },
          yAxis: {
            type: 'value'
          },
          series: [
            {
              data: [150, 230, 224, 218, 135, 147, 260],
              type: 'line'
            }
          ]
        };

        option && myChart.setOption(option);
        // $('#test_plot').html("666")
        editor.insertContent("666");
        // api.close();


      }
    });
  };

  // 注册一个工具栏按钮名称
  editor.ui.registry.addButton('plothtml', {
    text: '画图',
    onAction: function () {
      openDialog();
    }
  });



});


