<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="static/editor/tinymce.min.js"></script>
    <script src="static/editor/vendor/FileSaver.js"></script>
    <script src="static/editor/html-docx.js"></script>
    <title>test_demo</title>
</head>

<body>
    <h1>tinymce的测序demo</h1>
    <p>Enter/paste your document here:</p>
    <textarea id="content" cols="60" rows="10">
      <p>We all live in a yellow submarine, yellow submarine, yellow submarine, yellow submarine</p>
      <p>Images can also be exported if you source them as base64 DATA URI.</p>
  
    </textarea>
    <div class="page-orientation">
        <span>Page orientation:</span>
        <label><input type="radio" name="orientation" value="portrait" checked>Portrait</label>
        <label><input type="radio" name="orientation" value="landscape">Landscape</label>
    </div>
    <button id="convert">Convert</button>
    <div id="download-area"></div>
    <script>
        tinymce.init({
            selector: '#content',
            plugins: [
                "advlist autolink lists link image charmap print preview anchor",
                "searchreplace visualblocks code fullscreen fullpage",
                "insertdatetime media table contextmenu paste"
            ],
            toolbar: "insertfile undo redo | styleselect | bold italic | " +
                "alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | " +
                "link image"
        });
        document.getElementById('convert').addEventListener('click', function () {

            var contentDocument = tinymce.get('content').getContent();
            var converted = htmlDocx.asBlob(contentDocument)
            console.log(typeof (converted), converted)

            saveAs(converted, 'test.docx')





        });

    </script>

</body>

</html>