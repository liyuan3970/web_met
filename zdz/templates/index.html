<!DOCTYPE html>
<html lang="en" class="scrollbar_self">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=2.0, user-scalable=yes"/>
    <!-- <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests" /> -->
    <script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/popper.js/1.15.0/umd/popper.min.js"></script>
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="static/css/jquery.datetimepicker.css"/>
    <script src="static/js/jquery.datetimepicker.full.min.js"></script>
    <!-- echart -->
    <script type="text/javascript" src="static/js/echarts.min.js"></script>
    <script type="text/javascript" src="static/js/echarts-gl.min.js"></script>
    <script type="text/javascript" src="static/js/ecStat.min.js"></script>
    <script type="text/javascript" src="static/js/dataTool.min.js"></script>
    <script type="text/javascript" src="static/js/china.js"></script>
    <script type="text/javascript" src="static/js/world.js"></script>
    <!-- leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
          integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
            integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM=" crossorigin=""></script>
    <!-- 使用turf -->
    <script src="https://unpkg.com/@turf/turf/turf.min.js"></script>
    <!-- tinymce -->
    <script src="static/editor/tinymce.min.js"></script>
    <script src="static/editor/vendor/FileSaver.js"></script>
    <script src="static/editor/html-docx.js"></script>
    <script src="static/js/pdfobject.js"></script>
    <!-- 数据 -->
    <script src='static/js/taizhou.js'></script>
    <script src='static/js/taizhoulist.js'></script>
    <script src='static/js/taizhouxiangzhen.js'></script>
    <!-- 引入 layui.css -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/layui/2.7.6/css/layui.css" rel="stylesheet">
    <!-- 引入 layui.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/layui/2.7.6/layui.js"></script>

    <!-- 颜色选择器 -->
    <script src="static/js/colorpicker.js"></script>
    <link rel="stylesheet" href="static/css/colorpicker.css">
    <style type="text/css">
        .scrollbar_self::-webkit-scrollbar {
            display: none;
        }

        .menu-ui {
            background: #fff;
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 999;
            border-radius: 3px;
            width: 120px;
            border: 1px solid rgba(0, 0, 0, 0.4);
        }

        .menu-self-ui {
            background: #fff;
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 999;
            border-radius: 3px;
            width: 120px;
            border: 1px solid rgba(0, 0, 0, 0.4);
        }

        .my-div-icon {
            font-size: 20px;
            /* border:1px solid black; */
            /* width: 600px;
            height:150px; */
            /*background:red;*/
            /*width:5px;*/
            color: rgb(22, 21, 21);
        }

        .label_plot_text {
            font-size: 15px;
            /* border:1px solid black; */
            /* width: 600px;
            height:150px; */
            /*background:red;*/
            /*width:5px;*/
            color: rgb(22, 21, 21);
        }


        /* html {

                overflow-x: hidden;

                overflow-y: hidden;

            } */
    </style>
    <title>决策服务模板平台</title>

</head>

<body>
<!-- 全局布局 -->
<div
        style="display: flex;align-content:flex-start;position: absolute; justify-content: center; flex-wrap: wrap; width: 100%;height: 100%;  background-color: rgb(243, 244, 247)">
    <!-- 导航栏 -->
    {% csrf_token %}
    <div style="background-color:rgb(119, 160, 236); width: 100%; height: 5%;">
        <div class="tabbable" id="tabs-01" style="display:block;width: 100%; height: 100%;">
            <ul class="nav nav-tabs" style="border-bottom: 0px;;font-size: 16px;font-weight:900;font-family:'宋体';">
                <li class="active">
                    <a href="#panel-1" data-toggle="tab">材料制作</a>
                </li>
                <li>
                    <a id="toolbox" href="#panel-2" data-toggle="tab">工具箱</a>
                </li>
                <!-- <li>

                        <a href="#panel-3" data-toggle="tab">画图</a>
                    </li> -->
                <li>
                    <!-- 另外添加一个说明文档 -->
                    <a id="awebsite" href="#panel-5" data-toggle="tab">快捷网址</a>
                </li>
                <li style="float: right;">
                    <!-- 另外添加一个说明文档 -->
                    <a href="#panel-4" data-toggle="tab">帮助</a>
                </li>
            </ul>
        </div>
    </div>
    <div id="index_main" style="background-color:rgb(220, 222, 226); width: 100%; height: 95%;display:flex ">
        <!-- 决策材料类型 -->
        <div style=" width: 50%; height: 100%;">
            <!-- 文件头 -->
            <div style=" width: 100%; height: 100%;">
                <!-- 材料类型选项卡 -->
                <div class="tab-content" style="display:block;width: 100%; height: 100%;">
                    <!-- tinymce -->
                    <div class="tab-pane active" id="panel-1" style="width:100%;height:100%;">
                        <div style="display:inline-block;width:100%;height:100%">
                            <!-- 打开功能的实现 -->
                            <div style="width: 100%; height: 0px;">
                                <a id="modal-000001" href="#modal-container-000001" role="button" class="btn"
                                   data-toggle="modal">新建</a>
                                <a id="modal-000002" href="#modal-container-000002" role="button" class="btn"
                                   data-toggle="modal">打开</a>
                                <a id="modal-000003" href="#modal-container-000003" role="button" class="btn"
                                   data-toggle="modal">删除</a>
                                <a id="modal-000004" href="#modal-container-000004" role="button" class="btn"
                                   data-toggle="modal">配置</a>
                                <!-- <div id="button_type_list" style="display: inline-flex;width:50%;height:80%"></div> -->

                                <!-- 新建 -->
                                <div class="modal fade" id="modal-container-000001" role="dialog"
                                     aria-labelledby="myModalLabel" aria-hidden="true">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <button type="button" class="close" data-dismiss="modal"
                                                        aria-hidden="true"></button>
                                                <h4 class="modal-title" id="myModalLabel">
                                                    新建材料:
                                                </h4>
                                            </div>
                                            <div class="modal-body" style="height: 450px;">
                                                <div style="display: inline-flex;width:100%;height:100%;">
                                                    <div style="width:15%;height:100%;">

                                                    </div>
                                                    <!-- 新建材料的核心数据 -->
                                                    <div style="width:70%;height:100%;border:1px solid black">
                                                        <div style="width:100%;height:13%;"></div>
                                                        <div style="display:inline-block; ;width:100%;height:15%;">
                                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;材料种类:
                                                            <select id="new_document_type"
                                                                    style="width:60%;height:80%;border:0">
                                                            </select>
                                                        </div>
                                                        <div style="display:inline-block; ;width:100%;height:15%;">
                                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;撰稿人:&nbsp;&nbsp;&nbsp;&nbsp;
                                                            <select id="new_document_writer"
                                                                    style="width:20%;height:80%;border:0"></select>
                                                            &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;签发人:
                                                            <select id="new_document_publisher"
                                                                    style="width:20%;height:80%;border:0"></select>
                                                        </div>
                                                        <div style="display:inline-block; ;width:100%;height:15%;">
                                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;发布单位:
                                                            <select id="new_document_unity"
                                                                    style="width:60%;height:80%;border:0"></select>
                                                        </div>
                                                        <div style="display:inline-block; ;width:100%;height:15%;">
                                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;发布日期:
                                                            <input id="create_doc_date" type="text"
                                                                   placeholder="请选择日期"
                                                                   style="width:60%;height:50%;border:1px solid black;text-align: center;"
                                                                   ;>
                                                        </div>
                                                        <div style="display:inline-block;;width:100%;height:10%;">
                                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;模块类型:
                                                            <div
                                                                    style="display:inline-flex;width:60%;height:80%">
                                                                <div
                                                                        style="width:10%;height:100%;;border:1px solid black">
                                                                    <div style=";width:100%;height:50%">
                                                                        <select id="png_text_add" autocomplete="off"
                                                                                style="appearance:none;border: none;width:100%;height:100%;background-image: url(static/src/加.png);background-size: 50%;background-repeat: no-repeat;">
                                                                            <option style="display:none;" selected>
                                                                            </option>
                                                                            <option value="段落">段落</option>
                                                                            <option value="图表">图表</option>
                                                                            <option value="列表">列表</option>
                                                                            <option value="短期">短期</option>
                                                                            <option value="十天">七天</option>
                                                                            <option value="建议">建议</option>
                                                                        </select>

                                                                    </div>
                                                                    <div style=";width:100%;height:50%">
                                                                        <button id="delete_png_text"
                                                                                style=";width:100%;border: none;background-color:white;height:100%;background-image: url(static/src/减.png);background-size: 60%;background-repeat: no-repeat;"></button>
                                                                    </div>

                                                                </div>
                                                                <div id="png_add_list"
                                                                     style="display:flex;width:90%;height:100%;padding-top: 3px;;border:1px solid black">

                                                                </div>
                                                                <script>
                                                                    let png_add_list = []
                                                                    $('#png_text_add').change(function () {
                                                                        var select_div = document.createElement('div');
                                                                        select_div.style = "display:inline-block;;width:15%;height:100%;background-image: url(static/src/" + $('#png_text_add').val() + ".png);background-size: 80%;background-repeat: no-repeat;"
                                                                        $('#png_add_list').append(select_div)
                                                                        png_add_list.push($('#png_text_add').val())
                                                                        // 取消select 文字
                                                                        $('#png_text_add').prop('selectedIndex', 0);
                                                                    })
                                                                    $('#delete_png_text').click(function () {
                                                                        $('#png_add_list').children().eq(-1).remove()
                                                                        png_add_list.pop()
                                                                        // console.log(png_add_list)

                                                                    })


                                                                </script>
                                                            </div>

                                                        </div>
                                                        <script>
                                                            $('#create_doc_date').datetimepicker({
                                                                    theme: 'dark',
                                                                    format: 'Y-m-d H:i'
                                                                }
                                                            );
                                                        </script>
                                                    </div>
                                                    <div style="width:15%;height:100%;">

                                                    </div>

                                                </div>

                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-default"
                                                        data-dismiss="modal">返回
                                                </button>
                                                <button id="new_document_post" type="button" class="btn btn-primary"
                                                        data-dismiss="modal">创建
                                                </button>
                                            </div>
                                            <script>
                                                // 后端数据的传输
                                                const list_button_object = {
                                                    type_list: ['段落', '图表'],
                                                    type: "一周天气预测",
                                                    data: [],
                                                    item: 47,
                                                    year: 2022,
                                                    unity: "台州市气象局",
                                                    writer: "翁之梅",
                                                    publisher: "冯坚",
                                                    time: "2022年8月12日15时",
                                                    localitem: undefined,
                                                    cerate_div_button: function () {
                                                        $('#button_type_list').html("")
                                                        for (var i = 0; i < this.type_list.length; i++) {
                                                            this.data.push(this.render_data_list(i))
                                                            var div_single = document.createElement("div")
                                                            div_single.style = "width: 15%; height: 30px;;padding-top:6px"
                                                            var button_single = document.createElement("button")
                                                            button_single.setAttribute("class", "checkitem")
                                                            button_single.value = i
                                                            button_single.style = "width: 100%; height: 30px;background-image: url(static/src/button/" + this.type_list[i] + ".png);background-size: 100%;background-repeat: no-repeat"

                                                            div_single.append(button_single)
                                                            button_single.addEventListener("click", function (doc) {
                                                                // console.log('内容', doc,this)
                                                                var item = Number(this.value)
                                                                var content = list_button_object.data[item]
                                                                list_button_object.localitem = item
                                                                tinymce.remove('#content');
                                                                tinymce.init({
                                                                    selector: '#content',
                                                                    language: 'zh_CN',
                                                                    branding: false,
                                                                    skin: 'oxide-dark',
                                                                    promotion: false,
                                                                    plugin_plothtml_width: "300%",
                                                                    menubar: false,
                                                                    plugins: "newfile openfile advlist anchor autolink autosave charmap code codesample emoticons footer fullscreen help image importcss indent2em insertdatetime link lists media nonbreaking pagebreak plothtml preview quickbars save searchreplace table template visualblocks wordcount",
                                                                    toolbar: [
                                                                        "newfile openfile urldialog",
                                                                        "insertfile undo redo bold italic underline hr |alignleft aligncenter alignright formatselect fontselect fontsizeselect removeformat subscript superscript charmap searchreplace insertdatetime forecolor backcolor fontsize fontfamily",//段落
                                                                        "image code link unlink rotateleft rotateright flipv fliph editimage imageoptions quickimage | table | bullist numlist| | footer plothtml"
                                                                    ],
                                                                    font_family_formats: "宋体='宋体';仿宋='仿宋';微软雅黑='微软雅黑';楷体='楷体';;隶书='隶书';幼圆='幼圆';Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings",
                                                                    font_size_formats: '12px 14px 16px 18px 20px 24px 26px 28px 30px 32px 34px 36px 38px',
                                                                    setup: (editor) => {
                                                                        editor.ui.registry.addButton('urldialog', {
                                                                            // icon: 'code',
                                                                            text: '快速画图',
                                                                            onAction: () => editor.windowManager.openUrl({
                                                                                title: '画图页面',
                                                                                url: 'http://127.0.0.1:9001/canvas_plot',
                                                                                height: 820,
                                                                                width: 1300,
                                                                            })
                                                                        })
                                                                    },


                                                                });
                                                                $('#content').val(content)

                                                            })
                                                            $('#button_type_list').append(div_single)
                                                        }

                                                    },
                                                    render_data_list: function (item) {
                                                        var doc_type = this.type_list[item]
                                                        var id_number = item
                                                        var doc_data_obj = {
                                                            type: doc_type,
                                                            id: id_number,
                                                            content: ""
                                                        }
                                                        return doc_data_obj
                                                    },
                                                    render_head_info: function () {

                                                        var line1 = '<p style="text-align: center;"><span style="font-size: 36pt; color: rgb(224, 62, 45);">' + this.type + '</span></p>'
                                                        var line2 = '<p style="text-align: center;"><span style="font-size: 12pt; color: rgb(0, 0, 0); font-family: \'times new roman\', times, serif;">第' + this.item.toString() + '期</span></p>'
                                                        var line3 = '<table style=" width: 100%;border:none;"><colgroup><col style="width: 33.3333%;"><col style="width: 33.3333%;"><col style="width: 33.3333%;"></colgroup>'
                                                        var line4 = '<tbody><tr><td style="border-width: 1px;">&nbsp;</td><td style="border-width: 1px;">&nbsp;</td>'
                                                        var line5 = '<td style="border-width: 1px; text-align: right;"><span style="font-family: "times new roman", times, serif;">撰稿人：' + this.writer + '</span></td>'
                                                        var line6 = '</tr><tr>'
                                                        var line7 = '<td style="border-width: 1px;"><span style="font-family: \'times new roman\', times, serif;">' + this.time + '</span></td>'
                                                        var line8 = '<td style="border-width: 1px; text-align: center;">' + this.unity + '</td>'
                                                        var line9 = '<td style="border-width: 1px; text-align: right;">签发人：' + this.publisher + '</td>'
                                                        var line10 = '</tr></tbody></table>'
                                                        var line11 = '<hr style="background-color:  #FF0000;">'
                                                        var headerInfo = line1 + line2 + line3 + line4 + line5 + line6 + line7 + line8 + line9 + line10 + line11
                                                        return headerInfo
                                                    }
                                                }


                                                $('#new_document_post').click(function () {

                                                    var csrf = $('input[name="csrfmiddlewaretoken"]').val();
                                                    // console.log("向后端传输创建信息", png_add_list)
                                                    var content_doc = ""
                                                    for (var i = 0; i < png_add_list.length; i++) {
                                                        content_doc = content_doc + png_add_list[i] + ","

                                                    }

                                                    // 告诉后端创建一个新的数据，并在前端修改文档标识
                                                    $.ajax({
                                                        url: "create_doc_data",  // 请求的地址
                                                        type: "post",  // 请求方式
                                                        timeout: 250, //设置延迟上限
                                                        data: {
                                                            'csrfmiddlewaretoken': csrf,
                                                            'doc_type': $('#new_document_type').val(),
                                                            'doc_writer': $('#new_document_writer').val(),
                                                            'doc_publisher': $('#new_document_publisher').val(),
                                                            'doc_unity': $('#new_document_unity').val(),
                                                            'doc_date': $('#create_doc_date').val(),
                                                            'doc_list': content_doc
                                                        },
                                                        dataType: "json",
                                                        success: function (data) {
                                                            // 返回以后创建一个对象实例
                                                            // console.log("返回成功", data)
                                                            $('#doc_type').text(data.doc_unity)
                                                            $('#doc_info').text("第" + data.doc_item + "期:  " + data.doc_type)
                                                            list_button_object.year = data.doc_year
                                                            list_button_object.item = data.doc_item
                                                            list_button_object.type = data.doc_type
                                                            list_button_object.type_list = png_add_list
                                                            list_button_object.unity = data.doc_unity
                                                            list_button_object.cerate_div_button()
                                                        }
                                                    })

                                                })
                                            </script>
                                        </div>

                                    </div>

                                </div>
                                <script type="text/javascript">
                                    $('#modal-000001').click(function () {
                                        // console.log('新建文档')
                                        png_add_list = []
                                        $('#png_add_list').html("")
                                        var csrf = $('input[name="csrfmiddlewaretoken"]').val();
                                        $.ajax({
                                            url: "create_new_doc",  // 请求的地址
                                            type: "post",  // 请求方式
                                            timeout: 250, //设置延迟上限
                                            data: {
                                                'csrfmiddlewaretoken': csrf
                                            },
                                            dataType: "json",
                                            success: function (data) {
                                                // 'data_publisher': data_publisher,
                                                // 'data_writers': data_writers,
                                                // 'data_unity': data_unity,
                                                // 'data_documenttype': data_documenttype
                                                $('#new_document_publisher').html("")
                                                $('#new_document_writer').html("")
                                                $('#new_document_unity').html("")
                                                $('#new_document_type').html("")
                                                for (i = 0; i < data.data_publisher.length; i++) {
                                                    var option_publisher = document.createElement('option');
                                                    option_publisher.value = data.data_publisher[i]
                                                    option_publisher.innerText = data.data_publisher[i]
                                                    $('#new_document_publisher').append(option_publisher)
                                                }
                                                for (j = 0; j < data.data_writers.length; j++) {
                                                    var option_writers = document.createElement('option');
                                                    option_writers.value = data.data_writers[j]
                                                    option_writers.innerText = data.data_writers[j]
                                                    $('#new_document_writer').append(option_writers)
                                                }
                                                for (k = 0; k < data.data_unity.length; k++) {
                                                    var option_unity = document.createElement('option');
                                                    option_unity.value = data.data_unity[k]
                                                    option_unity.innerText = data.data_unity[k]
                                                    option_unity.style.textAlign = 'center'
                                                    $('#new_document_unity').append(option_unity)
                                                }
                                                for (m = 0; m < data.data_documenttype.length; m++) {
                                                    var option_documenttype = document.createElement('option');
                                                    option_documenttype.value = data.data_documenttype[m]
                                                    option_documenttype.innerText = data.data_documenttype[m]
                                                    option_documenttype.style.textAlign = 'center'
                                                    $('#new_document_type').append(option_documenttype)
                                                }


                                            }

                                        })
                                    })

                                    $('#modal-000002').click(function () {
                                        // console.log('打开文档')
                                        $('#open_item_list').html('')
                                        var csrf = $('input[name="csrfmiddlewaretoken"]').val();
                                        $.ajax({
                                            url: "open_old_doc",  // 请求的地址
                                            type: "post",  // 请求方式
                                            timeout: 250, //设置延迟上限
                                            data: {
                                                'csrfmiddlewaretoken': csrf
                                            },
                                            dataType: "json",
                                            success: function (data) {
                                                // console.log(data.type,data.year,data.unity)
                                                $('#open_select_type').html("")
                                                for (i = 0; i < data.type.length; i++) {
                                                    var option_type = document.createElement('option');
                                                    option_type.value = data.type[i]
                                                    option_type.innerText = data.type[i]
                                                    $('#open_select_type').append(option_type)
                                                }
                                                $('#open_select_year').html("")
                                                for (i = 0; i < data.year.length; i++) {
                                                    var option_year = document.createElement('option');
                                                    option_year.value = data.year[i]
                                                    option_year.innerText = data.year[i]
                                                    $('#open_select_year').append(option_year)
                                                }
                                                $('#open_select_unity').html("")
                                                for (i = 0; i < data.unity.length; i++) {
                                                    var option_unity = document.createElement('option');
                                                    option_unity.value = data.unity[i]
                                                    option_unity.innerText = data.unity[i]
                                                    $('#open_select_unity').append(option_unity)
                                                }

                                            }
                                        })
                                    })
                                </script>
                                <!-- 打开 -->
                                <div class="modal fade" id="modal-container-000002" role="dialog"
                                     aria-labelledby="myModalLabel" aria-hidden="true">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <button type="button" class="close" data-dismiss="modal"
                                                        aria-hidden="true"></button>
                                                <h4 class="modal-title" id="myModalLabel">
                                                    打开材料
                                                </h4>
                                            </div>
                                            <div class="modal-body" style="height: 300px;">
                                                <div
                                                        style="display:inline-block;width:100%;height: 100%;border: 3px solid black">
                                                    <!-- <div style="width:100%;height: 25%">
                                                        </div> -->
                                                    <!-- 选项栏 -->
                                                    <div style="display: inline-block;width:100%;height: 15%;">
                                                        <select id="open_select_type"
                                                                style="width: 30%;height:100%;">

                                                        </select>
                                                        <div style="display: inline-block;width: 5%;"></div>
                                                        <select id="open_select_year"
                                                                style="width: 15%;height:100%;">

                                                        </select>
                                                        <div style="display: inline-block;width: 5%;"></div>
                                                        <select id="open_select_unity"
                                                                style="width: 30%;height:100%;">

                                                        </select>
                                                        <input id="open_document_post" type="button" value="查询"
                                                               style="width:10%;height:100%">
                                                        <script type="text/javascript">

                                                        </script>

                                                    </div>
                                                    <script type="text/javascript">
                                                        $('#open_document_post').click(function () {
                                                            console.log($('#open_select_type').val())
                                                            var csrf = $('input[name="csrfmiddlewaretoken"]').val();


                                                            // 告诉后端打开一个新的数据，并在前端修改文档标识
                                                            $.ajax({
                                                                url: "open_doc_data",  // 请求的地址
                                                                type: "post",  // 请求方式
                                                                timeout: 250, //设置延迟上限
                                                                data: {
                                                                    'csrfmiddlewaretoken': csrf,
                                                                    'type': $('#open_select_type').val(),
                                                                    'unity': $('#open_select_unity').val(),
                                                                    'year': $('#open_select_year').val(),

                                                                },
                                                                dataType: "json",
                                                                success: function (data) {
                                                                    // 返回以后创建一个对象实例
                                                                    // console.log("返回成功", data)
                                                                    $('#open_item_list').html("")
                                                                    for (i = 0; i < data.item.length; i++) {
                                                                        var div_label = document.createElement('div');
                                                                        div_label.style = "width:100%;height:8%;"

                                                                        var label = document.createElement('label');
                                                                        label.setAttribute("for", "item" + i.toString())
                                                                        label.innerText = "第" + data.item[i] + "期:" + "-----" + data.type[i] + "----" + data.writer[i]

                                                                        var checkitem = document.createElement('input')
                                                                        checkitem.setAttribute("type", "radio")
                                                                        checkitem.setAttribute("name", "load_doc_list")
                                                                        checkitem.id = "item" + i.toString()
                                                                        checkitem.style = "display:none"
                                                                        checkitem.value = i.toString() + "-" + data.year + "-" + data.unity + "-" + data.type[i]
                                                                        div_label.append(label, checkitem)

                                                                        $('#open_item_list').append(div_label)
                                                                    }

                                                                }
                                                            })

                                                        })


                                                    </script>
                                                    <!-- 加载的栏目 -->
                                                    <div id="open_item_list" class="scrollbar_self"
                                                         style="width:100%;height: 85%;border: 1px solid black;overflow-x: hidden;overflow-y:scroll;">
                                                    </div>

                                                </div>

                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-default"
                                                        data-dismiss="modal">关闭
                                                </button>
                                                <button id="open_load_object" type="button" class="btn btn-primary"
                                                        data-dismiss="modal">加载
                                                </button>
                                            </div>
                                            <script type="text/javascript">
                                                $('#open_load_object').click(function () {
                                                    // console.log($('#load_open_object').val())
                                                    var upload_data = $("input[name='load_doc_list']:checked").val()
                                                    console.log("返回", $("input[name='load_doc_list']:checked").val())
                                                    var csrf = $('input[name="csrfmiddlewaretoken"]').val();
                                                    // 告诉后端打开一个新的数据，并在前端修改文档标识
                                                    $.ajax({
                                                        url: "open_load_object",  // 请求的地址
                                                        type: "post",  // 请求方式
                                                        timeout: 250, //设置延迟上限
                                                        data: {
                                                            'csrfmiddlewaretoken': csrf,
                                                            'info': upload_data
                                                        },
                                                        dataType: "json",
                                                        success: function (res) {
                                                            // 返回以后创建一个对象实例
                                                            console.log("返回成功", res)
                                                            $('#doc_type').text(res.type)
                                                            $('#doc_info').text("第" + res.item + "期:  " + res.type)
                                                            list_button_object.year = res.year
                                                            list_button_object.item = res.item
                                                            list_button_object.type = res.type
                                                            list_button_object.type_list = res.type_list
                                                            list_button_object.unity = res.unity
                                                            list_button_object.cerate_div_button()
                                                            list_button_object.data = res.content_list
                                                        }
                                                    })

                                                })

                                            </script>
                                        </div>

                                    </div>

                                </div>
                                <!-- 删除 -->
                                <div class="modal fade" id="modal-container-000003" role="dialog"
                                     aria-labelledby="myModalLabel" aria-hidden="true">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <button type="button" class="close" data-dismiss="modal"
                                                        aria-hidden="true"></button>
                                                <h4 class="modal-title" id="myModalLabel">
                                                    删除材料
                                                </h4>
                                            </div>
                                            <div class="modal-body" style="height: 600px;">

                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-default"
                                                        data-dismiss="modal">关闭
                                                </button>
                                                <button type="button" class="btn btn-primary">保存
                                                </button>
                                            </div>
                                        </div>

                                    </div>

                                </div>
                                <!-- 配置 -->
                                <div class="modal fade" id="modal-container-000004" role="dialog"
                                     aria-labelledby="myModalLabel" aria-hidden="true">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <button type="button" class="close" data-dismiss="modal"
                                                        aria-hidden="true"></button>
                                                <h4 class="modal-title" id="myModalLabel">
                                                    标题
                                                </h4>
                                            </div>
                                            <div class="modal-body" style="height: 600px;">
                                                <input type="button" value="模块自定义" style="width:100%;height:10%">
                                                <input type="button" value="文档种类" style="width:100%;height:10%">
                                                <input type="button" value="参考网页" style="width:100%;height:10%">
                                                <input type="button" value="密码账号" style="width:100%;height:10%">
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-default"
                                                        data-dismiss="modal">关闭
                                                </button>
                                                <button type="button" class="btn btn-primary">保存
                                                </button>
                                            </div>
                                        </div>

                                    </div>

                                </div>


                                <!-- 文件头 -->
                            </div>
                            <div style="display:inline-flex;width: 100%; height: 96%">

                                    <textarea id="content" style="width:100%;height: 100%;">

                                    </textarea>

                            </div>
                            <div style="display: inline-flex;width:100%;height: 5%;">
                                <div style="width:85%;height: 100%;">
                                    <h5 id="doc_unity" style="float:left;width:20%">台州市气象局</h5>
                                    <h5 id="doc_info" style="float:left;width:20%">第47期:一周天气</h5>
                                    <div id="button_type_list" style="display: inline-flex;width:55%;height:80%">
                                    </div>
                                </div>
                                <button id="convert3"
                                        style="width:40px;height:40px;background-image: url(static/src/合并.png);background-size: 100%;background-repeat: no-repeat;"></button>
                                <div style="width:2%;height: 100%;"></div>
                                <button id="preview_save"
                                        style="width:40px;height:40px;background-image: url(static/src/保存.png);background-size: 100%;background-repeat: no-repeat;"></button>
                                <div style="width:2%;height: 100%;"></div>
                                <button id="save_doc_all"
                                        style="width:40px;height:40px;background-image: url(static/src/发布.png);background-size: 100%;background-repeat: no-repeat;"></button>
                                <div style="width:2%;height: 100%;"></div>
                                <button id="convert"
                                        style="width:40px;height:40px;background-image: url(static/src/预览.png);background-size: 100%;background-repeat: no-repeat;"></button>
                            </div>

                            <script>
                                tinymce.init({
                                    selector: '#content',
                                    language: 'zh_CN',
                                    branding: false,
                                    skin: 'oxide-dark',
                                    promotion: false,
                                    plugin_plothtml_width: "300%",
                                    menubar: false,
                                    plugins: "newfile openfile advlist anchor autolink autosave charmap code codesample emoticons footer fullscreen help image importcss indent2em insertdatetime link lists media nonbreaking pagebreak shortmet longmet advicemet preview quickbars save searchreplace table template visualblocks wordcount",
                                    toolbar: [
                                        "newfile openfile urldialog",
                                        "insertfile undo redo bold italic underline hr |alignleft aligncenter alignright formatselect fontselect fontsizeselect removeformat subscript superscript charmap searchreplace insertdatetime forecolor backcolor fontsize fontfamily",//段落
                                        "image code link unlink rotateleft rotateright flipv fliph editimage imageoptions quickimage | table | bullist numlist| | footer shortmet longmet advicemet"
                                    ],
                                    font_family_formats: "宋体='宋体';仿宋='仿宋';微软雅黑='微软雅黑';楷体='楷体';;隶书='隶书';幼圆='幼圆';Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings",
                                    font_size_formats: '12px 14px 16px 18px 20px 24px 26px 28px 30px 32px 34px 36px 38px',
                                    setup: (editor) => {
                                        editor.ui.registry.addButton('urldialog', {
                                            // icon: 'code',
                                            text: '快速画图',
                                            onAction: () => editor.windowManager.openUrl({
                                                title: '画图页面',
                                                url: 'http://127.0.0.1:9001/canvas_plot',
                                                height: 820,
                                                width: 1300,
                                            })
                                        })
                                    },


                                });

                                // 接收数据
                                window.addEventListener('message', function (event) {
                                    var data = event.data;
                                    console.log('message received from TinyMCE', data);
                                });


                                document.getElementById('convert').addEventListener('click', function () {
                                    //获取html的内容
                                    if (list_button_object.data.length > 0) {
                                        var contentDocument = ""
                                        for (var i = 0; i < list_button_object.data.length; i++) {
                                            contentDocument = contentDocument + list_button_object.data[i]
                                        }
                                    } else {
                                        var contentDocument = tinymce.get('content').getContent();
                                    }
                                    // 加载文件头
                                    var hearder = list_button_object.render_head_info()
                                    contentDocument = hearder + contentDocument
                                    //console.log(contentDocument)
                                    var formData = new FormData();
                                    formData.append("document", contentDocument);

                                    $.ajax({
                                        url: "file/pdf",  // 请求的地址
                                        type: "POST",  // 请求方式
                                        headers: {"Token": "Bearer " + localStorage.getItem("token")},// {#设置token#}
                                        data: formData,
                                        processData: false,
                                        contentType: false,
                                        enctype: "multipart/form-data",
                                        responseType: "arraybuffer",
                                        mimeType: "text/plain; charset=x-user-defined",
                                        success: function (data) {
                                            // console.log(data)
                                            var rawLength = data.length;
                                            var array = new Uint8Array(new ArrayBuffer(rawLength));
                                            for (i = 0; i < rawLength; i++) {
                                                array[i] = data.charCodeAt(i) & 0xff;
                                            }

                                            var pdfBlob = new Blob([array], {type: "application/pdf;charset=utf-8"})
                                            var pdfFile = URL.createObjectURL(pdfBlob)
                                            const options_pdf = {
                                                forcePDFJS: true,
                                                pdfOpenParams: {
                                                    pagemode: "thumbs",
                                                    navpanes: 0,
                                                    toolbar: 0,
                                                    scrollbar: 0,
                                                    statusbar: 0,
                                                    view: "FitV"
                                                }
                                            }


                                            PDFObject.embed(pdfFile, "#product_view", options_pdf);
                                        }

                                    })
                                });

                                // 全部保存
                                document.getElementById('save_doc_all').addEventListener('click', function () {
                                    //保存所有内容
                                    if (list_button_object.type_list.length > 0) {
                                        let data_list = [];
                                        let contentDocument = "";
                                        for (let i = 0; i < list_button_object.type_list.length; i++) {
                                            contentDocument = contentDocument + list_button_object.data[i]
                                            data_list.push(list_button_object.data[i])

                                        }

                                        let data = {
                                            "document": list_button_object.render_head_info() + contentDocument,
                                            "type": list_button_object.type,
                                            "name": list_button_object.type_list,
                                            "year": list_button_object.year,
                                            "data": data_list,
                                            "item": list_button_object.item,
                                            "unity": list_button_object.unity
                                        }

                                        $.ajax({
                                            url: "file/preview_all",
                                            type: "POST",
                                            headers: {"Token": "Bearer " + localStorage.getItem("token")},
                                            data: JSON.stringify(data),
                                            contentType: "application/json",
                                            responseType: "arraybuffer",
                                            mimeType: "text/plain; charset=x-user-defined",
                                            success: function (data) {
                                                let rawLength = data.length;
                                                let array = new Uint8Array(new ArrayBuffer(rawLength));
                                                for (let i = 0; i < rawLength; i++) {
                                                    array[i] = data.charCodeAt(i) & 0xff;
                                                }
                                                let pdfBlob = new Blob([array], {type: "application/pdf;charset=utf-8"})
                                                let pdfFile = URL.createObjectURL(pdfBlob)
                                                const options_pdf = {
                                                    forcePDFJS: true,
                                                    pdfOpenParams: {
                                                        pagemode: "thumbs",
                                                        navpanes: 0,
                                                        toolbar: 0,
                                                        scrollbar: 0,
                                                        statusbar: 0,
                                                        view: "FitV"
                                                    }
                                                }
                                                PDFObject.embed(pdfFile, "#product_view", options_pdf);
                                            }
                                        })

                                    }

                                })

                                document.getElementById('preview_save').addEventListener('click', function () {
                                    //保存并预览单个模块的内容
                                    var contentDocument = tinymce.get('content').getContent();
                                    //收集上传的数据
                                    var item = list_button_object.localitem
                                    var types = list_button_object.type
                                    var name = list_button_object.type_list[item]
                                    var year = list_button_object.year
                                    var data = contentDocument
                                    var items = list_button_object.item
                                    var unity = list_button_object.unity
                                    var hearder = list_button_object.render_head_info()
                                    contentDocument = hearder + contentDocument
                                    var formData = new FormData();
                                    formData.append("document", contentDocument);
                                    formData.append("item", item);
                                    formData.append("types", types);
                                    formData.append("name", name);
                                    formData.append("year", year);
                                    formData.append("data", data);
                                    formData.append("items", items);
                                    formData.append("unity", unity);
                                    $.ajax({
                                        url: "file/preview_save",  // 请求的地址
                                        type: "POST",  // 请求方式
                                        headers: {"Token": "Bearer " + localStorage.getItem("token")},
                                        data: formData,
                                        processData: false,
                                        contentType: false,
                                        enctype: "multipart/form-data",
                                        responseType: "arraybuffer",
                                        mimeType: "text/plain; charset=x-user-defined",
                                        success: function (data) {
                                            var rawLength = data.length;
                                            var array = new Uint8Array(new ArrayBuffer(rawLength));
                                            for (i = 0; i < rawLength; i++) {
                                                array[i] = data.charCodeAt(i) & 0xff;
                                            }

                                            var pdfBlob = new Blob([array], {type: "application/pdf;charset=utf-8"})
                                            var pdfFile = URL.createObjectURL(pdfBlob)
                                            const options_pdf = {
                                                forcePDFJS: true,
                                                pdfOpenParams: {
                                                    pagemode: "thumbs",
                                                    navpanes: 0,
                                                    toolbar: 0,
                                                    scrollbar: 0,
                                                    statusbar: 0,
                                                    view: "FitV"
                                                }
                                            }

                                            PDFObject.embed(pdfFile, "#product_view", options_pdf);
                                        }

                                    })
                                });

                            </script>

                        </div>

                    </div>
                    <div class="tab-pane" id="panel-2" style="width:100%;height:100%">
                        <div id="history_file" style="width:100%;height:35%;;padding: 15px;">
                            <div style="display:inline-block;width:100%;height:100%">
                                <div id="history_button"
                                     style="display:inline-block;width:100%;height:15%;background-color: white;border:1px solid black">

                                </div>

                                <div id="history_view" class="scrollbar_self"
                                     style="display:inline-block;width:100%;height:85%;background-color: white;border:1px solid black;overflow-x: hidden;overflow-y:scroll;">
                                    <div class="tool_history_button"
                                         style="display: inline-block;font-size: 20px;font-weight:900;font-family:'宋体';;height: 15%;width:100%;;vertical-align: middle;text-align:center;;padding:1px;;border-bottom: 1px solid black;padding-top:10px; ">
                                        <label
                                                style="width:10%;text-align:center;;vertical-align: middle">第1期</label>
                                        <label
                                                style="width:65%;text-align:center;vertical-align: middle;">一周天气预测</label>
                                        <label
                                                style="width:15%;text-align:center;vertical-align: middle;">翁之梅</label>
                                    </div>

                                    <div class="tool_history_button"
                                         style="display: inline-block;font-size: 20px;font-weight:900;font-family:'宋体';;height: 15%;width:100%;;vertical-align: middle;;text-align:center;padding:1px;;border-bottom: 1px solid black;padding-top:10px; ">
                                        <label
                                                style="width:10%;text-align:center;;vertical-align: middle;">第1期</label>
                                        <label
                                                style="width:65%;text-align:center;vertical-align: middle;">一周天气预测</label>
                                        <label
                                                style="width:15%;text-align:center;vertical-align: middle;">翁之梅</label>
                                    </div>

                                    <div class="tool_history_button"
                                         style="display: inline-block;font-size: 20px;font-weight:900;font-family:'宋体';;height: 15%;width:100%;;vertical-align: middle;;text-align:center;padding:1px;border-bottom: 1px solid black;padding-top:10px;">
                                        <label
                                                style="width:10%;text-align:center;;vertical-align: middle;">第1期</label>
                                        <label
                                                style="width:65%;text-align:center;vertical-align: middle;">一周天气预测</label>
                                        <label
                                                style="width:15%;text-align:center;vertical-align: middle;">翁之梅</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- <div style="width:100%;height:1%;"></div> -->
                        <div style="width:97.5%;height:20%;background-color:white;margin:15px">
                            <div style="width:100%;height:15%;background-color:rgb(220, 222, 226);">
                                <h2
                                        style="text-align:center;background-color:rgb(45, 104, 221);width:15%;border-top-left-radius: 5px;border-top-right-radius:5px;font-size: 23px;font-weight:900;font-family:'宋体';color:white">
                                    市台短期</h2>
                            </div>
                            <div
                                    style="display: inline-flex;width:100%;height:20%;text-align:center;align-items: center;">
                                <div style="height: 100%;width:2%;"></div>
                                <div style="height: 100%;width:10%;font-size: 20px;vertical-align: middle">
                                    <label for="08input">08</label>&nbsp;&nbsp;<input type="radio"
                                                                                      name="tz_self_time" value="08"
                                                                                      checked="checked" id="08input">

                                </div>
                                <div style="height: 100%;width:1%;">
                                </div>
                                <div style="height: 100%;width:10%;font-size: 20px;vertical-align: middle">
                                    <label for="20input">20</label>&nbsp;&nbsp;<input type="radio"
                                                                                      name="tz_self_time" value="20"
                                                                                      id="20input">

                                </div>
                            </div>
                            <div
                                    style="display: inline-flex;width:100%;height:60%;text-align:center;align-items: center;">

                                <div style="width:15%;height:80%;"></div>
                                <div
                                        style="display:inline-block;width:8%;height:60%;background-color: rgb(220, 222, 226);;border-radius: 10px;">
                                    <div
                                            style="width:100%;height:50%;text-align:center;;vertical-align: middle;margin:5px">
                                        <label for="T_short"
                                               style="padding-right:10%;padding-top: 10%;">短期气温</label>
                                    </div>
                                    <div style="width:100%;height:50%;">
                                        <input type="radio" name="tz_self" value="T" class="tool_prodict_product"
                                               id="T_short" style="width: 100%;height:50%;padding-bottom: 10%;">
                                    </div>
                                </div>
                                <div style="width:1%;height:80%;"></div>

                                <div style="width:1%;height:80%;"></div>
                                <div
                                        style="display:inline-block;width:8%;height:60%;background-color: rgb(220, 222, 226);;border-radius: 10px;">
                                    <div
                                            style="width:100%;height:50%;text-align:center;;vertical-align: middle;margin:5px">
                                        <label for="Pr01_short"
                                               style="padding-right:10%;padding-top: 10%;">短期降水</label>
                                    </div>
                                    <div style="width:100%;height:50%;">
                                        <input type="radio" name="tz_self" value="Pr01" class="tool_prodict_product"
                                               id="Pr01_short" style="width: 100%;height:50%;padding-bottom: 10%;">
                                    </div>
                                </div>
                                <div style="width:1%;height:80%;"></div>

                                <div style="width:1%;height:80%;"></div>
                                <div
                                        style="display:inline-block;width:8%;height:60%;background-color: rgb(220, 222, 226);;border-radius: 10px;">
                                    <div
                                            style="width:100%;height:50%;text-align:center;;vertical-align: middle;margin:5px">
                                        <label for="Pr24_short"
                                               style="padding-right:10%;padding-top: 10%;">降水</label>
                                    </div>
                                    <div style="width:100%;height:50%;">
                                        <input type="radio" name="tz_self" value="Pr12" class="tool_prodict_product"
                                               id="Pr24_short" style="width: 100%;height:50%;padding-bottom: 10%;">
                                    </div>
                                </div>
                                <div style="width:1%;height:80%;"></div>

                                <div style="width:1%;height:80%;"></div>
                                <div
                                        style="display:inline-block;width:8%;height:60%;background-color: rgb(220, 222, 226);;border-radius: 10px;">
                                    <div
                                            style="width:100%;height:50%;text-align:center;;vertical-align: middle;margin:5px">
                                        <label for="TMax24_short"
                                               style="padding-right:10%;padding-top: 10%;">高温</label>
                                    </div>
                                    <div style="width:100%;height:50%;">
                                        <input type="radio" name="tz_self" value="TMax24"
                                               class="tool_prodict_product" id="TMax24_short"
                                               style="width: 100%;height:50%;padding-bottom: 10%;">
                                    </div>
                                </div>
                                <div style="width:1%;height:80%;"></div>

                                <div style="width:1%;height:80%;"></div>
                                <div
                                        style="display:inline-block;width:8%;height:60%;background-color: rgb(220, 222, 226);;border-radius: 10px;">
                                    <div
                                            style="width:100%;height:50%;text-align:center;;vertical-align: middle;margin:5px">
                                        <label for="TMin24_short"
                                               style="padding-right:10%;padding-top: 10%;">低温</label>
                                    </div>
                                    <div style="width:100%;height:50%;">
                                        <input type="radio" name="tz_self" value="TMin24"
                                               class="tool_prodict_product" id="TMin24_short"
                                               style="width: 100%;height:50%;padding-bottom: 10%;">
                                    </div>
                                </div>
                                <div style="width:1%;height:80%;"></div>

                                <div style="width:1%;height:80%;"></div>
                                <div
                                        style="display:inline-block;width:8%;height:60%;background-color: rgb(220, 222, 226);;border-radius: 10px;">
                                    <div
                                            style="width:100%;height:50%;text-align:center;;vertical-align: middle;margin:5px">
                                        <label for="Cloud_7day_short"
                                               style="padding-right:10%;padding-top: 10%;">短期云量</label>
                                    </div>
                                    <div style="width:100%;height:50%;">
                                        <input type="radio" name="tz_self" value="Cloud"
                                               class="tool_prodict_product" id="Cloud_7day_short"
                                               style="width: 100%;height:50%;padding-bottom: 10%;">
                                    </div>
                                </div>
                                <div style="width:1%;height:80%;"></div>

                                <div style="width:1%;height:80%;"></div>
                                <div
                                        style="display:inline-block;width:8%;height:60%;background-color: rgb(220, 222, 226);;border-radius: 10px;">
                                    <div
                                            style="width:100%;height:50%;text-align:center;;vertical-align: middle;margin:5px">
                                        <label for="Wind_short"
                                               style="padding-right:10%;padding-top: 10%;">特殊天气</label>
                                    </div>
                                    <div style="width:100%;height:50%;">
                                        <input type="radio" name="tz_self" value="Special12"
                                               class="tool_prodict_product" id="Wind_short"
                                               style="width: 100%;height:50%;padding-bottom: 10%;">
                                    </div>
                                </div>
                                <div style="width:1%;height:80%;"></div>


                            </div>


                        </div>

                        <div style="width:97.5%;height:10%;background-color:white;margin:15px">
                            <div style="width:100%;height:28%;background-color:rgb(220, 222, 226);">
                                <h2
                                        style="text-align:center;background-color:rgb(45, 104, 221);width:15%;border-top-left-radius: 5px;border-top-right-radius:5px;font-size: 23px;font-weight:900;font-family:'宋体';color:white">
                                    周报查询</h2>
                            </div>
                            <div style="display: inline-flex;width:100%;height:72%;">
                                <div style="width:15%;height:100%;"></div>
                                <div style="width:65%;height:100%;padding-top:2% ;">
                                    <label>自动站</label>&nbsp;&nbsp;&nbsp;
                                    <label style="width:10%;height:60%;">&nbsp;&nbsp;&nbsp;</label>
                                    <input id="datetimepicker_history1" type="text" placeholder="起始时间"
                                           style="width: 20%;height:60%; text-align:center;vertical-align: middle;align-items: center; ">
                                    <label style="width:10%;height:60%;">&nbsp;&nbsp;&nbsp;</label>
                                    <label>&nbsp;&nbsp;&nbsp;&nbsp;至&nbsp;&nbsp;&nbsp;</label>
                                    <label style="width:5%;height:60%;">&nbsp;&nbsp;&nbsp;</label>
                                    <input id="datetimepicker_history2" type="text" placeholder="结束时间"
                                           style="width: 20%;height:60%; text-align:center;vertical-align: middle;align-items: center; ">

                                    <input id="tool_zdz_button" type="button"
                                           style="width: 8%;height:60% ;border: 0px ;float: right;background-color: white;background-image: url(static/src/查询.png);background-size: 50%;background-repeat: no-repeat;">

                                    <script>

                                        $('#datetimepicker_history1').datetimepicker(
                                            {
                                                theme: 'dark',
                                                format: 'Y-m-d H:i'
                                            }
                                        );
                                        $("#datetimepicker_history1").datetimepicker("setDate", new Date());
                                        $('#datetimepicker_history2').datetimepicker(
                                            {
                                                theme: 'dark',
                                                format: 'Y-m-d H:i'
                                            }
                                        );
                                    </script>
                                </div>
                            </div>


                        </div>
                        <div style="width:97.5%;height:10%;background-color:white;margin:15px">
                            <script type="text/javascript" src="static/js/乡镇名称.js"></script>
                            <div style="width:100%;height:100%; ;">
                                <div style="width:100%;height:28%;background-color:rgb(220, 222, 226);">
                                    <h2
                                            style="text-align:center;background-color:rgb(45, 104, 221);width:15%;border-top-left-radius: 5px;border-top-right-radius:5px;font-size: 23px;font-weight:900;font-family:'宋体';color:white">
                                        十天预报</h2>
                                </div>
                                <div style="display:inline-flex;width:100%;height:72%;">
                                    <div style="width:15%;height:100%;"></div>
                                    <div style="width:65%;height:100%;padding-top:2% ;">
                                        <select id="ec_map">
                                            <option value="city">台州市</option>
                                            <option value="county">县市区</option>
                                        </select>
                                        &nbsp;&nbsp;&nbsp;
                                        <label style="width:10%;height:60%;">&nbsp;&nbsp;&nbsp;</label>
                                        <input type="text" placeholder="起始时间"
                                               style="width: 20%;height:60%; text-align:center;vertical-align: middle;align-items: center; ">
                                        <label style="width:10%;height:60%;">&nbsp;&nbsp;&nbsp;</label>
                                        <label>&nbsp;&nbsp;&nbsp;&nbsp;至&nbsp;&nbsp;&nbsp;</label>
                                        <label style="width:5%;height:60%;">&nbsp;&nbsp;&nbsp;</label>
                                        <input type="text" placeholder="结束时间"
                                               style="width: 20%;height:60%; text-align:center;vertical-align: middle;align-items: center; ">

                                        <input id="tool_ec_button" type="button"
                                               style="width: 8%;height:60% ;border: 0px ;float: right;background-color: white;background-image: url(static/src/查询.png);background-size: 50%;background-repeat: no-repeat;">


                                    </div>


                                    <!-- <div style="display:flex;width:100%;height:50%;padding-top:3%;">
                                                <div id="color_demo" style="width:10%;height:100%;background-color: #0000ff"></div>
                                                <script>
                                                    $(function () {
                                                        $('#color_demo').ColorPicker({
                                                            onChange: function (hsb, hex, rgb) {
                                                                console.log("颜色",hex)
                                                                $('#color_demo').val("#" + hex);//设置文本框的值为选定的RGB颜色
                                                                $('#color_demo').css('backgroundColor','#'+hex);//设置文本框的背景颜色为选定的RGB颜色
                                                            }

                                                        });
                                                    });
                                                </script>
                                                <input id="tool_ec_button" type="button"
                                                    style="width: 8%;height:60% ;border: 0px ;float: right;background-color: white;background-image: url(static/src/查询.png);background-size: 40%;background-repeat: no-repeat;">
                                            </div>
                                        </div> -->


                                </div>


                            </div>


                        </div>
                        <div style="width:97.5%;height:10%;background-color:white;margin:15px">

                            <div style="width:100%;height:100%; ;">
                                <div style="width:100%;height:28%;background-color:rgb(220, 222, 226);">
                                    <h2
                                            style="text-align:center;background-color:rgb(45, 104, 221);width:15%;border-top-left-radius: 5px;border-top-right-radius:5px;font-size: 23px;font-weight:900;font-family:'宋体';color:white">
                                        降水订正</h2>
                                </div>
                                <div style="display:inline-flex;width:100%;height:72%;">
                                    <div style="width:15%;height:100%;"></div>
                                    <div style="width:65%;height:100%;padding-top:2% ;">
                                        <select id="self_plot_country">
                                            <option value="taizhou">台州市</option>
                                            <option value="yuhuan">玉环</option>
                                            <option value="wenling">温岭</option>
                                            <option value="jiaojiang">椒江</option>
                                            <option value="luqiao">路桥</option>
                                            <option value="huangyan">黄岩</option>
                                            <option value="linhai">临海</option>
                                            <option value="tiantai">天台</option>
                                            <option value="xianju">仙居</option>
                                            <option value="sanmen">三门</option>


                                        </select>
                                        &nbsp;&nbsp;&nbsp;
                                        <label style="width:10%;height:60%;">&nbsp;&nbsp;&nbsp;</label>
                                        <select id="select_self_plot" type="text"
                                                style="width: 55%;height:60%; text-align:center;vertical-align: middle;align-items: center; ">

                                        </select>


                                        <input id="tool_selfplot_button" type="button"
                                               style="width: 8%;height:60% ;border: 0px ;float: right;background-color: white;background-image: url(static/src/查询.png);background-size: 50%;background-repeat: no-repeat;">


                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <script>
                        $('#toolbox').click(function () {
                            // $('#history_file').html(" ")
                            $('#history_button').html(" ")
                            $('#history_view').html(" ")
                            var csrf = $('input[name="csrfmiddlewaretoken"]').val();
                            $.ajax({
                                url: "history_file",  // 请求的地址
                                type: "post",  // 请求方式
                                timeout: 250, //设置延迟上限
                                data: {
                                    'csrfmiddlewaretoken': csrf
                                },
                                dataType: "json",
                                success: function (data) {
                                    var self_title = data.self_title
                                    var view_first = data.doc_list[0]
                                    for (i = 0; i < view_first['filelist'].length; i++) {
                                        var divcontenter = document.createElement('div')
                                        divcontenter.style = "display: inline-block;font-size: 20px;font-weight:900;font-family:'宋体';;height: 15%;width:100%;;vertical-align: middle;text-align:center;;padding:1px;;border-bottom: 1px solid black;padding-top:10px; "
                                        divcontenter.setAttribute("class", "tool_history_button")
                                        var labelitem = document.createElement('label')
                                        labelitem.style = "width:15%;text-align:center;;vertical-align: middle"
                                        labelitem.innerText = "第" + view_first['filelist'][i]['item'].toString() + "期"

                                        var labeltype = document.createElement('label')
                                        labeltype.style = "width:55%;text-align:center;;vertical-align: middle"
                                        labeltype.innerText = view_first['filelist'][i]['type'].toString()

                                        var labelwriter = document.createElement('label')
                                        labelwriter.style = "width:15%;text-align:center;;vertical-align: middle"
                                        labelwriter.innerText = view_first['filelist'][i]['year']
                                        divcontenter.append(labelitem, labeltype, labelwriter)
                                        $('#history_view').append(divcontenter)

                                    }


                                    var button_list = data.doc_list
                                    for (var i = 0; i < button_list.length; i++) {
                                        var button = document.createElement('button')
                                        button.style.display = "inline-flex"
                                        button.style.width = "10%"
                                        button.style.height = "100%"
                                        button.id = "history" + i.toString()
                                        button.innerText = button_list[i]['name']
                                        button.addEventListener("click", function (e) {
                                            $('#history_view').html(" ")
                                            var item = parseInt(e.path[0].id[7])

                                            for (i = 0; i < button_list[item]['filelist'].length; i++) {
                                                var divcontenter = document.createElement('div')
                                                divcontenter.style = "display: inline-block;font-size: 20px;font-weight:900;font-family:'宋体';;height: 15%;width:100%;;vertical-align: middle;text-align:center;;padding:1px;;border-bottom: 1px solid black;padding-top:10px; "
                                                divcontenter.setAttribute("class", "tool_history_button")
                                                var labelitem = document.createElement('label')
                                                labelitem.style = "width:15%;text-align:center;;vertical-align: middle"
                                                labelitem.innerText = "第" + button_list[item]['filelist'][i]['item'].toString() + "期"

                                                var labeltype = document.createElement('label')
                                                labeltype.style = "width:55%;text-align:center;;vertical-align: middle"
                                                labeltype.innerText = button_list[item]['filelist'][i]['type'].toString()

                                                var labelwriter = document.createElement('label')
                                                labelwriter.style = "width:15%;text-align:center;;vertical-align: middle"
                                                labelwriter.innerText = button_list[item]['filelist'][i]['year']
                                                divcontenter.append(labelitem, labeltype, labelwriter)
                                                $('#history_view').append(divcontenter)

                                            }
                                            $('.tool_history_button').click(function () {
                                                var type = "tool_history"
                                                console.log(this.attr)
                                                product_view_show(type)


                                            })


                                        })


                                        $('#history_button').append(button)
                                    }

                                    $('.tool_history_button').click(function () {
                                        var type = "tool_history"
                                        console.log("tool_history_button")
                                        product_view_show(type)


                                    })
                                    $("select_self_plot").html("")
                                    var select_self_plot = document.getElementById("select_self_plot")
                                    for (var i = 0; i < self_title.length; i++) {
                                        var option_plot = document.createElement("option")
                                        option_plot.innerText = self_title[i].types
                                        option_plot.value = self_title[i].id

                                        select_self_plot.append(option_plot)

                                    }

                                    // console.log(data)
                                }
                            })
                        })

                    </script>


                    <div class="tab-pane" id="panel-4"
                         style="width:100%;height:100%;background-color:rgb(8, 116, 167)">
                        <p>
                            帮助
                        </p>
                    </div>
                    <div class="tab-pane" id="panel-5"
                         style="width:100%;height:100%;background-color:white;overflow: auto ;">
                        <div id="website"
                             style="display:flex;flex-wrap: wrap;align-content:flex-start;width:100%;height:100%;justify-content: center;align-items: center;">
                            <div id="webbutton" style="width:100%;height:5%;border: 1px solid black">

                            </div>
                            <div id="webview" style="width:100%;height:95%;border: 1px solid black">
                            </div>
                        </div>

                    </div>
                    <script>
                        $('#awebsite').click(function () {
                            // $('#website').html(" ")
                            var csrf = $('input[name="csrfmiddlewaretoken"]').val();
                            $.ajax({
                                url: "website",  // 请求的地址
                                type: "post",  // 请求方式
                                timeout: 250, //设置延迟上限
                                data: {
                                    'csrfmiddlewaretoken': csrf
                                },
                                dataType: "json",
                                success: function (data) {
                                    $('#webbutton').html("")
                                    $('#webview').html("")
                                    for (i = 0; i < data.first.length; i++) {
                                        var imgsrc = "media/" + data.first[i]['src']
                                        var singleimg = document.createElement('a')
                                        singleimg.style = style = "display:inline-block;width:24.5%;height:25%;border:3px solid black;background-image: url(" + imgsrc + ");font-size: 25px;color:red;text-align:center;line-height: 230px; "
                                        singleimg.setAttribute("href", "http://www.baidu.com")
                                        singleimg.setAttribute("target", "_Blank")
                                        $('#webview').append(singleimg)


                                    }


                                    var button_list = data.class_dir
                                    for (i = 0; i < button_list.length; i++) {
                                        var singlebutton = document.createElement('button')
                                        // background-image: url(static/src/预报.png);

                                        // singlebutton.style = "width:10%;height:100%;" + "background-image: url(" + imgsrc + ")"+";font-size: 15px;";
                                        singlebutton.style = "width:10%;height:100%;" + ";font-size: 15px;";
                                        singlebutton.innerText = button_list[i]['name']
                                        singlebutton.id = "buttonweb" + i.toString()
                                        singlebutton.addEventListener("click", function (e) {
                                            $('#webview').html("")
                                            var item = parseInt(e.path[0].id[9])
                                            var imglist = data.class_dir[item]["img_list"]
                                            for (i = 0; i < imglist.length; i++) {
                                                var imgsrc = "media/" + imglist[i]['src']
                                                var singleimg = document.createElement('a')
                                                singleimg.style = style = "display:inline-block;width:24.5%;height:25%;border:3px solid black;background-image: url(" + imgsrc + ");font-size: 25px;color:red;text-align:center;line-height: 230px; "
                                                // href="http://www.baidu.com" target="_Blank"
                                                singleimg.setAttribute("href", "http://www.baidu.com")
                                                singleimg.setAttribute("target", "_Blank")
                                                $('#webview').append(singleimg)

                                            }
                                            console.log(data)

                                        })

                                        $('#webbutton').append(singlebutton)

                                    }
                                }
                            })
                        })

                    </script>

                </div>


            </div>


        </div>


        <!-- 预览界面 -->
        <div style="width: 50%; height: 100%;overflow: hidden;">
            <!-- 产品图片 -->
            <div id="product_view" style="background-color:rgb(239, 243, 237); width: 100%; height: 100%;">
                <!-- 文件头 -->
                <div style="height:27%;width:100%;position: relative;background-color:white;">
                    <div
                            style="top:30%;height:10%;width:100%;position: absolute;text-align: center;font-size:50px ;font-family:'宋体';color:red">
                        一周天气预测(样板)
                    </div>
                    <div
                            style="top:60%;height:10%;width:100%;position: absolute;text-align: center;font-size:20px ;font-family:'宋体';">
                        第15期
                    </div>
                    <div
                            style="top:80%;;height:10%;width:100%;position: absolute;text-align: center;font-size:20px ;font-family:'宋体';">
                        台州市气象局
                    </div>
                    <div
                            style="top:80%;left:10% ;height:10%;width:100%;position: absolute;font-size:20px ;font-family:'宋体';">
                        2022年3月01日19时
                    </div>
                    <div
                            style="top:65%;left:80%;height:10%;width:100%;position: absolute;font-size:20px ;font-family:'宋体';">
                        撰稿人:翁之梅
                    </div>
                    <div
                            style="top:80%;left:80%;height:10%;width:100%;position: absolute;font-size:20px ;font-family:'宋体';">
                        签发人:高丽
                    </div>
                    <div style="top:95%;left:8%;height:1%;width:88%;;position: absolute;border: 2px solid red;">
                    </div>

                </div>
                <!-- 文件段落 -->

                <div
                        style="display:flex; justify-content:center align-items:center;height:auto;width:100%;background-color:white;font-size:20px ;font-family:'宋体';color:black;">
                    <div style="width: 10%;"></div>
                    <div style="width:80%;">
                        <p
                                style=";width:100% ;line-height:50px;font-size:25px ;font-family:'宋体';color:black;text-align: center;font-weight:bold">
                            本周前期天气阴沉，周后期强冷空气影响转晴冷天气
                        </p>
                        <p style=";width:100%;font-size:20px ;font-family:'宋体';color:black;">
                            一、短期预报
                        </p>
                        <p style="text-indent:2em;width:100% ;line-height:50px;;font-size:20px">
                            本周前期天气阴沉，周后期强冷空气影响转晴冷天气，全市有严重冰冻。今天、明天阴有分散性小雨，最高气温12～14度；后天多云到阴，夜里～周四受强冷空气影响有明显降温、大风和弱雨雪过程。，全市有严重冰冻。今天、明天阴有分散性小雨，最高气温12～14度；后天多云到阴，夜里～周四受强冷空气影响有明显降温、大风和弱雨雪过程。
                            本周前期天气阴沉，周后期强冷空气影响转晴冷天气，全市有严重冰冻。今天、明天阴有分散性小雨，最高气温12～14度；后天多云到阴，夜里～周四受强冷空气影响有明显降温、大风和弱雨雪过程。，全市有严重冰冻。今天、明天阴有分散性小雨，最高气温12～14度；后天多云到阴，夜里～周四受强冷空气影响有明显降温、大风和弱雨雪过程。
                        </p>

                    </div>
                </div>
                <!-- 文档列表  -->
                <div
                        style="display:flex; justify-content:center align-items:center;height:auto;width:100%;background-color:white;font-size:20px ;font-family:'宋体';color:black;line-height:50px;">
                    <div style="width: 10%;"></div>
                    <div style="width:80%;">
                        <p style=";width:100%;font-size:20px ;font-family:'宋体';color:black;;font-weight:bold">
                            台州市主城区具体天气预报如下：
                        </p>
                        <div
                                style="display:inline-block;text-indent:1.5em;width:100%;height: 40% ;line-height:50px;;font-size:20px;">
                            <p style="float:left;line-height:40px;">
                                4日（周一）：阴，部分地区有时有小雨区有时
                            </p>
                            <p style="float:right;line-height:40px;">
                                9～14度
                            </p>
                            <p style="float:left;line-height:40px;">
                                4日（周一）：阴，部分地区有时有小雨区有时
                            </p>
                            <p style="float:right;line-height:40px;">
                                9～14度
                            </p>
                            <p style="float:left;line-height:40px;">
                                4日（周一）：阴，部分地区有时有小雨区有时
                            </p>
                            <p style="float:right;line-height:40px;">
                                9～14度
                            </p>
                            <p style="float:left;line-height:40px;">
                                4日（周一）：阴，部分地区有时有小雨区有时
                            </p>
                            <p style="float:right;line-height:40px;">
                                9～14度
                            </p>

                        </div>


                    </div>
                </div>
                <!-- 文档图片  单图 -->


                <!-- 文档结尾 -->


            </div>

            <!-- 预览界面数据交互的核心代码 -->
            <script type="text/javascript" src='static/js/save_and_vue.js'></script>
            <script src='static/js/taizhou_village.js'></script>
            <script>
                // id为product_view的数据交互渲染函数
                function product_view_show(type) {
                    if (type == "plot_self") {
                        console.log("---------------绘图--------------------------")
                        $('#product_view').html(" ")
                        var self_plot_div = document.createElement('div')
                        self_plot_div.style = "width:100%;height:70%;"
                        self_plot_div.id = "self_plot_div"
                        $('#product_view').append(self_plot_div)

                        var analyze_div = document.createElement('div')
                        analyze_div.style = "display:inline-flex;width:100%;height:30%;overflow:auto"
                        canvas_bar = document.createElement('div')
                        canvas_bar.style = "width:60%;height:100%;overflow:auto"
                        canvas_bar.id = "canvas_bar"
                        analyze_div.append(canvas_bar)
                        // 表格数据
                        var table_div = document.createElement('div');
                        table_div.style = "width:40%;height:100%;overflow:auto"
                        var table = document.createElement('table');
                        table.setAttribute("class", "table table-bordered")

                        var caption = document.createElement('caption')
                        caption.innerText = "乡镇排行"
                        table_div.append(table)
                        table.append(caption)
                        table.innerHTML = "<thead><tr><th>排名</th><th>名称</th><th>降水</th></tr></thead><tbody>\
                                                                                                                                <tr><td>1</td><td>坎门</td><td>30mm</td></tr>\
                                                                                                                                <tr><td>2</td><td>淡竹</td><td>15mm</td></tr>\
                                                                                                                                <tr><td>3</td><td>淡竹</td><td>15mm</td></tr>\
                                                                                                                                <tr><td>3</td><td>淡竹</td><td>15mm</td></tr>\
                                                                                                                                <tr><td>3</td><td>淡竹</td><td>15mm</td></tr>\
                                                                                                                                <tr><td>3</td><td>淡竹</td><td>15mm</td></tr>\
                                                                                                                                </tbody>"

                        analyze_div.append(table_div)
                        $('#product_view').append(analyze_div)
                        var chartDom = document.getElementById('canvas_bar');
                        var myChart_bar = echarts.init(chartDom);
                        var option;

                        option = {
                            tooltip: {
                                trigger: 'axis',
                                axisPointer: {
                                    type: 'cross'
                                }
                            },
                            toolbox: {
                                feature: {
                                    dataView: {show: true, readOnly: false},
                                    restore: {show: true},
                                    saveAsImage: {show: true}
                                }
                            },
                            xAxis: {
                                type: 'category',
                                data: ['仙居', '玉环', '三门', '临海', '椒江', '临海', '黄岩']
                            },
                            yAxis: {
                                type: 'value'
                            },
                            series: [
                                {
                                    data: [120, 200, 150, 80, 70, 110, 130],
                                    type: 'bar'
                                }
                            ]
                        };

                        option && myChart_bar.setOption(option);
                        // 添加表格数据
                        var csrf = $('input[name="csrfmiddlewaretoken"]').val();
                        $.ajax({
                            url: "upload_selfplot_data",  // 请求的地址
                            type: "post",  // 请求方式
                            data: {
                                "plot_self_data": JSON.stringify(data_canvas),
                                'csrfmiddlewaretoken': csrf
                            },
                            dataType: "json",
                            success: function (data) {
                                // 得到请求的数据
                                var plotImg = new Image();
                                plotImg.src = data.img
                                plotImg.style = "width:100%;height:100%"
                                // js构建前端模板
                                var self_plot_div = document.getElementById('self_plot_div')
                                self_plot_div.append(plotImg)

                            }


                        })


                    } else if (type == "product_show") {
                        console.log("-------------------------------自定义材料加载----------------------")
                        $('#product_view').html(" ")
                        var product_view = document.getElementById('product_view')
                        product_view.style = "width:97.5%;height:97%;background-color:white;margin:15px"
                        var list_data_all = [
                            {  //# 文件头
                                "type": "一周天气",
                                "company": "台州市气象台",
                                "writer": "翁之梅",
                                "putter": "高丽",
                                "index": 15,
                                "time": 'Wed Mar 01 2022 19:18:00 GMT+0800 (中国标准时间)'
                            },
                            {  //# 文档内容
                                "type": "段落",
                                "title": ["本周后期强冷空气影响，全市有严重冰冻", 1, 2, 3],
                                "subtitle": ["短信内容", 1, 2, 3],
                                "text": "本周前期天气阴沉，周后期强冷空气影响转晴冷天气，全市有严重冰冻。今天、明天阴有分散性小雨，最高气温12～14度；后天多云到阴，夜里～周四受强冷空气影响有明显降温、大风和弱雨雪过程，预计日平均气温过程降温幅度可达8～10度，后天夜里部分地区有小雨夹雪或雪，山区有小雪；周五～周日天气晴冷，其中周五、周六早晨北部地区降至零下6～零下8度，山区零下9～零下12度，其它地区零下4～零下6度，全市有严重冰冻，须注意防寒保暖。另外，周二沿海风力8～9级，周三夜里～周四沿海和内陆分别有8～10级和6～8级偏北大风。"
                            },
                            {  //# 文档列表
                                "type": "列表",
                                "title": ["台州市主城区具体天气预报如下：", 1, 2, 3],
                                "subtitle": ["短信内容", 1, 2, 3],
                                "text_list1": "4日（周一）：阴，部分地区有时有小雨              9～14度",
                                "text_list2": "4日（周一）：阴，部分地区有时有小雨        9～14度",
                                "text_list3": "4日（周一）：阴，部分地区有时有小雨        9～14度",
                                "text_list4": "4日（周一）：阴，部分地区有时有小雨        9～14度",
                                "text_list5": "4日（周一）：阴，部分地区有时有小雨        9～14度",
                                "text_list6": "4日（周一）：阴，部分地区有时有小雨        9～14度",

                            },
                            {  //# 图片列表
                                "type": "单图",
                                "title": "台州市气象台",
                                "png": 'src/pre_test.png'
                            },
                            {
                                "type": "文件尾",
                                "title1": "微信宣传",
                                "png1": 'src/二维码.png',
                                "title2": "气象台宣传",
                                "png2": 'src/二维码.png',
                                "title3": "浙政钉宣传",
                                "png3": 'src/二维码.png',
                                "service_name": '宋伟2、李渊、小王、张三',
                                "service_unity": '气象台、玉环市气象局、水利局、气象台、玉环市气象局、水利局、气象台、玉环市气象局、水利局、玉环市气象局、水利局、气象台、玉环市气象局、水利局、玉环市气象局、水利局、气象台、玉环市气象局、水利局、玉环市气象局、水利局、气象台、玉环市气象局、水利局',
                                "recive_unity": '气象台、玉环市气象局、水利局、玉环市气象局、水利局'
                            }

                        ]
                        $('#product_view').html(" ")


                        for (const i of list_data_all) {
                            if (i['type'] == '一周天气预测') {
                                head_div(i)
                            } else if (i['type'] == '单图') {
                                // console.log(i)
                                png_div(i)
                            } else if (i['type'] == '列表') {
                                // console.log(i)
                                list_div(i)
                            } else if (i['type'] == '文件尾') {
                                // console.log(i)
                                foot_div(i)
                            } else if (i['type'] == '段落') {
                                // console.log(i)
                                text_div(i)
                            }

                        }


                    } else if (type == "tool_history") {
                        console.log("历史数据的加载")
                        var contentDocument = tinymce.get('content').getContent();
                        // 加载文件头
                        var hearder = list_button_object.render_head_info()
                        contentDocument = hearder + contentDocument

                        var formData = new FormData();
                        formData.append("document", contentDocument);
                        var product_view = document.getElementById('product_view')
                        product_view.style = "width:97.5%;height:97%;background-color:white;margin:15px"
                        $.ajax({
                            url: "file/history_save",  // 请求的地址
                            type: "POST",  // 请求方式
                            headers: {"Token": "Bearer " + localStorage.getItem("token")},
                            data: formData,
                            processData: false,
                            contentType: false,
                            enctype: "multipart/form-data",
                            responseType: "arraybuffer",
                            mimeType: "text/plain; charset=x-user-defined",
                            success: function (data) {
                                var rawLength = data.length;
                                var array = new Uint8Array(new ArrayBuffer(rawLength));
                                for (i = 0; i < rawLength; i++) {
                                    array[i] = data.charCodeAt(i) & 0xff;
                                }
                                var pdfBlob = new Blob([array], {type: "application/pdf;charset=utf-8"})
                                var pdfFile = URL.createObjectURL(pdfBlob)
                                const options_pdf = {
                                    forcePDFJS: true,
                                    pdfOpenParams: {
                                        pagemode: "thumbs",
                                        navpanes: 0,
                                        toolbar: 0,
                                        scrollbar: 0,
                                        statusbar: 0,
                                        view: "FitV"
                                    }
                                }

                                PDFObject.embed(pdfFile, "#product_view", options_pdf);
                            }

                        })

                        // $('#product_view').html(" ")


                    } else if (type == "tool_prodict_product") {

                        $('#product_view').html("")
                        var product_view = document.getElementById('product_view')
                        product_view.style = "width:97.5%;height:97%;background-color:white;margin:15px"
                        //加载数据地图
                        var tzmap = document.createElement("div")
                        tzmap.style = "width: 100%;height:100%;border: 1px solid black;"
                        tzmap.id = "tzmap"

                        var mainui = document.createElement("div")
                        mainui.style = "position:absolute;text-align: center;width: 8%;height: 50%;top:20%;left:90%;overflow-x: hidden;overflow-y: scroll;border-left:2px solid black;padding-top:10px;"
                        mainui.id = "menu-ui"
                        mainui.setAttribute("class", "scrollbar_self")

                        product_view.append(tzmap, mainui)

                        let boundaries = {
                            type: "FeatureCollection",
                            name: "boundaries",
                            crs: {type: "name", properties: {name: "urn:ogc:def:crs:OGC:1.3:CRS84"}},
                            features: taizhoulist
                        };
                        // 加载ajax
                        var time_plot_taizhou = $("input[name='tz_self_time']:checked").val()
                        var type_plot_taizhou = $("input[name='tz_self']:checked").val()
                        var csrf = $('input[name="csrfmiddlewaretoken"]').val();
                        var isobandsLay = undefined
                        var title = undefined
                        var myIcon = undefined
                        // console.log(time_plot_taizhou, type_plot_taizhou)
                        $.ajax({
                            url: "upload_select_taizhou_data",  // 请求的地址
                            type: "post",  // 请求方式
                            //async: false,
                            timeout: 25000, //设置延迟上限
                            data: {
                                'csrfmiddlewaretoken': csrf,
                                'plot_type': type_plot_taizhou,
                                'plot_time': time_plot_taizhou
                            },
                            dataType: "json",
                            success: function (data) {
                                var interpolate_options = {
                                    gridType: "points",
                                    property: "value",
                                    units: "degrees",
                                    weight: 10
                                };
                                // console.log(data.back_data)
                                var grid = turf.featureCollection(data.back_data)
                                var isobands_options = {
                                    zProperty: "value",
                                    commonProperties: {
                                        "fill-opacity": 0.9
                                    },
                                    breaksProperties: [
                                        {fill: "rgb(255,255,255)"},
                                        {fill: "rgb(140,246,130)"},
                                        {fill: "rgb(0,191,27)"},
                                        {fill: "rgb(62,185,255)"},
                                        {fill: "rgb(25,0,235)"},
                                        {fill: "rgb(255,0,255)"},
                                        {fill: "rgb(140,0,65)"}
                                    ]
                                };
                                let levelV = [5, 6, 7, 8, 9, 10, 100];
                                let isobands = turf.isobands(
                                    grid,
                                    levelV,
                                    isobands_options
                                );
                                var map = new L.Map('tzmap', {
                                    center: new L.LatLng(28.6, 121.3),//110.763, 41.376   39.62353145, 121.9937485
                                    zoom: 9, //4
                                    zoomControl: false,
                                    dragging: false,
                                    scrollWheelZoom: false,
                                    doubleClickZoom: false,
                                    attributionControl: false, //是否去除右下角标志
                                    layers: []
                                });
                                map.bounds = turf.bbox(boundaries);
                                L.geoJSON(boundaries, {
                                    style: function (feature) {
                                        return {color: 'black', weight: 1, fillOpacity: 0.1};
                                    }
                                }).addTo(map);
                                isobandsLay = L.geoJSON(isobands, {
                                    style: function (feature) {
                                        return {
                                            color: '#4264fb',
                                            fillColor: feature.properties.fill,
                                            weight: 0.1,
                                            fillOpacity: 0.8
                                        };
                                    }
                                });
                                //   裁剪数据
                                let features = [];//裁剪后的结果集
                                isobands.features.forEach(function (feature1) {
                                    boundaries.features.forEach(function (feature2) {
                                        let intersection = null;
                                        try {
                                            intersection = turf.intersect(feature1, feature2);
                                        } catch (e) {
                                            try {
                                                //色斑图绘制之后，可能会生成一些非法 Polygon ，例如 在 hole 里存在一些形状（听不懂？去查一下 GeoJSON 的规范），
                                                //我遇到的一个意外情况大概是这样，这种 Polygon 在做 intersect() 操作的时候会报错，所以在代码中做了个容错操作。
                                                //解决的方法通常就是做一次 turf.buffer() 操作，这样可以把一些小的碎片 Polygon 清理掉。
                                                feature1 = turf.buffer(feature1, 0);
                                                intersection = turf.intersect(feature1, feature2);
                                            } catch (e) {
                                                intersection = feature1;//实在裁剪不了就不裁剪了,根据业务需求自行决定
                                            }
                                        }
                                        if (intersection != null) {
                                            intersection.properties = feature1.properties;
                                            intersection.id = (Math.random() * 100000).toFixed(0);
                                            features.push(intersection);
                                        }
                                    });
                                });
                                //turf.isobands有点不符合业务预期,只有一个等级时,结果集可能为空,无图形显示,写点程序(找出那一个等级，并添加进结果集)补救下
                                if (features.length == 0) {
                                    let maxAttribute = getMaxAttribute(levelV, grid, isobands_options.breaksProperties);
                                    let value = maxAttribute[0];
                                    let fill = maxAttribute[1];
                                    if (value != '' && fill != '') {
                                        //获取网格点Box
                                        let gridBox = turf.bbox(grid);
                                        //生成网格点范围的面
                                        let gridBoxPolygon = [[[gridBox[0], gridBox[1]], [gridBox[0], gridBox[3]], [gridBox[2], gridBox[3]], [gridBox[2], gridBox[1]], [gridBox[0], gridBox[1]]]];
                                        //获取网格范围的面与行政边界的交集 Polygon
                                        let intersectPolygon = null;
                                        let gridoxFeature = {
                                            "type": "Feature",
                                            "properties": {"fill-opacity": 0.8},
                                            "geometry": {"type": "Polygon", "coordinates": gridBoxPolygon},
                                            "id": 10
                                        };
                                        try {
                                            intersectPolygon = turf.intersect(gridoxFeature, boundaries.features[0]);
                                        } catch (e) {
                                            try {
                                                //色斑图绘制之后，可能会生成一些非法 Polygon ，例如 在 hole 里存在一些形状（听不懂？去查一下 GeoJSON 的规范），
                                                //我遇到的一个意外情况大概是这样，这种 Polygon 在做 intersect() 操作的时候会报错，所以在代码中做了个容错操作。
                                                //解决的方法通常就是做一次 turf.buffer() 操作，这样可以把一些小的碎片 Polygon 清理掉。
                                                gridoxFeature = turf.buffer(gridoxFeature, 0);
                                                intersectPolygon = turf.intersect(gridoxFeature, boundaries.features[0]);
                                            } catch (e) {
                                                intersectPolygon = gridoxFeature;//实在裁剪不了就不裁剪了,根据业务需求自行决定
                                            }
                                        }
                                        //结果添加到结果数组
                                        if (intersectPolygon != null) {
                                            features.push({
                                                "type": "Feature",
                                                "properties": {"fill-opacity": 0.8, "fill": fill, "value": value},
                                                "geometry": intersectPolygon.geometry,
                                                "id": 0
                                            });
                                        }
                                    }
                                }
                                //裁剪结果
                                // 叠加标题
                                let intersection = turf.featureCollection(features);
                                myIcon = L.divIcon({
                                    html: data.label,
                                    className: 'my-div-icon',
                                    iconSize: [600, 105],
                                });
                                title = L.marker([29.4, 120.9], {icon: myIcon}).addTo(map);

                                var productIcon = L.divIcon({
                                    html: "短期气温",
                                    className: 'my-div-icon',
                                    iconSize: [300, 55],

                                });

                                L.marker([29.45, 122.56], {icon: productIcon}).addTo(map);
                                // 叠加图片
                                var imageBounds = [[27.6, 121.85], [27.8, 122.45]];
                                // 将图片作为自定义图层加载到地图上（类似于Marker）
                                L.imageOverlay('static/src/logo.png', imageBounds, {opacity: 1, zIndex: 20}).addTo(map);
                                var intersectionLay = L.geoJSON(intersection, {
                                    style: function (feature) {
                                        return {
                                            color: '#ffffff',
                                            fillColor: feature.properties.fill,
                                            weight: 0.1,
                                            fillOpacity: 0.6
                                        };
                                    }
                                })
                                intersectionLay.addTo(map)

                                //色标
                                function colorlabel(isobands_options, map) {
                                    var coloritem = isobands_options.breaksProperties.length
                                    var colorinitlat = 28.4
                                    var colorinitlon = 120.5
                                    var colorwidth = 0.1
                                    var colorheight = 0.4 / coloritem
                                    var labellist = ['0~0.1', '0.1~1', '1~10', '10~25', '25~50', '50~100', '100']
                                    for (var i = 0; i < isobands_options.breaksProperties.length; i++) {
                                        var textIcon = L.divIcon({
                                            html: labellist[i],
                                            className: 'label_plot_text'
                                        });
                                        var colorlat = colorinitlat - i * colorheight
                                        var colorlon = colorinitlon
                                        var latlngs = [[colorlat, colorlon], [colorlat, colorlon + colorwidth], [colorlat - colorheight, colorlon + colorwidth], [colorlat - colorheight, colorlon]]
                                        var colorstr = isobands_options.breaksProperties[i].fill
                                        var polygon = L.polygon(latlngs, {
                                            color: "black",
                                            fillColor: colorstr,
                                            fillOpacity: 0.8,
                                            weight: 1
                                        }).addTo(map)
                                        L.marker([colorlat - colorheight / 3, colorlon + colorwidth + 0.05], {icon: textIcon}).addTo(map);
                                    }

                                }

                                colorlabel(isobands_options, map)
                                //页面设置slider
                                var sliderui = document.getElementById("menu-ui");
                                var labels = data.btn_index
                                var layerstr = "";
                                for (var i = 0; i < labels.length; i++) {
                                    var id = "time_silder" + i.toString();

                                    var singlebtn = document.createElement("button");
                                    singlebtn.id = id;
                                    singlebtn.style = "width:90%;height: 6%;margin-top:8px; border-radius:8px;"
                                    singlebtn.innerText = labels[i]
                                    singlebtn.onclick = function (e) {
                                        e.preventDefault();
                                        e.stopPropagation();
                                        let clickedstr = this.id;
                                        var index = clickedstr.lastIndexOf("r");
                                        var item = clickedstr.substring(index + 1, clickedstr.length);
                                        var time_plot_taizhou = $("input[name='tz_self_time']:checked").val()
                                        var type_plot_taizhou = $("input[name='tz_self']:checked").val()
                                        var csrf = $('input[name="csrfmiddlewaretoken"]').val();
                                        console.log(parseInt(item))


                                        $.ajax({
                                            url: "upload_select_taizhou_data",  // 请求的地址
                                            type: "post",  // 请求方式
                                            async: false,
                                            timeout: 25000, //设置延迟上限
                                            data: {
                                                'csrfmiddlewaretoken': csrf,
                                                'plot_type': type_plot_taizhou,
                                                'plot_time': time_plot_taizhou,
                                                'plot_item': parseInt(item)

                                            },
                                            dataType: "json",
                                            success: function (result) {
                                                console.log("ok--", result, item)
                                                //开始进行数据的叠加
                                                intersectionLay.remove()
                                                title.remove()
                                                myIcon = L.divIcon({
                                                    html: result.click_label,
                                                    className: 'my-div-icon',
                                                    iconSize: [600, 105],
                                                });
                                                title = L.marker([29.4, 120.9], {icon: myIcon}).addTo(map);
                                                //L.marker([29.4, 120.9], { icon: myIcon }).addTo(map);

                                                var grid = turf.featureCollection(result.click_data)

                                                let isobands = turf.isobands(
                                                    grid,
                                                    levelV,
                                                    isobands_options
                                                );
                                                //   裁剪数据
                                                let features = [];//裁剪后的结果集
                                                isobands.features.forEach(function (feature1) {
                                                    boundaries.features.forEach(function (feature2) {
                                                        let intersection = null;
                                                        try {
                                                            intersection = turf.intersect(feature1, feature2);
                                                        } catch (e) {
                                                            try {
                                                                //色斑图绘制之后，可能会生成一些非法 Polygon ，例如 在 hole 里存在一些形状（听不懂？去查一下 GeoJSON 的规范），
                                                                //我遇到的一个意外情况大概是这样，这种 Polygon 在做 intersect() 操作的时候会报错，所以在代码中做了个容错操作。
                                                                //解决的方法通常就是做一次 turf.buffer() 操作，这样可以把一些小的碎片 Polygon 清理掉。
                                                                feature1 = turf.buffer(feature1, 0);
                                                                intersection = turf.intersect(feature1, feature2);
                                                            } catch (e) {
                                                                intersection = feature1;//实在裁剪不了就不裁剪了,根据业务需求自行决定
                                                            }
                                                        }
                                                        if (intersection != null) {
                                                            intersection.properties = feature1.properties;
                                                            intersection.id = (Math.random() * 100000).toFixed(0);
                                                            features.push(intersection);
                                                        }
                                                    });
                                                });
                                                //turf.isobands有点不符合业务预期,只有一个等级时,结果集可能为空,无图形显示,写点程序(找出那一个等级，并添加进结果集)补救下
                                                if (features.length == 0) {
                                                    let maxAttribute = getMaxAttribute(levelV, grid, isobands_options.breaksProperties);
                                                    let value = maxAttribute[0];
                                                    let fill = maxAttribute[1];
                                                    if (value != '' && fill != '') {
                                                        //获取网格点Box
                                                        let gridBox = turf.bbox(grid);
                                                        //生成网格点范围的面
                                                        let gridBoxPolygon = [[[gridBox[0], gridBox[1]], [gridBox[0], gridBox[3]], [gridBox[2], gridBox[3]], [gridBox[2], gridBox[1]], [gridBox[0], gridBox[1]]]];
                                                        //获取网格范围的面与行政边界的交集 Polygon
                                                        let intersectPolygon = null;
                                                        let gridoxFeature = {
                                                            "type": "Feature",
                                                            "properties": {"fill-opacity": 0.8},
                                                            "geometry": {
                                                                "type": "Polygon",
                                                                "coordinates": gridBoxPolygon
                                                            },
                                                            "id": 10
                                                        };
                                                        try {
                                                            intersectPolygon = turf.intersect(gridoxFeature, boundaries.features[0]);
                                                        } catch (e) {
                                                            try {
                                                                //色斑图绘制之后，可能会生成一些非法 Polygon ，例如 在 hole 里存在一些形状（听不懂？去查一下 GeoJSON 的规范），
                                                                //我遇到的一个意外情况大概是这样，这种 Polygon 在做 intersect() 操作的时候会报错，所以在代码中做了个容错操作。
                                                                //解决的方法通常就是做一次 turf.buffer() 操作，这样可以把一些小的碎片 Polygon 清理掉。
                                                                gridoxFeature = turf.buffer(gridoxFeature, 0);
                                                                intersectPolygon = turf.intersect(gridoxFeature, boundaries.features[0]);
                                                            } catch (e) {
                                                                intersectPolygon = gridoxFeature;//实在裁剪不了就不裁剪了,根据业务需求自行决定
                                                            }
                                                        }
                                                        //结果添加到结果数组
                                                        if (intersectPolygon != null) {
                                                            features.push({
                                                                "type": "Feature",
                                                                "properties": {
                                                                    "fill-opacity": 0.8,
                                                                    "fill": fill,
                                                                    "value": value
                                                                },
                                                                "geometry": intersectPolygon.geometry,
                                                                "id": 0
                                                            });
                                                        }
                                                    }
                                                }
                                                //裁剪结果
                                                // 叠加标题
                                                let intersection = turf.featureCollection(features);
                                                intersectionLay = L.geoJSON(intersection, {
                                                    style: function (feature) {
                                                        return {
                                                            color: '#ffffff',
                                                            fillColor: feature.properties.fill,
                                                            weight: 0.1,
                                                            fillOpacity: 0.6
                                                        };
                                                    }
                                                })
                                                intersectionLay.addTo(map)


                                            }
                                        })


                                    }
                                    sliderui.appendChild(singlebtn);
                                }


                            }
                        })


                        //

                    } else if (type == "tool_zdz") {
                        // console.log("自动站数据加载")
                        var csrf = $('input[name="csrfmiddlewaretoken"]').val();
                        $.ajax({
                            url: "tool_zdz_date",  // 请求的地址
                            type: "post",  // 请求方式
                            timeout: 25000, //设置延迟上限
                            data: {
                                'csrfmiddlewaretoken': csrf,
                                'start_time': $('#datetimepicker_history1').val(),
                                'end_time': $('#datetimepicker_history2').val()
                            },
                            dataType: "json",
                            success: function (data) {
                                //日历数据
                                var day_list = data.day_list
                                var day_range = data.day_range
                                //降水数据
                                var rain_line = data.rain_line
                                var rain_scatter = JSON.parse(data.rain_scatter)
                                // // day_range[0] = data.day_list[0][0]
                                // // day_range[1] = data.day_list[-1][0]
                                // console.log("zdz--ok",data.rain_img)
                                $('#product_view').html("")
                                var product_view = document.getElementById("product_view")
                                product_view.style = "width:97.5%;height:97%;background-color:rgb(220, 222, 226);;margin:15px"

                                // 日历模块
                                var calendar_all = document.createElement('div')
                                calendar_all.style = "display:inline-flex;width: 97.5%; height: 28%;;background-color:white;;margin:15px"

                                var calendar_ul = document.createElement('div')
                                calendar_ul.style = "display:inline-block;width: 39%; height: 95%;;background-color:white;;margin:15px"


                                var calendar_history = document.createElement('div')
                                calendar_history.id = "calendar_history"
                                calendar_history.style = "display:inline-flex;width: 55%; height: 95%;"

                                calendar_all.append(calendar_ul, calendar_history)

                                var tabbable = document.createElement('div')
                                tabbable.setAttribute('class', 'tabbable')
                                tabbable.id = "tabs-492675"
                                tabbable.style = "width: 97.5%; height: 50%;;background-color:white;;margin:15px"

                                var tab_content = document.createElement('div')
                                tab_content.style = "display: inline-block;width: 100%; height: 90%;"
                                tab_content.setAttribute('class', 'tab-content')

                                // 设置说明头

                                var tabbable_head = document.createElement('div')
                                tabbable_head.style = "width: 100%; height: 10%;;background-color:rgb(220, 222, 226);"
                                var tablehead_h = document.createElement('h1')
                                tablehead_h.style = "margin:0;text-align:center;background-color:rgb(45, 104, 221);width:15%;height:100%;border-top-left-radius: 5px;border-top-right-radius:5px;font-size: 23px;font-weight:900;font-family:'宋体';color:white;padding-top:1.5%"
                                tablehead_h.innerText = "实况查询"
                                tabbable_head.append(tablehead_h)


                                var tabbable_ul = document.createElement('ul')
                                tabbable_ul.setAttribute("class", "nav nav-tabs")
                                tabbable_ul.style = "display:inline-block;width: 100%; height: 90%;border:0px;padding-top:15px"


                                calendar_ul.append(tabbable_ul)


                                var tabbable_li1 = document.createElement('li')
                                tabbable_li1.setAttribute('class', 'active')
                                tabbable_li1.style = "display:inline-block;width: 50%; height: 48%;"
                                var tabbable_a1 = document.createElement('a')
                                tabbable_a1.setAttribute('href', '#panel-883512')
                                tabbable_a1.setAttribute('data-toggle', 'tab')
                                //tabbable_a1.style = "display:inline-block;width: 85%; height: 80%;background-color:rgb(220, 222, 226);border-radius:15px;margin:10px;background-image: url(static/src/降水量.png);background-size:65%;background-repeat: no-repeat;background-position:50%;"
                                tabbable_a1.style = "display:inline-block;text-align:center;;width: 85%; height: 80%;;background-color:rgb(220, 222, 226);border-radius:15px;margin:10px;font-size: 40px;font-weight:1200;font-family:'楷体';color:red;;background-position:50%;"
                                tabbable_a1.innerText = "降水"
                                tabbable_li1.append(tabbable_a1)

                                var tabbable_li2 = document.createElement('li')
                                tabbable_li2.style = "display:inline-block;width: 50%; height: 48%;"
                                var tabbable_a2 = document.createElement('a')
                                tabbable_a2.setAttribute('href', '#panel-725174')
                                tabbable_a2.setAttribute('data-toggle', 'tab')
                                //tabbable_a2.style = "display:inline-block;width: 85%; height: 80%;;background-color:rgb(220, 222, 226);border-radius:15px;margin:10px;background-image: url(static/src/大风.png);background-size:65%;background-repeat: no-repeat;background-position:50%;"
                                tabbable_a2.style = "display:inline-block;text-align:center;;width: 85%; height: 80%;;background-color:rgb(220, 222, 226);border-radius:15px;margin:10px;font-size: 40px;font-weight:1200;font-family:'楷体';color:red;;background-position:50%;"
                                tabbable_a2.innerText = "大风"
                                tabbable_li2.append(tabbable_a2)

                                var tabbable_li3 = document.createElement('li')
                                tabbable_li3.style = "display:inline-block;width: 50%; height: 48%;"
                                var tabbable_a3 = document.createElement('a')
                                tabbable_a3.setAttribute('href', '#panel-725173')
                                tabbable_a3.setAttribute('data-toggle', 'tab')
                                //tabbable_a3.style = "display:inline-block;width: 85%; height: 80%;;background-color:rgb(220, 222, 226);border-radius:15px;margin:10px;background-image: url(static/src/强浓雾.png);background-size:65%;background-repeat: no-repeat;background-position:50%;"
                                tabbable_a3.style = "display:inline-block;text-align:center;;width: 85%; height: 80%;;background-color:rgb(220, 222, 226);border-radius:15px;margin:10px;font-size: 40px;font-weight:1200;font-family:'楷体';color:red;;background-position:50%;"
                                tabbable_a3.innerText = "浓雾"
                                tabbable_li3.append(tabbable_a3)

                                var tabbable_li5 = document.createElement('li')
                                tabbable_li5.style = "display:inline-block;width: 50%; height: 48%;"
                                var tabbable_a5 = document.createElement('a')
                                tabbable_a5.setAttribute('href', '#panel-725172')
                                tabbable_a5.setAttribute('data-toggle', 'tab')
                                // tabbable_a5.style = "display:inline-block;width: 85%; height: 80%;;background-color:rgb(220, 222, 226);border-radius:15px;margin:10px;background-image: url(static/src/大气温度.png);background-size:65%;background-repeat: no-repeat;background-position:50%;"
                                tabbable_a5.style = "display:inline-block;text-align:center;;width: 85%; height: 80%;;background-color:rgb(220, 222, 226);border-radius:15px;margin:10px;font-size: 40px;font-weight:1200;font-family:'楷体';color:red;;background-position:50%;"
                                tabbable_a5.innerText = "温度"
                                tabbable_li5.append(tabbable_a5)

                                var tabbable_li4 = document.createElement('li')

                                var tabbable_a4 = document.createElement('a')
                                tabbable_a4.setAttribute('href', '#panel-725171')
                                tabbable_a4.setAttribute('data-toggle', 'tab')
                                tabbable_a4.innerText = "日报"
                                tabbable_a4.id = "a_panel-725171"
                                //日报的内容不显示
                                tabbable_a4.style.display = 'none'
                                tabbable_li4.append(tabbable_a4)

                                tabbable_ul.append(tabbable_li1, tabbable_li2, tabbable_li3, tabbable_li5, tabbable_li4)

                                // 降水
                                var panel_883512 = document.createElement('div')
                                panel_883512.style = "width: 100%; height: 100%;"
                                panel_883512.id = "panel-883512"
                                panel_883512.setAttribute("class", "tab-pane active")

                                var map_bar = document.createElement('div')
                                map_bar.id = "map_bar"
                                map_bar.style = "width: 100%; height: 100%;"

                                panel_883512.append(map_bar)
                                tab_content.append(panel_883512)

                                // 大风
                                var panel_725174 = document.createElement('div')
                                panel_725174.setAttribute("class", "tab-pane")
                                panel_725174.style = "width: 100%; height: 100%;"
                                panel_725174.id = "panel-725174"

                                var wind_all = document.createElement('div')
                                wind_all.style = "display: inline-flex;width: 100%; height: 100%;"

                                var map_wind = document.createElement('div')
                                map_wind.id = "map_wind"
                                map_wind.style = "width: 60%; height: 100%;"

                                var table_wind_div = document.createElement('div')
                                table_wind_div.style = "width: 40%; height:90%;margin:10px;overflow-x: hidden;overflow-y: scroll;"
                                table_wind_div.setAttribute("class", "scrollbar_self")

                                var table_wind = document.createElement('table')
                                table_wind.setAttribute('class', 'table')

                                var table_head = document.createElement('thead')
                                table_head.innerHTML = "<tr><th>排序</th><th>测站名称</th><th>站号</th><th>风速</th></tr>"

                                var table_body = document.createElement('tbody')
                                table_body.id = "zdz_wind_table"
                                table_wind.append(table_head, table_body)
                                table_wind_div.append(table_wind)
                                wind_all.append(map_wind, table_wind_div)
                                panel_725174.append(wind_all)
                                tab_content.append(panel_725174)
                                tabbable_li2.addEventListener("click", function () {
                                    var csrf = $('input[name="csrfmiddlewaretoken"]').val();
                                    $.ajax({
                                        url: "tool_zdz_wind",  // 请求的地址
                                        type: "post",  // 请求方式
                                        timeout: 25000, //设置延迟上限
                                        data: {
                                            'csrfmiddlewaretoken': csrf
                                        },
                                        dataType: "json",
                                        success: function (data) {
                                            // console.log("返回成功", data)
                                            // 加载大风图 tz_json
                                            var map = echarts.init(document.getElementById('map_wind'), 'light');
                                            //  echarts.registerMap('taizhou',tz_json,{});
                                            $('#zdz_wind_table').html(data.sort_html)
                                            map.setOption({
                                                title: {
                                                    text: '大风',
                                                    textStyle: {fontSize: 20},
                                                },
                                                tooltip: {
                                                    trigger: 'item',
                                                    formatter: function (params) {
                                                        if (params['componentType'] == 'series') {
                                                            // console.log("打印的是", params)
                                                            var lable_data = params['data']['value'][2]
                                                            var lable_station = params['data']['IIiii']
                                                        }
                                                        return lable_station + "站:" + lable_data + "m/s"
                                                    }
                                                },
                                                geo: {
                                                    map: 'taizhou',
                                                    roam: true,
                                                    // tooltip:{borderColor = '#333'}
                                                    itemStyle: {
                                                        color: 'white'
                                                        // areaColor = '#333',
                                                    }


                                                },
                                                visualMap: {

                                                    type: "piecewise",
                                                    show: false,
                                                    // orient:'horizontal',
                                                    // type:"continuous",
                                                    // min: 0,
                                                    // max: 200,
                                                    // splitNumber = 5,
                                                    // color: ["rgb(255, 255, 255)",
                                                    // "rgb(255, 238, 255)",
                                                    // "rgb(255, 238, 204)",
                                                    // "rgb(255, 204, 153)",
                                                    // "rgb(255, 204, 102)",
                                                    // "rgb(255, 170, 68)",
                                                    // "rgb(153, 255, 136)",
                                                    // "rgb(0, 255, 85)",
                                                    // "rgb(0, 170, 51)",
                                                    // "rgb(0, 170, 255)",
                                                    // "rgb(17, 136, 204)",
                                                    // "rgb(0, 85, 204)",
                                                    // "rgb(0, 68, 221)",
                                                    // "rgb(0, 0, 221)"],

                                                    right: "5%",
                                                    bottom: "15%",
                                                    padding: 0,
                                                    itemGap: 0,
                                                    textGap: 0,
                                                    textStyle: {fontSize: 8},
                                                    pieces: [
                                                        {min: 2000, max: 2500, label: '10 到 200', color: "red"},
                                                        {min: 1500, max: 2000, label: '10 到 200', color: "red"},// 不指定 max，表示 max 为无限大（Infinity）。
                                                        {min: 900, max: 1500, label: '10 到 200', color: "red"},
                                                        {min: 310, max: 1000, label: '10 到 200', color: "red"},
                                                        {min: 200, max: 300, label: '10 到 200', color: "red"},
                                                        {min: 10, max: 200, label: '10 到 200', color: "red"},
                                                        {max: 10, min: 5, label: '10 到 200', color: "red"}

                                                    ],

                                                    // categories: ['1', '2', '3', '4', '5','6']

                                                    // inRange: {
                                                    //     color: ['lightskyblue','yellow', 'orangered']
                                                    // }
                                                },
                                                // label: {
                                                //             show: true,
                                                //             color: "rgba(50, 44, 44, 1)",
                                                //             formatter: 'K8505'
                                                //         },
                                                series: [{
                                                    name: '大风',
                                                    // type: 'effectScatter',
                                                    type: 'scatter',
                                                    // symble:"triangle",
                                                    // symbol: "roundRect",
                                                    // symbolSize:50,
                                                    coordinateSystem: 'geo',
                                                    // itemStyle: {
                                                    //   color: function (params) {
                                                    //       var colorlist = ['black'];
                                                    //       return colorlist[params.dataIndex];
                                                    //   },
                                                    //   symbol: function (params) {
                                                    //     var symbollist = ['path://M10 10L60 10 60 20 20 20 20 40 60 40 60 50 20 50 20 100 10 100 10 10z'];
                                                    //     return symbollist[params.dataIndex];
                                                    // },
                                                    // },
                                                    data: JSON.parse(data.data_wind_list)

                                                    // data: [{
                                                    //     name: "data", value: [121.0, 28.8, 123], url: "url_data",
                                                    //     symbol: 'path://M10 10L50 10 50 20 20 20 20 40 50 40 50 50 20 50 20 100 10 100 10 10z', symbolSize: 15, symbolRotate: 330
                                                    // }]

                                                }]


                                            });
                                        }
                                    })
                                })


                                // 能见度
                                var panel_725173 = document.createElement('div')
                                panel_725173.setAttribute("class", "tab-pane")
                                panel_725173.style = "width: 100%; height: 100%;"
                                panel_725173.id = "panel-725173"

                                var see_view_all = document.createElement('div')

                                see_view_all.style = "display: inline-flex;width: 100%; height: 100%;"

                                var map_see_view = document.createElement('div')
                                map_see_view.id = "map_see_view"
                                map_see_view.style = "width: 60%; height: 100%;"

                                var table_see_view_div = document.createElement('div')
                                table_see_view_div.style = "width: 40%; height:90%;margin:10px;overflow-x: hidden;overflow-y: scroll;"
                                table_see_view_div.setAttribute("class", "scrollbar_self")

                                var table_see_view = document.createElement('table')
                                table_see_view.setAttribute('class', 'table')

                                var table_head = document.createElement('thead')
                                table_head.innerHTML = "<tr><th>排序</th><th>乡镇</th><th>站点</th><th>能见度</th></tr>"

                                var table_body = document.createElement('tbody')
                                table_body.id = "zdz_view_table"
                                table_see_view.append(table_head, table_body)
                                table_see_view_div.append(table_see_view)
                                see_view_all.append(map_see_view, table_see_view_div)
                                panel_725173.append(see_view_all)
                                tab_content.append(panel_725173)
                                tabbable_li3.addEventListener("click", function () {
                                    var csrf = $('input[name="csrfmiddlewaretoken"]').val();
                                    $.ajax({
                                        url: "tool_zdz_view",  // 请求的地址
                                        type: "post",  // 请求方式
                                        timeout: 25000, //设置延迟上限
                                        data: {
                                            'csrfmiddlewaretoken': csrf
                                        },
                                        dataType: "json",
                                        success: function (data) {
                                            // console.log("返回成功", data)
                                            // 加载大风图 tz_json

                                            //  echarts.registerMap('taizhou',tz_json,{});
                                            $('#zdz_view_table').html(data.sort_html)
                                            // 加载能见度图
                                            var map = echarts.init(document.getElementById('map_see_view'), 'light');
                                            //  echarts.registerMap('taizhou',tz_json,{});
                                            // console.log(data.data_view_list)
                                            map.setOption({
                                                title: {
                                                    text: '能见度',
                                                    textStyle: {fontSize: 15},
                                                },
                                                tooltip: {
                                                    trigger: 'item',
                                                    formatter: function (params) {
                                                        if (params['componentType'] == 'series') {
                                                            // console.log("打印的是", params)
                                                            var lable_data = params['data']['value'][2]
                                                            var lable_station = params['data']['IIiii']
                                                        }
                                                        return lable_station + "站:" + lable_data + "m"
                                                    }
                                                },
                                                geo: {
                                                    map: 'taizhou',
                                                    roam: false,
                                                    // tooltip:{borderColor = '#333'}
                                                    itemStyle: {
                                                        color: 'white'
                                                        // areaColor = '#333',
                                                    }


                                                },
                                                visualMap: {
                                                    type: "piecewise",
                                                    right: "10%",
                                                    bottom: "15%",


                                                    pieces: [
                                                        {min: 200, max: 500, label: '雾', color: 'yellow'},
                                                        {min: 50, max: 200, label: '浓雾', color: 'orange'},
                                                        {max: 50, min: 0, label: '强浓雾', color: 'red'}
                                                    ],
                                                },
                                                series: [{
                                                    name: '自动站能见度',
                                                    // type: 'effectScatter',
                                                    type: 'scatter',
                                                    // symble:"triangle",
                                                    // symbol: "roundRect",
                                                    // symbolSize:50,
                                                    coordinateSystem: 'geo',
                                                    // itemStyle: {
                                                    //   color: function (params) {
                                                    //       var colorlist = ['black'];
                                                    //       return colorlist[params.dataIndex];
                                                    //   },
                                                    //   symbol: function (params) {
                                                    //     var symbollist = ['path://M10 10L60 10 60 20 20 20 20 40 60 40 60 50 20 50 20 100 10 100 10 10z'];
                                                    //     return symbollist[params.dataIndex];
                                                    // },
                                                    // },

                                                    data: JSON.parse(data.data_view_list)

                                                }]


                                            });

                                        }
                                    })
                                })
                                //气温
                                var panel_725172 = document.createElement('div')
                                panel_725172.setAttribute("class", "tab-pane")
                                panel_725172.style = "width: 100%; height: 100%;"
                                panel_725172.id = "panel-725172"

                                var see_view_all_temp = document.createElement('div')
                                see_view_all_temp.style = "display: inline-block;width: 100%; height: 100%;"

                                var maphigt_see_view = document.createElement('div')
                                maphigt_see_view.id = "maphigt_see_view"
                                maphigt_see_view.style = "display: inline-block;width: 50%; height: 100%;border 3px solid black;"

                                var maplow_see_view = document.createElement('div')
                                maplow_see_view.id = "maplow_see_view"
                                maplow_see_view.style = "display: inline-block;width: 50%; height:100%;"

                                see_view_all_temp.append(maphigt_see_view, maplow_see_view)
                                panel_725172.append(see_view_all_temp)
                                tab_content.append(panel_725172)
                                tabbable_li5.addEventListener("click", function () {
                                    var csrf = $('input[name="csrfmiddlewaretoken"]').val();
                                    $.ajax({
                                        url: "tool_zdz_temp",  // 请求的地址
                                        type: "post",  // 请求方式
                                        timeout: 25000, //设置延迟上限
                                        data: {
                                            'csrfmiddlewaretoken': csrf
                                        },
                                        dataType: "json",
                                        success: function (data) {
                                            // console.log("返回成功", data)
                                            // 加载气温
                                            //加载气温
                                            // 高温
                                            var map_high = echarts.init(document.getElementById('maphigt_see_view'), 'light');
                                            //  echarts.registerMap('taizhou',tz_json,{});
                                            console.log(data.data_temp_max)
                                            map_high.setOption({
                                                title: {
                                                    text: '全市高温',
                                                    textStyle: {fontSize: 25},
                                                },
                                                tooltip: {
                                                    trigger: 'item',
                                                    formatter: function (params) {
                                                        if (params['componentType'] == 'series') {
                                                            // console.log("打印的是", params)
                                                            var lable_data = params['data']['value'][2]
                                                            var lable_station = params['data']['name']
                                                        }
                                                        return lable_station
                                                    }
                                                },
                                                geo: {
                                                    map: 'taizhou',
                                                    roam: true,
                                                    // tooltip:{borderColor = '#333'}
                                                    itemStyle: {
                                                        color: 'white'
                                                        // areaColor = '#333',
                                                    }


                                                },
                                                label: {
                                                    show: true,
                                                    color: "black",
                                                    fontSize: 15,
                                                    position: "top",
                                                    formatter: function (params) {
                                                        if (params['componentType'] == 'series') {
                                                            console.log("打印的是", params)
                                                            var lable_data = params['data']['value'][2]
                                                            var lable_station = params['data']['name']
                                                        }
                                                        return lable_data
                                                    }
                                                },
                                                series: [{
                                                    name: '高温',
                                                    // type: 'effectScatter',
                                                    type: 'scatter',
                                                    // symble:"triangle",
                                                    // symbol: "roundRect",
                                                    symbolSize: 5,
                                                    color: 'red',
                                                    coordinateSystem: 'geo',
                                                    // itemStyle: {
                                                    //   color: function (params) {
                                                    //       var colorlist = ['black'];
                                                    //       return colorlist[params.dataIndex];
                                                    //   },
                                                    //   symbol: function (params) {
                                                    //     var symbollist = ['path://M10 10L60 10 60 20 20 20 20 40 60 40 60 50 20 50 20 100 10 100 10 10z'];
                                                    //     return symbollist[params.dataIndex];
                                                    // },
                                                    // },


                                                    // data: [{
                                                    //     name: "测试站", value: [121.0, 28.8, 123]
                                                    // }]
                                                    data: data.data_temp_max

                                                }]


                                            });

                                            // 低温
                                            var map_min = echarts.init(document.getElementById('maplow_see_view'), 'light');
                                            //  echarts.registerMap('taizhou',tz_json,{});

                                            map_min.setOption({
                                                title: {
                                                    text: '全市低温',
                                                    textStyle: {fontSize: 25},
                                                },
                                                tooltip: {
                                                    trigger: 'item',
                                                    formatter: function (params) {
                                                        if (params['componentType'] == 'series') {
                                                            console.log("打印的是", params)
                                                            var lable_data = params['data']['value'][2]
                                                            var lable_station = params['data']['name']
                                                        }
                                                        return lable_station
                                                    }
                                                },
                                                geo: {
                                                    map: 'taizhou',
                                                    roam: true,
                                                    // tooltip:{borderColor = '#333'}
                                                    itemStyle: {
                                                        color: 'white'
                                                        // areaColor = '#333',
                                                    }


                                                },
                                                label: {
                                                    show: true,
                                                    color: "black",
                                                    fontSize: 15,
                                                    position: "top",
                                                    formatter: function (params) {
                                                        if (params['componentType'] == 'series') {
                                                            console.log("打印的是", params)
                                                            var lable_data = params['data']['value'][2]
                                                            var lable_station = params['data']['name']
                                                        }
                                                        return lable_data
                                                    }
                                                },
                                                series: [{
                                                    name: '低温',
                                                    // type: 'effectScatter',
                                                    type: 'scatter',
                                                    // symble:"triangle",
                                                    // symbol: "roundRect",
                                                    symbolSize: 5,
                                                    color: 'blue',
                                                    coordinateSystem: 'geo',
                                                    // itemStyle: {
                                                    //   color: function (params) {
                                                    //       var colorlist = ['black'];
                                                    //       return colorlist[params.dataIndex];
                                                    //   },
                                                    //   symbol: function (params) {
                                                    //     var symbollist = ['path://M10 10L60 10 60 20 20 20 20 40 60 40 60 50 20 50 20 100 10 100 10 10z'];
                                                    //     return symbollist[params.dataIndex];
                                                    // },
                                                    // },


                                                    // data: [{
                                                    //     name: "测试站", value: [121.0, 28.8, 123]
                                                    // }]
                                                    data: data.data_temp_min

                                                }]


                                            });


                                        }
                                    })
                                })

                                // 自定义数据加载
                                var panel_725171 = document.createElement('div')
                                panel_725171.setAttribute("class", "tab-pane")
                                panel_725171.style = "width: 100%; height: 100%;"
                                panel_725171.id = "panel-725171"
                                var show_panel_725171 = document.createElement('div')
                                show_panel_725171.id = "show_panel-725171"
                                show_panel_725171.style = "display: inline-block;width: 100%; height: 100%;"


                                var div_all_daily = document.createElement('div')
                                div_all_daily.style = "display: inline-flex;width: 100%;height: 100%"

                                var station_list = document.createElement('div')
                                station_list.id = "station_list"
                                station_list.style = style = "width: 500px;height: 380px"

                                var station_map = document.createElement('div')
                                //class="col-md-12 column"
                                // station_map.setAttribute("class", "col-md-12 column")
                                station_map.style = "width: 400px;height: 380px"
                                station_map.id = "station_map"


                                div_all_daily.append(station_list, station_map)
                                show_panel_725171.append(div_all_daily)


                                panel_725171.append(show_panel_725171)
                                tab_content.append(panel_725171)

                                // 导航头
                                tabbable.append(tabbable_head, tab_content)
                                // tabbable.append(tabbable_ul, tab_content)
                                // 风雨情
                                var result_div = document.createElement('div')
                                result_div.style = "width: 97.5%; height: 18%;;background-color:white;margin:15px;overflow-x: hidden;overflow-y:scroll;font-family:'楷体';"
                                result_div.setAttribute("class", "scrollbar_self")
                                result_div.innerHTML = "<blockquote><p>风雨情统计</p><small>" + data.text + "</small></blockquote>"


                                product_view.append(tabbable, result_div, calendar_all)
                                // 加载bar
                                var dom = document.getElementById("calendar_history");
                                var myChart = echarts.init(dom);
                                // myChart.resize()
                                var option;


                                // var dateList = [
                                //     ['2022-01-25', 200, '高温', '降水 大风', 200],
                                //     ['2022-01-26', 200, '低温', '雨', 200],
                                //     ['2022-01-27', 200, '浓雾', '风', 200],
                                //     ['2022-01-28', 200, '低温', '', 200],
                                //     ['2022-01-29', 200, '低温 浓雾', '降水 大风', 200],
                                //     ['2022-01-30', 200, ' ', '大风', 200],
                                //     ['2022-01-31', 200, ' ', '小雨', 200],
                                //     ['2022-02-01', 200, ' ', '', 200],
                                //     ['2022-02-02', 200, ' ', '', 200],
                                //     ['2022-02-03', 200, ' ', '', 200],
                                //     ['2022-02-04', 200, ' ', '', 200],
                                //     ['2022-02-05', 200, ' ', '强降水', 200],
                                //     ['2022-02-06', 200, ' ', '强降水', 200],
                                //     ['2022-02-07', 200, ' ', '强降水', 200],
                                //     ['2022-02-08', 200, ' ', '强降水', 200],
                                //     ['2022-02-09', 200, ' ', '强降水', 200],
                                //     ['2022-02-10', 200, ' ', '强降水', 200]
                                // ];
                                var dateList = day_list
                                // let heatmapData = [];
                                // let lunarData = [];
                                // for (let i = 0; i < dateList.length; i++) {
                                //     // heatmapData.push([dateList[i][0], dateList[i][1]]);
                                //     lunarData.push([dateList[i][0], dateList[i][1], dateList[i][2], dateList[i][3], dateList[i][4]]);
                                // }
                                // 日历的配置
                                option = {
                                    title: {
                                        text: '',
                                        textStyle: {fontSize: 30},
                                    },
                                    tooltip: {
                                        formatter: function (params) {
                                            // 实现显示的逻辑
                                            return '降雨量: ' + params.value[1].toFixed(2) + params.value[2] + params.value[3];
                                        }
                                    },
                                    visualMap: {
                                        show: false,
                                        min: 0,
                                        max: 300,
                                        calculable: true,
                                        seriesIndex: [3],
                                        orient: 'horizontal',
                                        left: 'center',
                                        bottom: 1,
                                        inRange: {
                                            // color: ['#e0ffff', '#006edd'],
                                            color: ['black'],
                                            opacity: 0.3
                                        },
                                        controller: {
                                            inRange: {
                                                opacity: 0.5
                                            }
                                        }
                                    },
                                    calendar: [
                                        {
                                            left: 'center',
                                            top: 60,
                                            cellSize: ['auto', 'auto'],
                                            yearLabel: {show: false},
                                            orient: 'vertical',
                                            dayLabel: {
                                                firstDay: 1,
                                                nameMap: 'cn'
                                            },
                                            monthLabel: {
                                                show: false
                                            },
                                            range: day_range//['2022-01-25', '2022-02-10']//day_range//['2022-04-14', '2022-04-25']
                                        }
                                    ],
                                    series: [
                                        {
                                            type: 'scatter',
                                            coordinateSystem: 'calendar',
                                            symbolSize: 1,
                                            label: {
                                                show: true,
                                                formatter: function (params) {
                                                    var d = echarts.number.parseDate(params.value[0]);
                                                    // return d.getDate() + '\n\n' + params.value[2] + '\n\n';
                                                    return d.getDate() + '\n' + '\n\n'
                                                },
                                                color: 'black'
                                            },
                                            data: dateList
                                        },
                                        {   //显示蓝色字
                                            type: 'scatter',
                                            coordinateSystem: 'calendar',
                                            symbolSize: 1,
                                            label: {
                                                show: true,
                                                formatter: function (params) {
                                                    return params.value[2];
                                                },
                                                fontSize: 12,
                                                fontWeight: 700,
                                                color: 'blue'
                                            },
                                            data: dateList
                                        },
                                        {   //显示字
                                            type: 'scatter',
                                            coordinateSystem: 'calendar',
                                            symbolSize: 1,
                                            label: {
                                                show: true,
                                                formatter: function (params) {
                                                    return '\n\n\n' + params.value[3];
                                                },
                                                fontSize: 12,
                                                fontWeight: 700,
                                                color: 'red'
                                            },
                                            data: dateList
                                        },
                                        {   //显示降水量
                                            name: '降雨量',
                                            type: 'heatmap',
                                            coordinateSystem: 'calendar',
                                            data: dateList
                                            // data: heatmapData
                                        }
                                    ]
                                };

                                if (option && typeof option === 'object') {
                                    myChart.setOption(option);
                                }
                                //日报数据的异步加载
                                myChart.on('click', function (params) {
                                    let componentType = params.componentType;   // geo是地图图层
                                    // 日报的数据加载
                                    var get_date = params.value[0]
                                    var get_1st = params.value[2]
                                    var get_2st = params.value[3]
                                    // console.log("数据", get_date)

                                    //ajax 请求数据
                                    var bar_list = echarts.init(document.getElementById('station_list'), 'light');
                                    //默认的加载数据
                                    bar_list.setOption(
                                        {
                                            title: {
                                                text: '请选择单站数据',
                                                textStyle: {fontSize: 25},
                                            },
                                            xAxis: {
                                                type: 'category',
                                                data: [1, 2, 3, 4, 5, 6],
                                                axisLine: {
                                                    show: true,    // 是否显示坐标轴轴线
                                                    symbol: ['none', 'none'],     // 轴线两端箭头，两个值，none表示没有箭头，arrow表示有箭头
                                                    symbolSize: [10, 15],     // 轴线两端箭头大小，数值一表示宽度，数值二表示高度
                                                    lineStyle: {
                                                        color: '#333',    // 坐标轴线线的颜色
                                                        width: '1',    // 坐标轴线线宽
                                                        type: 'solid',     // 坐标轴线线的类型（'solid'，实线类型；'dashed'，虚线类型；'dotted',点状类型）
                                                    },
                                                },
                                            },
                                            yAxis: {
                                                type: 'category',
                                                type: 'value',
                                                axisLine: {
                                                    show: true,    // 是否显示坐标轴轴线
                                                    symbol: ['none', 'none'],     // 轴线两端箭头，两个值，none表示没有箭头，arrow表示有箭头
                                                    symbolSize: [10, 15],     // 轴线两端箭头大小，数值一表示宽度，数值二表示高度
                                                    lineStyle: {
                                                        color: '#333',    // 坐标轴线线的颜色
                                                        width: '1',    // 坐标轴线线宽
                                                        type: 'solid',     // 坐标轴线线的类型（'solid'，实线类型；'dashed'，虚线类型；'dotted',点状类型）
                                                    },
                                                },
                                            },
                                            series: [{
                                                data: [0, 0, 0, 0, 0, 0],
                                                type: 'bar',
                                                label: {
                                                    show: false,
                                                    position: 'top'
                                                },
                                            }]
                                        }
                                    )

                                    var map_zdz_daily = echarts.init(document.getElementById('station_map'), 'light');

                                    var csrf = $('input[name="csrfmiddlewaretoken"]').val();
                                    //日报数据的异步加载
                                    $.ajax({
                                        url: "tool_zdz_daily",  // 请求的地址
                                        type: "post",  // 请求方式
                                        timeout: 25000, //设置延迟上限
                                        data: {
                                            'csrfmiddlewaretoken': csrf,
                                            'date': get_date,
                                            'get_1st': get_1st,
                                            'get_2st': get_2st

                                        },
                                        dataType: "json",
                                        success: function (data) {
                                            console.log("日报的返回成功", typeof (data.daily_data))
                                            var rain_daily = JSON.parse(data.daily_data)['rain']
                                            var wind_daily = JSON.parse(data.daily_data)['wind']
                                            var tmax_daily = JSON.parse(data.daily_data)['tmax']
                                            var tmin_daily = JSON.parse(data.daily_data)['tmin']
                                            var view_daily = JSON.parse(data.daily_data)['view']
                                            map_zdz_daily.setOption({
                                                legend: {
                                                    data: ['降水', '大风', '高温', '低温', '能见度'],
                                                    left: '10%',
                                                    selectedMode: 'single',
                                                    selected: {
                                                        '降水': true,
                                                        '大风': false,
                                                    }
                                                },
                                                title: {
                                                    text: '',
                                                    textStyle: {fontSize: 15},
                                                },
                                                geo: {
                                                    map: 'taizhou',
                                                    roam: true,
                                                    // tooltip:{borderColor = '#333'}
                                                    itemStyle: {
                                                        color: 'white'
                                                        // areaColor = '#333',
                                                    }


                                                },
                                                label: {
                                                    show: true,
                                                    color: "black",
                                                    fontSize: 15,
                                                    position: "top",
                                                    formatter: function (params) {
                                                        if (params['seriesName'] == '高温') {
                                                            //console.log("打印的是", params)
                                                            var lable_data = params['data']['value'][4]
                                                            return lable_data
                                                        } else if (params['seriesName'] == '低温') {
                                                            var lable_data = params['data']['value'][4]
                                                            return lable_data
                                                        } else if (params['seriesName'] == '降水') {
                                                            var lable_data = params['data']['value'][4]
                                                            return lable_data
                                                        } else {
                                                            var lable_data = " "
                                                            return lable_data
                                                        }
                                                    }
                                                },
                                                visualMap: {
                                                    seriesIndex: 0,
                                                    show: true,
                                                    right: '1%',
                                                    bottom: '1%',
                                                    orient: "horizontal",
                                                    pieces: [
                                                        {min: 100, max: 250, label: '特大暴雨'}, {
                                                            min: 50,
                                                            max: 100,
                                                            label: '大暴雨'
                                                        },
                                                        {min: 25, max: 50, label: '暴雨'}, {
                                                            min: 10,
                                                            max: 25,
                                                            label: '大雨'
                                                        },
                                                        {min: 0.1, max: 10, label: '中雨'}, {
                                                            min: 0,
                                                            max: 0.1,
                                                            label: '小雨'
                                                        },
                                                    ],
                                                    color: ["#800040", "#FA00FA", "#0000E1", "#61B8FF", '#3DBA3D', '#A6F28f']

                                                },
                                                series: [
                                                    {
                                                        name: '降水',
                                                        // type: 'effectScatter',
                                                        type: 'scatter',
                                                        symble: "circle",
                                                        // symbol: "roundRect",
                                                        symbolSize: 10,

                                                        coordinateSystem: 'geo',
                                                        data: rain_daily
                                                        // data: [
                                                        //     {
                                                        //         name: "K8517", value: [121.3, 28.7, [10, 170, 120, 90, 30, 150, 10], 110],
                                                        //         symbol: 'circle', color: '#00FFFF'
                                                        //     },
                                                        //     {
                                                        //         name: "K8519", value: [121.0, 28.8, [10, 170, 120, 90, 30, 150, 10], 110], url: "url_data",
                                                        //         symbol: 'circle'
                                                        //     }

                                                        // ]

                                                    },
                                                    {
                                                        name: '大风',
                                                        // type: 'effectScatter',
                                                        type: 'scatter',
                                                        symble: "circle",
                                                        // symbol: "roundRect",
                                                        symbolSize: 10,
                                                        color: 'red',
                                                        coordinateSystem: 'geo',
                                                        data: wind_daily
                                                        // data: [
                                                        //     {
                                                        //         name: "K8519", value: [121.0, 28.8, [10, 130, 120, 90, 30, 150, 10], [
                                                        //             {
                                                        //                 'symbol': 'path://M10 10L60 10 60 20 20 20 20 40 60 40 60 50 20 50 20 100 10 100 10 10z',
                                                        //                 'symbolRotate': 310,
                                                        //                 'value': 10
                                                        //             },
                                                        //             {
                                                        //                 'symbol': 'path://M10 10L60 10 60 20 20 20 20 40 60 40 60 50 20 50 20 100 10 100 10 10z',
                                                        //                 'symbolRotate': 30,
                                                        //                 'value': 130
                                                        //             },
                                                        //             {
                                                        //                 'symbol': 'path://M10 10L60 10 60 20 20 20 20 40 60 40 60 50 20 50 20 100 10 100 10 10z',
                                                        //                 'symbolRotate': 360,
                                                        //                 'value': 120
                                                        //             },
                                                        //             {
                                                        //                 'symbol': 'path://M10 10L60 10 60 20 20 20 20 40 60 40 60 50 20 50 20 100 10 100 10 10z',
                                                        //                 'symbolRotate': 360,
                                                        //                 'value': 90
                                                        //             },
                                                        //             {
                                                        //                 'symbol': 'path://M10 10L60 10 60 20 20 20 20 40 60 40 60 50 20 50 20 100 10 100 10 10z',
                                                        //                 'symbolRotate': 360,
                                                        //                 'value': 30
                                                        //             },
                                                        //             {
                                                        //                 'symbol': 'path://M10 10L60 10 60 20 20 20 20 40 60 40 60 50 20 50 20 100 10 100 10 10z',
                                                        //                 'symbolRotate': 360,
                                                        //                 'value': 150
                                                        //             },
                                                        //             {
                                                        //                 'symbol': 'path://M10 10L60 10 60 20 20 20 20 40 60 40 60 50 20 50 20 100 10 100 10 10z',
                                                        //                 'symbolRotate': 36,
                                                        //                 'value': 10
                                                        //             }
                                                        //         ], 253], url: "url_data",
                                                        //         symbol: 'path://M10 10L50 10 50 20 20 20 20 40 50 40 50 50 20 50 20 100 10 100 10 10z', symbolSize: 15, symbolRotate: 330
                                                        //     }

                                                        // ]

                                                    },
                                                    {
                                                        name: '高温',
                                                        // type: 'effectScatter',
                                                        type: 'scatter',
                                                        symble: "circle",
                                                        // symbol: "roundRect",
                                                        symbolSize: 10,
                                                        coordinateSystem: 'geo',
                                                        data: tmax_daily
                                                        // data: [
                                                        //     {
                                                        //         name: "K8519", value: [121.0, 28.8, [10, 13, 300, 90, 30, 150, 10], 25.3]
                                                        //     }

                                                        // ]

                                                    },
                                                    {
                                                        name: '低温',
                                                        // type: 'effectScatter',
                                                        type: 'scatter',
                                                        symble: "circle",
                                                        // symbol: "roundRect",
                                                        symbolSize: 10,
                                                        coordinateSystem: 'geo',
                                                        data: tmin_daily
                                                        // data: [
                                                        //     {
                                                        //         name: "K8519", value: [121.0, 28.8, [10, 13, 300, 90, 30, 150, 10], 25.3]
                                                        //     }

                                                        // ]

                                                    },
                                                    {
                                                        name: '能见度',
                                                        // type: 'effectScatter',
                                                        type: 'scatter',
                                                        symble: "circle",
                                                        // symbol: "roundRect",
                                                        symbolSize: 10,
                                                        coordinateSystem: 'geo',
                                                        data: view_daily
                                                        // data: [
                                                        //     {
                                                        //         name: "K8517", value: [121.3, 28.7, [10, 170, 120, 90, 30, 150, 10], 110],
                                                        //         symbol: 'circle', color: '#00FFFF'
                                                        //     },
                                                        //     {
                                                        //         name: "K8519", value: [121.0, 28.8, [10, 170, 120, 90, 30, 150, 10], 110], url: "url_data",
                                                        //         symbol: 'circle'
                                                        //     }

                                                        // ]

                                                    }
                                                ]


                                            });

                                            map_zdz_daily.on('click', function (params) {
                                                console.log("地图加载的数据", params)
                                                var series_option = {}
                                                if (params['componentType'] == 'series') {
                                                    console.log("地图的数据类型", params['seriesName'])
                                                    // 坐标值的区间
                                                    var x_data = params.value[2]
                                                    var data_line = params.value[2]
                                                    // 画图的细节
                                                    if (params['seriesName'] == '大风') {
                                                        console.log("风场", params['seriesName'])
                                                        bar_list.clear()
                                                        series_option =
                                                            {
                                                                title: {
                                                                    text: '风场',
                                                                    textStyle: {fontSize: 15},
                                                                },
                                                                xAxis: {
                                                                    type: 'category',
                                                                    data: params.value[2],
                                                                    axisLine: {
                                                                        show: true,    // 是否显示坐标轴轴线
                                                                        symbol: ['none', 'none'],     // 轴线两端箭头，两个值，none表示没有箭头，arrow表示有箭头
                                                                        symbolSize: [10, 15],     // 轴线两端箭头大小，数值一表示宽度，数值二表示高度
                                                                        lineStyle: {
                                                                            color: '#333',    // 坐标轴线线的颜色
                                                                            width: '1',    // 坐标轴线线宽
                                                                            type: 'solid',     // 坐标轴线线的类型（'solid'，实线类型；'dashed'，虚线类型；'dotted',点状类型）
                                                                        },
                                                                    },
                                                                },
                                                                yAxis: {
                                                                    // type: 'category',
                                                                    type: 'value',
                                                                    axisLine: {
                                                                        show: true,    // 是否显示坐标轴轴线
                                                                        symbol: ['none', 'none'],     // 轴线两端箭头，两个值，none表示没有箭头，arrow表示有箭头
                                                                        symbolSize: [10, 15],     // 轴线两端箭头大小，数值一表示宽度，数值二表示高度
                                                                        lineStyle: {
                                                                            color: '#333',    // 坐标轴线线的颜色
                                                                            width: '1',    // 坐标轴线线宽
                                                                            type: 'solid',     // 坐标轴线线的类型（'solid'，实线类型；'dashed'，虚线类型；'dotted',点状类型）
                                                                        },
                                                                    },
                                                                },
                                                                series: [
                                                                    {
                                                                        name: "image",
                                                                        data: params.value[5],
                                                                        //symbolRotate
                                                                        type: 'scatter',
                                                                        color: 'red',
                                                                    },
                                                                    {
                                                                        data: params.value[4],
                                                                        type: 'bar',
                                                                        barWidth: '20%',
                                                                        markPoint: {
                                                                            data: [
                                                                                {type: 'max', name: '最大值'},
                                                                                {type: 'min', name: '最小值'}
                                                                            ]
                                                                        },
                                                                        color: "blue",

                                                                        // label: {
                                                                        //     show: true,
                                                                        //     position: 'top',
                                                                        // }
                                                                    }

                                                                ]
                                                            }

                                                    } else if (params['seriesName'] == '高温') {


                                                        series_option =
                                                            {
                                                                title: {
                                                                    text: '高温',
                                                                    textStyle: {fontSize: 15},
                                                                },
                                                                xAxis: {
                                                                    type: 'category',
                                                                    data: params.value[2],
                                                                    axisLine: {
                                                                        show: true,    // 是否显示坐标轴轴线
                                                                        symbol: ['none', 'none'],     // 轴线两端箭头，两个值，none表示没有箭头，arrow表示有箭头
                                                                        symbolSize: [10, 15],     // 轴线两端箭头大小，数值一表示宽度，数值二表示高度
                                                                        lineStyle: {
                                                                            color: '#333',    // 坐标轴线线的颜色
                                                                            width: '1',    // 坐标轴线线宽
                                                                            type: 'solid',     // 坐标轴线线的类型（'solid'，实线类型；'dashed'，虚线类型；'dotted',点状类型）
                                                                        },
                                                                    },
                                                                },
                                                                yAxis: {
                                                                    type: 'category',
                                                                    type: 'value',
                                                                    axisLine: {
                                                                        show: true,    // 是否显示坐标轴轴线
                                                                        symbol: ['none', 'none'],     // 轴线两端箭头，两个值，none表示没有箭头，arrow表示有箭头
                                                                        symbolSize: [10, 15],     // 轴线两端箭头大小，数值一表示宽度，数值二表示高度
                                                                        lineStyle: {
                                                                            color: '#333',    // 坐标轴线线的颜色
                                                                            width: '1',    // 坐标轴线线宽
                                                                            type: 'solid',     // 坐标轴线线的类型（'solid'，实线类型；'dashed'，虚线类型；'dotted',点状类型）
                                                                        },
                                                                    },
                                                                },
                                                                series: [{
                                                                    data: params.value[3],
                                                                    type: 'line',
                                                                    markPoint: {

                                                                        data: [
                                                                            {type: 'max', name: '最大值'},
                                                                            {type: 'min', name: '最小值'}
                                                                        ]
                                                                    }
                                                                    // label: {
                                                                    //     show: true,
                                                                    //     position: 'top',
                                                                    // },
                                                                }]
                                                            }

                                                    } else if (params['seriesName'] == '低温') {


                                                        series_option =
                                                            {
                                                                title: {
                                                                    text: '低温',
                                                                    textStyle: {fontSize: 15},
                                                                },
                                                                xAxis: {
                                                                    type: 'category',
                                                                    data: params.value[2],
                                                                    axisLine: {
                                                                        show: true,    // 是否显示坐标轴轴线
                                                                        symbol: ['none', 'none'],     // 轴线两端箭头，两个值，none表示没有箭头，arrow表示有箭头
                                                                        symbolSize: [10, 15],     // 轴线两端箭头大小，数值一表示宽度，数值二表示高度
                                                                        lineStyle: {
                                                                            color: '#333',    // 坐标轴线线的颜色
                                                                            width: '1',    // 坐标轴线线宽
                                                                            type: 'solid',     // 坐标轴线线的类型（'solid'，实线类型；'dashed'，虚线类型；'dotted',点状类型）
                                                                        },
                                                                    },
                                                                },
                                                                yAxis: {
                                                                    type: 'category',
                                                                    type: 'value',
                                                                    axisLine: {
                                                                        show: true,    // 是否显示坐标轴轴线
                                                                        symbol: ['none', 'none'],     // 轴线两端箭头，两个值，none表示没有箭头，arrow表示有箭头
                                                                        symbolSize: [10, 15],     // 轴线两端箭头大小，数值一表示宽度，数值二表示高度
                                                                        lineStyle: {
                                                                            color: '#333',    // 坐标轴线线的颜色
                                                                            width: '1',    // 坐标轴线线宽
                                                                            type: 'solid',     // 坐标轴线线的类型（'solid'，实线类型；'dashed'，虚线类型；'dotted',点状类型）
                                                                        },
                                                                    },
                                                                },
                                                                series: [{
                                                                    data: params.value[3],
                                                                    type: 'line',
                                                                    markPoint: {

                                                                        data: [
                                                                            {type: 'max', name: '最大值'},
                                                                            {type: 'min', name: '最小值'}
                                                                        ]
                                                                    }
                                                                    // label: {
                                                                    //     show: true,
                                                                    //     position: 'top',
                                                                    // },
                                                                }]
                                                            }

                                                    } else if (params['seriesName'] == '能见度') {


                                                        series_option =
                                                            {
                                                                title: {
                                                                    text: '能见度',
                                                                    textStyle: {fontSize: 15},
                                                                },
                                                                xAxis: {
                                                                    type: 'category',
                                                                    data: params.value[2],
                                                                    axisLine: {
                                                                        show: true,    // 是否显示坐标轴轴线
                                                                        symbol: ['none', 'none'],     // 轴线两端箭头，两个值，none表示没有箭头，arrow表示有箭头
                                                                        symbolSize: [10, 15],     // 轴线两端箭头大小，数值一表示宽度，数值二表示高度
                                                                        lineStyle: {
                                                                            color: '#333',    // 坐标轴线线的颜色
                                                                            width: '1',    // 坐标轴线线宽
                                                                            type: 'solid',     // 坐标轴线线的类型（'solid'，实线类型；'dashed'，虚线类型；'dotted',点状类型）
                                                                        },
                                                                    },
                                                                },
                                                                yAxis: {
                                                                    type: 'category',
                                                                    type: 'value',
                                                                    axisLine: {
                                                                        show: true,    // 是否显示坐标轴轴线
                                                                        symbol: ['none', 'none'],     // 轴线两端箭头，两个值，none表示没有箭头，arrow表示有箭头
                                                                        symbolSize: [10, 15],     // 轴线两端箭头大小，数值一表示宽度，数值二表示高度
                                                                        lineStyle: {
                                                                            color: '#333',    // 坐标轴线线的颜色
                                                                            width: '1',    // 坐标轴线线宽
                                                                            type: 'solid',     // 坐标轴线线的类型（'solid'，实线类型；'dashed'，虚线类型；'dotted',点状类型）
                                                                        },
                                                                    },
                                                                },
                                                                series: [{
                                                                    data: params.value[3],
                                                                    type: 'line',
                                                                    markPoint: {

                                                                        data: [
                                                                            {type: 'max', name: '最大值'},
                                                                            {type: 'min', name: '最小值'}
                                                                        ]
                                                                    }
                                                                    // label: {
                                                                    //     show: true,
                                                                    //     position: 'top',
                                                                    // },
                                                                }]
                                                            }

                                                    } else if (params['seriesName'] == '降水') {


                                                        series_option =
                                                            {
                                                                title: {
                                                                    text: '降水',
                                                                    textStyle: {fontSize: 15},
                                                                },
                                                                xAxis: {
                                                                    type: 'category',
                                                                    data: params.value[2],
                                                                    axisLine: {
                                                                        show: true,    // 是否显示坐标轴轴线
                                                                        symbol: ['none', 'none'],     // 轴线两端箭头，两个值，none表示没有箭头，arrow表示有箭头
                                                                        symbolSize: [10, 15],     // 轴线两端箭头大小，数值一表示宽度，数值二表示高度
                                                                        lineStyle: {
                                                                            color: '#333',    // 坐标轴线线的颜色
                                                                            width: '1',    // 坐标轴线线宽
                                                                            type: 'solid',     // 坐标轴线线的类型（'solid'，实线类型；'dashed'，虚线类型；'dotted',点状类型）
                                                                        },
                                                                    },
                                                                },
                                                                yAxis: {
                                                                    type: 'category',
                                                                    type: 'value',
                                                                    axisLine: {
                                                                        show: true,    // 是否显示坐标轴轴线
                                                                        symbol: ['none', 'none'],     // 轴线两端箭头，两个值，none表示没有箭头，arrow表示有箭头
                                                                        symbolSize: [10, 15],     // 轴线两端箭头大小，数值一表示宽度，数值二表示高度
                                                                        lineStyle: {
                                                                            color: '#333',    // 坐标轴线线的颜色
                                                                            width: '1',    // 坐标轴线线宽
                                                                            type: 'solid',     // 坐标轴线线的类型（'solid'，实线类型；'dashed'，虚线类型；'dotted',点状类型）
                                                                        },
                                                                    },
                                                                },
                                                                series: [{
                                                                    data: params.value[3],
                                                                    type: 'bar',
                                                                    barWidth: '30%',
                                                                    color: "blue",
                                                                    markPoint: {

                                                                        data: [
                                                                            {type: 'max', name: '最大值'},
                                                                            {type: 'min', name: '最小值'}
                                                                        ]
                                                                    }
                                                                    // label: {
                                                                    //     show: true,
                                                                    //     position: 'top',
                                                                    // },
                                                                }]
                                                            }

                                                    }

                                                } else {
                                                    // 默认情况的xy
                                                    // console.log("不是series")

                                                    var series_option = {
                                                        title: {
                                                            text: '',
                                                            textStyle: {fontSize: 15},
                                                        },
                                                        xAxis: {
                                                            type: 'category',
                                                            data: [1, 2, 3, 4, 5, 6, 7, 8, 9],
                                                            axisLine: {
                                                                show: true,    // 是否显示坐标轴轴线
                                                                symbol: ['none', 'none'],     // 轴线两端箭头，两个值，none表示没有箭头，arrow表示有箭头
                                                                symbolSize: [10, 15],     // 轴线两端箭头大小，数值一表示宽度，数值二表示高度
                                                                lineStyle: {
                                                                    color: '#333',    // 坐标轴线线的颜色
                                                                    width: '1',    // 坐标轴线线宽
                                                                    type: 'solid',     // 坐标轴线线的类型（'solid'，实线类型；'dashed'，虚线类型；'dotted',点状类型）
                                                                },
                                                            },
                                                        },
                                                        yAxis: {
                                                            type: 'category',
                                                            type: 'value',
                                                            axisLine: {
                                                                show: true,    // 是否显示坐标轴轴线
                                                                symbol: ['none', 'none'],     // 轴线两端箭头，两个值，none表示没有箭头，arrow表示有箭头
                                                                symbolSize: [10, 15],     // 轴线两端箭头大小，数值一表示宽度，数值二表示高度
                                                                lineStyle: {
                                                                    color: '#333',    // 坐标轴线线的颜色
                                                                    width: '1',    // 坐标轴线线宽
                                                                    type: 'solid',     // 坐标轴线线的类型（'solid'，实线类型；'dashed'，虚线类型；'dotted',点状类型）
                                                                },
                                                            },
                                                        },
                                                        series: [{
                                                            data: [0, 0, 0, 0, 0, 0, 0, 0, 0],
                                                            type: 'bar',
                                                            label: {
                                                                show: false,
                                                                position: 'top',
                                                            },
                                                        }]
                                                    }

                                                }
                                                // console.log("打印ser", series_option)
                                                bar_list.clear()
                                                bar_list.setOption(series_option)

                                            })


                                        }

                                    })
                                    // echarts.registerMap('taizhou', tz_json, {});


                                    //开始加载
                                    $('#a_panel-725171').click()
                                });


                                // 加载降水图 tz_json
                                var chart = echarts.init(document.getElementById('map_bar'), 'light');
                                echarts.registerMap('taizhou', tz_json, {});
                                // var data_xy = [["天台", "仙居", "玉环", "临海", "黄岩", "三门", "温岭", "仙居", "仙居"], [600, 1150, 400, 850, 600, 650, 100, 1150, 100]]
                                var data_xy = rain_line
                                //
                                chart.setOption(
                                    {
                                        legend: {
                                            data: ['洪家', '椒江', '路桥', '黄岩', '临海', '温岭', '玉环', '天台', '仙居', '三门'],
                                            left: '15%',
                                            itemHeight: 4,
                                            itemWidth: 4,
                                            selectedMode: 'single'
                                        },

                                        xAxis: [
                                            {
                                                data: rain_line[0],
                                                axisLine: {
                                                    show: true,    // 是否显示坐标轴轴线
                                                    symbol: ['none', 'none'],     // 轴线两端箭头，两个值，none表示没有箭头，arrow表示有箭头
                                                    symbolSize: [10, 15],     // 轴线两端箭头大小，数值一表示宽度，数值二表示高度
                                                    lineStyle: {
                                                        color: '#333',    // 坐标轴线线的颜色
                                                        width: '1',    // 坐标轴线线宽
                                                        type: 'solid',     // 坐标轴线线的类型（'solid'，实线类型；'dashed'，虚线类型；'dotted',点状类型）
                                                    },
                                                }
                                            }
                                        ],
                                        yAxis: [

                                            {
                                                name: '面雨量',
                                                splitLine: {show: false},
                                                axisLine: {
                                                    show: true,    // 是否显示坐标轴轴线
                                                    symbol: ['none', 'none'],     // 轴线两端箭头，两个值，none表示没有箭头，arrow表示有箭头
                                                    symbolSize: [10, 15],     // 轴线两端箭头大小，数值一表示宽度，数值二表示高度
                                                    lineStyle: {
                                                        color: '#333',    // 坐标轴线线的颜色
                                                        width: '1',    // 坐标轴线线宽
                                                        type: 'solid',     // 坐标轴线线的类型（'solid'，实线类型；'dashed'，虚线类型；'dotted',点状类型）
                                                    },
                                                },

                                            }
                                        ],
                                        grid: {
                                            left: "8%",
                                            top: "10%",
                                            right: "30%",
                                            bottom: "15%",
                                            borderWidth: 1
                                        },
                                        graphic: [
                                            {
                                                type: 'image', // 图形元素类型
                                                right: '2%', // 根据父元素进行定位 （居中）
                                                bottom: '7%', // 根据父元素进行定位   （0%）, 如果bottom的值是 0，也可以删除该bottom属性值。
                                                z: 3,  // 层叠
                                                bounding: 'all', // 决定此图形元素在定位时，对自身的包围盒计算方式
                                                style: {
                                                    image: data.rain_img,//'static/src/温度.png', // 这里一定要注意、注意，必须是https开头的图片路径地址
                                                    width: 350,
                                                    height: 350
                                                }
                                            }
                                        ],
                                        dataZoom: [
                                            {
                                                show: true,
                                                start: 0,
                                                height: 20,
                                                left: "20%",
                                                bottom: 10,
                                                end: 100
                                            },
                                            {
                                                type: 'inside',
                                                start: 94,
                                                height: 20,

                                                bottom: 10,
                                                end: 100
                                            }
                                        ],
                                        series: [
                                            {
                                                name: '洪家',
                                                type: 'bar',
                                                color: 'red',
                                                data: rain_line[2]
                                            },
                                            {
                                                name: '椒江',
                                                type: 'bar',
                                                color: 'blue',
                                                data: rain_line[1]
                                            },
                                            {
                                                name: '路桥',
                                                type: 'bar',
                                                color: 'red',
                                                data: rain_line[2]
                                            },
                                            {
                                                name: '黄岩',
                                                type: 'bar',
                                                color: 'red',
                                                data: rain_line[2]
                                            },
                                            {
                                                name: '临海',
                                                type: 'bar',
                                                color: 'red',
                                                data: rain_line[2]
                                            },
                                            {
                                                name: '温岭',
                                                type: 'bar',
                                                color: 'red',
                                                data: rain_line[2]
                                            },
                                            {
                                                name: '玉环',
                                                type: 'bar',
                                                color: 'red',
                                                data: rain_line[2]
                                            },
                                            {
                                                name: '天台',
                                                type: 'bar',
                                                color: 'red',
                                                data: rain_line[2]
                                            },
                                            {
                                                name: '仙居',
                                                type: 'bar',
                                                color: 'red',
                                                data: rain_line[2]
                                            },
                                            {
                                                name: '三门',
                                                type: 'bar',
                                                color: 'red',
                                                data: rain_line[2]
                                            },
                                        ]
                                    })


                            }

                        })


                    } else if (type == "tool_ec") {
                        // console.log("---------------ec温度数据导出---------------")

                        var csrf = $('input[name="csrfmiddlewaretoken"]').val();
                        $.ajax({
                            url: "ec_single_data",  // 请求的地址
                            type: "post",  // 请求方式
                            timeout: 25000, //设置延迟上限
                            data: {
                                'csrfmiddlewaretoken': csrf,
                                'ec_start_time': $('#ec_start_time').val(),
                                'ec_end_time': $('#ec_end_time').val()
                            },
                            dataType: "json",
                            success: function (data) {
                                console.log("返回成功", data)
                                // var serverdata = JSON.parse(data)
                                $('#product_view').html(" ")
                                var product_view = document.getElementById("product_view")
                                product_view.style = ";width:97.5%;height:97%;background-color:white;margin:15px"
                                // 绘图的核心程序
                                var topdiv = document.createElement('div')
                                topdiv.style = "display:inline-flex;width: 100%; height: 50%;border-radius: 10px;"

                                var map_tool1 = document.createElement('div')
                                map_tool1.style = "width: 48%; height: 90%;margin:15px;border-radius: 20px;"
                                map_tool1.id = "map_tool1"

                                var line_average = document.createElement('div')
                                line_average.style = "width: 48%; height: 90%;margin:15px;border-radius: 20px;"
                                line_average.id = "line_average"
                                topdiv.append(line_average, map_tool1)


                                var ec_single_data = document.createElement('div')
                                ec_single_data.style = "width: 97%; height: 47.5%;background-color: white;margin:15px;border-radius: 20px;"
                                ec_single_data.id = "ec_line"


                                product_view.append(topdiv, ec_single_data)

                                var lineaverage = echarts.init(document.getElementById("line_average"));//document.getElementById('line_average');
                                lineaverage.setOption({
                                        title: {
                                            text: '雨量排序',
                                            left: 'left',
                                            textStyle: {
                                                color: '#826'
                                            }
                                        },
                                        backgroundColor: 'rgba(128, 128, 128, 0.1)',
                                        legend: {
                                            top: 'bottom'
                                        },
                                        toolbox: {
                                            show: true,
                                            feature: {
                                                mark: {show: true},
                                                dataView: {show: true, readOnly: false},
                                                restore: {show: true},
                                                saveAsImage: {show: true}
                                            }
                                        },
                                        series: [
                                            {
                                                name: '乡镇排名',
                                                type: 'pie',
                                                radius: [10, 120],
                                                center: ['50%', '50%'],
                                                roseType: 'area',
                                                itemStyle: {
                                                    borderRadius: 8
                                                },
                                                data: data.ec_data['rain']
                                                // data: [
                                                //     { value: 0, name: 'rose 1' },
                                                //     { value: 8, name: 'rose 2' },
                                                //     { value: 2, name: 'rose 3' },
                                                //     { value: 0, name: 'rose 4' },
                                                //     { value: 0, name: 'rose 5' },
                                                //     { value: 0, name: 'rose 6' },
                                                //     { value: 0, name: 'rose 7' },
                                                //     { value: 1, name: 'rose 8' },
                                                //     { value: 0, name: 'rose 9' },
                                                //     { value: 0, name: 'rose 10' }
                                                // ]
                                            }
                                        ]
                                    }
                                )


                                // data
                                const colors = ['#5470C6', '#91CC75', '#EE6666'];
                                const symbolSize = 20;

                                //乡镇地图v
                                if ($('#ec_map').val() == 'city') {
                                    echarts.registerMap('taizhou', taizhou_xian, {});
                                } else {

                                    echarts.registerMap('taizhou', taizhou, {});

                                }
                                var chartDom = document.getElementById('map_tool1');
                                var map_ec = echarts.init(chartDom, 'light');

                                map_ec.setOption({
                                    title: {
                                        text: '台州市各县市面雨量分布',
                                        left: 'left',
                                        textStyle: {
                                            color: '#826'
                                        }
                                    },
                                    backgroundColor: 'rgba(128, 128, 128, 0.1)',
                                    tooltip: {
                                        trigger: 'item',
                                        // formatter: '{c}(m/s)'
                                        formatter: function (params) {
                                            // do some thing
                                            return params.name + ":" + params.value
                                        }
                                    },
                                    visualMap: {
                                        show: true,
                                        x: 'left',
                                        y: 'bottom',
                                        pieces: [
                                            {min: 50, max: 250}, {min: 25, max: 50},
                                            {min: 15, max: 25}, {min: 10, max: 15},
                                            {min: 0.1, max: 10}, {min: 0, max: 0.1},
                                        ],
                                        color: ['#5475f5', '#9feaa5', '#85daef', '#74e2ca', '#e6ac53', '#9fb5ea']
                                    },
                                    geo: {
                                        map: 'taizhou',
                                        // roam: true,
                                        // tooltip:{borderColor = '#333'}
                                        itemStyle: {
                                            color: 'white'
                                            // areaColor = '#333',
                                        }


                                    },


                                    series: [{
                                        name: '面雨量',
                                        // type: 'effectScatter',
                                        type: 'map',
                                        map: 'taizhou',
                                        // coordinateSystem: 'geo',
                                        data: data.ec_data['rain']
                                        // data: [
                                        //     { name: "临海市", value: 50 },
                                        //     { name: "三门县", value: 150 },
                                        //     { name: "仙居县", value: 230 },
                                        //     { name: "天台县", value: 270 },
                                        //     { name: "黄岩区", value: 250 },
                                        //     { name: "椒江区", value: 50 },
                                        //     { name: "路桥区", value: 210 },
                                        //     { name: "温岭市", value: 220 },
                                        //     { name: "玉环市", value: 260 }
                                        // ]

                                    }]


                                });
                                // ec地图的相应事件
                                map_ec.on('click', function (params) {
                                    // console.log(params)
                                    let componentType = params.componentType;   // geo是地图图层
                                    var name = ['三门县', '临海市', '仙居县', '天台县', '椒江区', '温岭市', '玉环市', '路桥区', '黄岩区']
                                    var name_en = ['sanmen', 'linhai', 'xianju', 'tiantai', 'jiaojiang', 'wenling', 'yuhuan', 'luqiao', 'huangyan']

                                    if (componentType == "series") {
                                        for (var i = 0; i < data.ec_data.village.length; i++) {
                                            // console.log(params.name)
                                            if (name[i] == params.name) {
                                                var villagedata = data.ec_data.village[i]

                                                var linedata = data.ec_data[name_en[i]]
                                                // bar
                                                lineaverage.setOption({
                                                    series: [
                                                        {
                                                            name: '乡镇排名',
                                                            type: 'pie',
                                                            radius: [10, 120],
                                                            center: ['50%', '50%'],
                                                            roseType: 'area',
                                                            itemStyle: {
                                                                borderRadius: 8
                                                            },
                                                            data: villagedata

                                                        }
                                                    ]

                                                })

                                                lineChart.setOption({
                                                    title: {
                                                        text: params.name,
                                                        left: 'center',
                                                        textStyle: {
                                                            color: '#826'
                                                        }
                                                    },
                                                    xAxis: [
                                                        {
                                                            type: 'category',
                                                            // type: 'value',
                                                            axisTick: {
                                                                alignWithLabel: true
                                                            },
                                                            // prettier-ignore
                                                            data: linedata['time']
                                                        }
                                                    ],
                                                    yAxis: [{
                                                        type: 'value',
                                                        name: '降水',
                                                        position: 'right',
                                                        alignTicks: true,
                                                        // offset: 80,
                                                        max: function (value) {
                                                            return value.max * 2.5;
                                                        },
                                                        axisLine: {
                                                            show: true,
                                                            lineStyle: {
                                                                color: colors[1]
                                                            }
                                                        },
                                                        axisLabel: {
                                                            formatter: '{value} mm'
                                                        }
                                                    },
                                                        {
                                                            type: 'value',
                                                            name: '温度',
                                                            position: 'left',
                                                            alignTicks: true,
                                                            max: function (value) {
                                                                return value.max + 3;
                                                            },
                                                            min: function (value) {
                                                                return value.min - 10;
                                                            },
                                                            axisLine: {
                                                                show: true,
                                                                lineStyle: {
                                                                    color: colors[2]
                                                                }
                                                            },
                                                            axisLabel: {
                                                                formatter: '{value} °C'
                                                            }
                                                        }],
                                                    series: [
                                                        {
                                                            name: '降水1',
                                                            id: "a",
                                                            type: 'bar',
                                                            yAxisIndex: 0,
                                                            data: linedata['lsp']
                                                        },
                                                        {
                                                            name: '降水2',
                                                            id: "b",
                                                            type: 'bar',
                                                            yAxisIndex: 0,
                                                            data: linedata['cp']
                                                        },
                                                        {
                                                            name: '温度',
                                                            id: "c",
                                                            type: 'line',
                                                            smooth: true,
                                                            yAxisIndex: 1,
                                                            data: linedata['t2']
                                                        }
                                                    ]

                                                })
                                            }
                                            // console.log(data.ec_data.village)

                                        }

                                        // var offsetX = params.event.offsetX;
                                        // var offsetY = params.event.offsetY;
                                        // var zuobiao = map.convertFromPixel('geo', [offsetX, offsetY]); // 转换成坐标
                                        // var detail = taizhou_xz[params.name]

                                    }
                                });

                                // 时序图
                                const lineChart = echarts.init(document.getElementById("ec_line"));//echarts.init($("#ec_line")[0]);
                                lineChart.setOption({
                                    color: colors,
                                    backgroundColor: 'rgba(128, 128, 128, 0.1)',
                                    title: {
                                        text: '',
                                        left: 'left',
                                        textStyle: {
                                            color: '#826'
                                        }
                                    },
                                    tooltip: {
                                        triggerOn: 'none',
                                        // formatter: function (params) {
                                        //     return (
                                        //         'X: ' +
                                        //         params.data[0] +
                                        //         '<br>Y: ' +
                                        //         params.data[1].toFixed(2)
                                        //     );
                                        // }
                                    },
                                    grid: {
                                        top: '8%',
                                        right: '6%',
                                        left: '6%',
                                        bottom: '8%'
                                    },
                                    xAxis: [
                                        {
                                            type: 'category',
                                            // type: 'value',
                                            axisTick: {
                                                alignWithLabel: true
                                            },
                                            // prettier-ignore
                                            data: data.ec_data['hongjia']['time']
                                        }
                                    ],
                                    yAxis: [{
                                        type: 'value',
                                        name: '降水',
                                        position: 'right',
                                        alignTicks: true,
                                        // offset: 80,
                                        max: function (value) {
                                            return value.max * 2.5;
                                        },
                                        axisLine: {
                                            show: true,
                                            lineStyle: {
                                                color: colors[1]
                                            }
                                        },
                                        axisLabel: {
                                            formatter: '{value} mm'
                                        }
                                    },
                                        {
                                            type: 'value',
                                            name: '温度',
                                            position: 'left',
                                            alignTicks: true,
                                            max: function (value) {
                                                return value.max + 3;
                                            },
                                            min: function (value) {
                                                return value.min - 10;
                                            },
                                            axisLine: {
                                                show: true,
                                                lineStyle: {
                                                    color: colors[2]
                                                }
                                            },
                                            axisLabel: {
                                                formatter: '{value} °C'
                                            }
                                        }],
                                    series: [
                                        {
                                            name: '降水1',
                                            id: "a",
                                            type: 'bar',
                                            yAxisIndex: 0,
                                            data: data.ec_data['hongjia']['lsp']
                                        },
                                        {
                                            name: '降水2',
                                            id: "b",
                                            type: 'bar',
                                            yAxisIndex: 0,
                                            data: data.ec_data['hongjia']['cp']
                                        },
                                        {
                                            name: '温度',
                                            id: "c",
                                            type: 'line',
                                            smooth: true,
                                            yAxisIndex: 1,
                                            data: data.ec_data['hongjia']['t2']
                                        }
                                    ]
                                });


                            }
                        })

                    } else if (type == "select_self_plot") {
                        $('#product_view').html(" ")

                        var select_map = $('#self_plot_country').val()
                        var select_id = $('#select_self_plot').val()
                        var csrf = $('input[name="csrfmiddlewaretoken"]').val();
                        $.ajax({
                            url: "select_self_plot",  // 请求的地址
                            type: "post",  // 请求方式
                            timeout: 25000, //设置延迟上限
                            data: {
                                'csrfmiddlewaretoken': csrf,
                                'select_id': $('#select_self_plot').val()
                            },
                            dataType: "json",
                            success: function (data) {
                                console.log("返回成功", data)
                                // function return_boundaries(city) {

                                // }

                                function return_layers(grid, boundaries) {
                                    var isobands_options = {
                                        zProperty: "value",
                                        commonProperties: {
                                            "fill-opacity": 0.9
                                        },
                                        breaksProperties: [
                                            {fill: "rgb(255,255,255)"},
                                            {fill: "rgb(140,246,130)"},
                                            {fill: "rgb(0,191,27)"},
                                            {fill: "rgb(62,185,255)"},
                                            {fill: "rgb(25,0,235)"},
                                            {fill: "rgb(255,0,255)"},
                                            {fill: "rgb(140,0,65)"}
                                        ]
                                    };
                                    var levelV = [10, 20, 30, 50, 70, 90, 100];
                                    var isobands = turf.isobands(
                                        grid,
                                        levelV,
                                        isobands_options
                                    );
                                    var isobandsLay = L.geoJSON(isobands, {
                                        style: function (feature) {
                                            return {
                                                color: '#4264fb',
                                                fillColor: feature.properties.fill,
                                                weight: 0.1,
                                                fillOpacity: 0.8
                                            };
                                        }
                                    });
                                    //   裁剪数据
                                    var features = [];//裁剪后的结果集
                                    isobands.features.forEach(function (feature1) {
                                        boundaries.features.forEach(function (feature2) {
                                            var intersection = null;
                                            try {
                                                intersection = turf.intersect(feature1, feature2);
                                            } catch (e) {
                                                try {
                                                    //色斑图绘制之后，可能会生成一些非法 Polygon ，例如 在 hole 里存在一些形状（听不懂？去查一下 GeoJSON 的规范），
                                                    //我遇到的一个意外情况大概是这样，这种 Polygon 在做 intersect() 操作的时候会报错，所以在代码中做了个容错操作。
                                                    //解决的方法通常就是做一次 turf.buffer() 操作，这样可以把一些小的碎片 Polygon 清理掉。
                                                    feature1 = turf.buffer(feature1, 0);
                                                    intersection = turf.intersect(feature1, feature2);
                                                } catch (e) {
                                                    intersection = feature1;//实在裁剪不了就不裁剪了,根据业务需求自行决定
                                                }
                                            }
                                            if (intersection != null) {
                                                intersection.properties = feature1.properties;
                                                intersection.id = (Math.random() * 100000).toFixed(0);
                                                features.push(intersection);
                                            }
                                        });
                                    });
                                    //turf.isobands有点不符合业务预期,只有一个等级时,结果集可能为空,无图形显示,写点程序(找出那一个等级，并添加进结果集)补救下
                                    if (features.length == 0) {
                                        var maxAttribute = getMaxAttribute(levelV, grid, isobands_options.breaksProperties);
                                        var value = maxAttribute[0];
                                        var fill = maxAttribute[1];
                                        if (value != '' && fill != '') {
                                            //获取网格点Box
                                            var gridBox = turf.bbox(grid);
                                            //生成网格点范围的面
                                            var gridBoxPolygon = [[[gridBox[0], gridBox[1]], [gridBox[0], gridBox[3]], [gridBox[2], gridBox[3]], [gridBox[2], gridBox[1]], [gridBox[0], gridBox[1]]]];
                                            //获取网格范围的面与行政边界的交集 Polygon
                                            var intersectPolygon = null;
                                            var gridoxFeature = {
                                                "type": "Feature",
                                                "properties": {"fill-opacity": 0.8},
                                                "geometry": {"type": "Polygon", "coordinates": gridBoxPolygon},
                                                "id": 10
                                            };
                                            try {
                                                intersectPolygon = turf.intersect(gridoxFeature, boundaries.features[0]);
                                            } catch (e) {
                                                try {
                                                    //色斑图绘制之后，可能会生成一些非法 Polygon ，例如 在 hole 里存在一些形状（听不懂？去查一下 GeoJSON 的规范），
                                                    //我遇到的一个意外情况大概是这样，这种 Polygon 在做 intersect() 操作的时候会报错，所以在代码中做了个容错操作。
                                                    //解决的方法通常就是做一次 turf.buffer() 操作，这样可以把一些小的碎片 Polygon 清理掉。
                                                    gridoxFeature = turf.buffer(gridoxFeature, 0);
                                                    intersectPolygon = turf.intersect(gridoxFeature, boundaries.features[0]);
                                                } catch (e) {
                                                    intersectPolygon = gridoxFeature;//实在裁剪不了就不裁剪了,根据业务需求自行决定
                                                }
                                            }
                                            //结果添加到结果数组
                                            if (intersectPolygon != null) {
                                                features.push({
                                                    "type": "Feature",
                                                    "properties": {"fill-opacity": 0.8, "fill": fill, "value": value},
                                                    "geometry": intersectPolygon.geometry,
                                                    "id": 0
                                                });
                                            }
                                        }
                                    }
                                    var intersection = turf.featureCollection(features);
                                    var intersectionLay = L.geoJSON(intersection, {
                                        style: function (feature) {
                                            return {
                                                color: 'black',
                                                fillColor: feature.properties.fill,
                                                weight: 0.1,
                                                fillOpacity: 0.7
                                            };
                                        }
                                    })
                                    return intersectionLay


                                }

                                //按钮组
                                var product_view = document.getElementById('product_view')
                                product_view.style = "width:97.5%;height:97%;background-color:white;margin:15px"
                                //加载数据地图
                                var tzmap = document.createElement("div")
                                tzmap.style = "width: 100%;height:100%;border: 1px solid black;"
                                tzmap.id = "product_self"
                                var mainui = document.createElement("div")
                                mainui.style = "position:absolute;text-align: center;width: 30%;height: 5%;top:15%;left:60%;overflow-x: scroll;overflow-y: hidden;border-bottom:2px solid black;padding-top:10px;"
                                mainui.id = "menu-self-ui"
                                mainui.setAttribute("class", "scrollbar_self")

                                var labels = ["台州", "玉环", "温岭", "三门", "天台", "仙居", "临海", "路桥", "椒江", "黄岩"]
                                var layerstr = [taizhou_map, yuhuan_map, wenling_map, sanmen_map, tiantai_map, xianju_map, linhai_map, luqiao_map, jiaojiang_map, huangyan_map]
                                var Lat = [28.7, 28.1, 28.4, 29.1, 29.1, 29.8, 28.7, 28.5, 28.5, 28.6]
                                var Lon = [121.1, 121.1, 121.3, 121.2, 121.0, 120.7, 121.1, 121.4, 121.4, 121.2]
                                var zoon = [9, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11]
                                for (var i = 0; i < labels.length; i++) {
                                    var id = "self_silder" + i.toString();
                                    var singlebtn = document.createElement("button");
                                    singlebtn.id = id;
                                    singlebtn.style = "width:10%;height: 100%;margin-top:8px; border-radius:8px;"
                                    singlebtn.innerText = labels[i]
                                    singlebtn.onclick = function (e) {
                                        map_product.eachLayer(function (layer) {
                                            if (!layer._container || ('' + jQuery(layer._container).attr('class')).replace(/\s/g, '') != 'leaflet-layer') {
                                                layer.remove();
                                            }
                                        });
                                        //id

                                        var item = this.id
                                        var ites = item.substring(11, item.length)
                                        //截取数字
                                        var boundaries = {
                                            type: "FeatureCollection",
                                            name: "boundaries",
                                            crs: {type: "name", properties: {name: "urn:ogc:def:crs:OGC:1.3:CRS84"}},
                                            features: layerstr[parseInt(ites)]
                                        };
                                        map_product.bounds = turf.bbox(boundaries);
                                        map_product.setView([Lat[parseInt(ites)], Lon[parseInt(ites)]], zoon[parseInt(ites)])
                                        var lines = L.geoJSON(boundaries, {
                                            style: function (feature) {
                                                return {color: 'black', weight: 1, fillOpacity: 0.1};
                                            }
                                        }).addTo(map_product)
                                        var intersectionLay = return_layers(grid, boundaries)
                                        intersectionLay.addTo(map_product)


                                    }
                                    mainui.append(singlebtn)
                                }
                                product_view.append(tzmap, mainui)

                                var boundaries = {
                                    type: "FeatureCollection",
                                    name: "boundaries",
                                    crs: {type: "name", properties: {name: "urn:ogc:def:crs:OGC:1.3:CRS84"}},
                                    features: taizhoulist
                                };

                                var map_product = new L.Map('product_self', {
                                    center: new L.LatLng(28.7, 121.1),//110.763, 41.376   39.62353145, 121.9937485
                                    zoom: 9, //4
                                    zoomControl: false,
                                    // dragging: false,
                                    // scrollWheelZoom: false,
                                    doubleClickZoom: false,
                                    attributionControl: false, //是否去除右下角标志
                                    layers: []
                                });
                                var lines = L.geoJSON(boundaries, {
                                    style: function (feature) {
                                        return {color: 'black', weight: 1, fillOpacity: 0.1};
                                    }
                                }).addTo(map_product)

                                map_product.bounds = turf.bbox(boundaries);
                                var grid = data.grid
                                var intersectionLay = return_layers(grid, boundaries)
                                intersectionLay.addTo(map_product)
                            }
                        })


                    }
                }

                // 自定义材料加载
                $('#product_show_button').click(function () {
                    var type = "product_show"
                    product_view_show(type)

                })
                // 画图--精细化
                $('#plot_self_button').click(function () {
                    var type = "plot_self"
                    product_view_show(type)
                    // var chartDom = document.getElementById('canvas_bar');
                    // var myChart_bar = echarts.init(chartDom);

                })
                // 市台历史数据的显示
                $('.tool_history_button').click(function () {
                    var type = "tool_history"
                    // console.log("tool_history_button")
                    product_view_show(type)


                })

                // 市台订正数据加载
                $('.tool_prodict_product').click(function () {
                    // console.log("点击了数据文件")
                    var type = "tool_prodict_product"
                    product_view_show(type)

                })

                // 自动站数据加载
                $('#tool_zdz_button').click(function () {
                    var type = "tool_zdz"
                    product_view_show(type)

                })
                // 精细化EC单点数据加载
                $('#tool_ec_button').click(function () {
                    var type = "tool_ec"
                    product_view_show(type)

                })

                // 降水订正
                $('#tool_selfplot_button').click(function () {
                    var type = "select_self_plot"
                    product_view_show(type)

                })


            </script>


        </div>

    </div>
    {% csrf_token %}
</div>


</body>

</html>