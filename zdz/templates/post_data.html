<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>台州气象快报系统</title>
    <script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/popper.js/1.15.0/umd/popper.min.js"></script>
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="static/css/jquery.datetimepicker.css" />
    <script src="static/js/jquery.datetimepicker.full.min.js"></script>
    <script type="text/javascript" src="static/js/echarts.min.js"></script>
    <script type="text/javascript" src="static/js/echarts-gl.min.js"></script>
    <script type="text/javascript" src="static/js/ecStat.min.js"></script>
    <script type="text/javascript" src="static/js/dataTool.min.js"></script>
    <script type="text/javascript" src="static/js/china.js"></script>
    <script type="text/javascript" src="static/js/world.js"></script>
    <script type="text/javascript" src="static/js/theme.js"></script>
    <link rel="stylesheet" type="text/css" href="static/css/bootcss.css" />



</head>

<body style="background-color:#FEF8EF">





    <!-- 上传数据的表单 -->
    <script>
        $(function () {
            $("#find").click(function () {
                // console.log("click")
                var start = $("#datetimepicker1").datetimepicker('getValue');
                var end = $("#datetimepicker2").datetimepicker('getValue');
                var nowDate = new Date();
                var nowtime = nowDate.toLocaleTimeString();
                // alert("时间错误")

                const start_time = new Date(start)
                const end_time = new Date(end)
                // 判断时间的正确性
                if (start_time.getTime() > end_time.getTime()) {
                    alert("时间错误")
                }
                if (nowtime < end_time.getTime()) {
                    alert("时间错误")
                }


                var csrf = $('input[name="csrfmiddlewaretoken"]').val();
                // console.log(end)
                // var myselect=$("#city").val();
                // var index=myselect.selectedIndex;
                var options = $("#city option:selected");
                var city = options.text()

                $.ajax({
                    url: "post_data",  // 请求的地址
                    type: "post",  // 请求方式
                    // 请求时传递过去的数据
                    data: {
                        "start": start,
                        "end": end,
                        'csrfmiddlewaretoken': csrf,
                        'city': city

                    },
                    dataType: "json",  // 返回的数据格式
                    // async: true,  // 异步的ajax
                })
            })
        })
    </script>
    <div class="container-fiuled" id="form_post" style="padding-right: 30px; padding-left: 30px;">
        {% csrf_token %}
        <div class="row clearfix">
            <div class="col-md-12 column">
                <div class="row clearfix">
                    <legend>气象快报系统</legend>
                    <div class="col-md-2 column">
                        <select class="form-control" id="city">
                            <option value="台州市">台州市</option>
                            <option value="天台">天台</option>
                            <option value="仙居">仙居</option>
                            <option value="三门">三门</option>
                            <option value="临海">临海</option>
                            <option value="椒江">椒江</option>
                            <option value="黄岩">黄岩</option>
                            <option value="路桥">路桥</option>
                            <option value="温岭">温岭</option>
                            <option value="玉环">玉环</option>
                        </select>
                    </div>
                    <div class="col-md-8 column">
                        <div class="row clearfix">
                            <div class="col-md-6 column">
                                起始时间:<input id="datetimepicker1" type="text">
                                <script>
                                    $('#datetimepicker1').datetimepicker(
                                        {
                                            theme: 'dark',
                                            format: 'Y-m-d H:i'
                                        }
                                    );
                                </script>

                            </div>
                            <div class="col-md-6 column">
                                结束时间:<input id="datetimepicker2" type="text">
                                <script>
                                    $('#datetimepicker2').datetimepicker(
                                        {
                                            theme: 'dark',
                                            format: 'Y-m-d H:i'
                                        }
                                    );
                                </script>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-2 column">
                        <button type="button" class="btn btn-lg btn-block btn-primary" id="find">查询</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 正文数据 -->
    <div class="tabbable" id="tabs-53066">
        <ul class="nav nav-tabs">
            <li class="active">
                <a href="#panel-a1" data-toggle="tab">降水</a>
            </li>
            <li>
                <a href="#panel-a2" data-toggle="tab">气温</a>
            </li>
            <li>
                <a href="#panel-a3" data-toggle="tab">能见度</a>
            </li>
            <li>
                <a href="#panel-a4" data-toggle="tab">大风</a>
            </li>
        </ul>

        <div class="tab-content">
            <!-- 降水模块 -->
            <div class="tab-pane active" id="panel-a1">
                <div class="container-fiuled" style="padding-right: 30px; padding-left: 30px;">
                    <legend>降水统计</legend>
                    <div class="row clearfix">
                        <div class="col-md-12 column">
                            <div class="row clearfix">
                                <div class="col-md-6 column">
                                    <div class="tabbable" id="tabs-373474">
                                        <ul class="nav nav-tabs">
                                            <li class="active">
                                                <a href="#panel-1" data-toggle="tab">累计降水</a>
                                            </li>
                                            <li>
                                                <a href="#panel-2" data-toggle="tab">散点分布</a>
                                            </li>
                                            <li>
                                                <a href="#panel-3" data-toggle="tab">数据分布</a>
                                            </li>
                                            <li>
                                                <a href="#panel-4" data-toggle="tab">流域降水</a>
                                            </li>
                                        </ul>
                                        <div class="tab-content">
                                            <div class="tab-pane active" id="panel-1">
                                                <!-- <p>
                                                                这里是第一块的内容
                                                            </p> -->
                                                <!-- <img src="{{ img }}"> -->
                                                <div id="map1" style="height: 550%;overflow: auto;"></div>
                                                <script>
                                                    var map1 = echarts.init(document.getElementById('map1'), 'vintage');
                                                    // console.log("666")
                                                    var taizhou = {{ taizhou| safe}};
                                                    echarts.registerMap('taizhou', taizhou);
                                                    // console.log("666")
                                                    //console.log({{context.tz_json}})
                                                    // console.log(taizhou)
                                                    map1.setOption({
                                                        title: {
                                                            text: '',
                                                            textStyle: { fontSize: 50 },
                                                        },
                                                        tooltip: {
                                                            trigger: 'item',
                                                            formatter: function (params) {
                                                                // do some thing
                                                                return params.name + ":" + params.value[2]
                                                            }
                                                        },
                                                        geo: {
                                                            map: 'taizhou',
                                                            roam: true,
                                                            itemStyle: {
                                                                // color: 'gray'
                                                                // areaColor = '#333',
                                                            }


                                                        },
                                                        visualMap: {
                                                            type: "piecewise",


                                                            pieces: [
                                                                { max: {{ level_rain.8}}, min: {{ level_rain.7}}, label: Math.floor({{ level_rain.7 }}) + "~" + Math.floor({{ level_rain.8 }}), color: '#FF0000' },
                                                        { max: {{ level_rain.7}}, min: {{ level_rain.6}}, label: Math.floor({{ level_rain.6 }}) + "~" + Math.floor({{ level_rain.7 }}), color: '#662200' },// 不指定 max，表示 max 为无限大（Infinity）。
                                                        { max: {{ level_rain.6}}, min: {{ level_rain.5}}, label: Math.floor({{ level_rain.5 }}) + "~" + Math.floor({{ level_rain.6 }}), color: '#EE0099' },
                                                        { max: {{ level_rain.5}}, min: {{ level_rain.4}}, label: Math.floor({{ level_rain.4 }}) + "~" + Math.floor({{ level_rain.5 }}), color: '#0000FF' },
                                                        { max: {{ level_rain.4}}, min: {{ level_rain.3}}, label: Math.floor({{ level_rain.3 }}) + "~" + Math.floor({{ level_rain.4 }}), color: '#00FFFF' },
                                                        { max: {{ level_rain.3}}, min: {{ level_rain.2}}, label: Math.floor({{ level_rain.2 }}) + "~" + Math.floor({{ level_rain.3 }}), color: '#008833' },
                                                        { max: {{ level_rain.2}}, min: {{ level_rain.1}}, label: Math.floor({{ level_rain.1 }}) + "~" + Math.floor({{ level_rain.2 }}), color: '#00EE55' },    // 不指定 min，表示 min 为无限大（-Infinity）。
                                                        { max: {{ level_rain.1}}, label: Math.floor({{ level_rain.0 }}) + "~" + Math.floor({{ level_rain.1 }}), color: '#FFFFFF' }
                                                                            ],
                                                                        },
                                                        label: {
                                                        show: true,
                                                        color: "rgba(50, 44, 44, 1)",
                                                        //formatter: '{c}[2]'
                                                        formatter: function (params) {
                                                            // do some thing
                                                            return params.name
                                                        }
                                                    },
                                                        series: [{
                                                            name: ' ',
                                                            type: 'scatter',

                                                            symbolSize: 8,
                                                            coordinateSystem: 'geo',

                                                            data: {{ RR_sum| safe}}
                                                }]
                                            });


                                                </script>

                                            </div>
                                            <div class="tab-pane" id="panel-2">
                                                <p>
                                                    这里是第二块的内容
                                                </p>
                                                <img src="{{ img }}" style="height: 550%;overflow: auto;">
                                            </div>
                                            <div class="tab-pane" id="panel-3">
                                                <p>
                                                    这里是第三块的内容(地图)
                                                </p>
                                                <div id="map_rr_county" style="height: 550%;overflow: auto;"></div>
                                                <script>
                                                    var map_rr_county = echarts.init(document.getElementById('map_rr_county'), 'vintage');
                                                    // console.log("666")
                                                    var taizhou = {{ taizhou| safe}};
                                                    echarts.registerMap('taizhou', taizhou);
                                                    // console.log("666")
                                                    //console.log({{context.tz_json}})
                                                    // console.log(taizhou)
                                                    map_rr_county.setOption({
                                                        title: {
                                                            text: '',
                                                            textStyle: { fontSize: 50 },
                                                        },
                                                        // tooltip: {
                                                        //     trigger: 'item',
                                                        //     formatter: '{b}<br/>{c} (p / km2)'
                                                        // },
                                                        // geo: {
                                                        //     map: 'taizhou',


                                                        // },
                                                        toolbox: {
                                                            show: true,
                                                            orient: 'vertical',
                                                            left: 'right',
                                                            top: 'center',
                                                            feature: {
                                                                dataView: { readOnly: false },
                                                                restore: {},
                                                                saveAsImage: {}
                                                            }
                                                        },
                                                        visualMap: {
                                                            min: 80,//
                                                            max: 120,//
                                                            text: ['High', 'Low'],
                                                            realtime: false,
                                                            calculable: true,
                                                            inRange: {
                                                                color: ['lightskyblue', 'green', 'orangered']
                                                            }
                                                        },

                                                        series: [{
                                                            name: '台州市各县市面雨量',
                                                            type: 'map',
                                                            map: 'taizhou',




                                                            // data: [{ value: [121.5, 28.5, 80], url: "url_data" }]
                                                            data: {{ RR_County| safe }},
                                                                        // data: [
                                                                        //     { name: '仙居县', value:{{xianju}}},
                                                                        //     { name: '椒江区', value:200.1 },
                                                                        //     { name: '黄岩区', value:300 },
                                                                        //     { name: '路桥区', value:400 },
                                                                        //     { name: '三门县', value: 500 },
                                                                        //     { name: '天台县', value: 600 },
                                                                        //     { name: '温岭市', value: 700 },
                                                                        //     { name: '临海市', value: 800 },
                                                                        //     { name: '玉环市', value: 900 },
                                                                        // ],
                                                                    }]
                                                                });
                                                                // map_rr_county.on("click", function (e) {
                                                                //     window.open(e.data.url);
                                                                // });

                                                </script>

                                            </div>
                                            <div class="tab-pane " id="panel-4">
                                                <p>
                                                    这里是第四块的内容
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row clearfix">
                                        <div class="col-md-12 column">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 column">
                                    <div class="row clearfix">
                                        <div class="col-md-6 column">
                                            <div class="tabbable" id="tabs-530669">
                                                <ul class="nav nav-tabs">
                                                    <li class="active">
                                                        <a href="#panel-l1" data-toggle="tab">累计降水</a>
                                                    </li>
                                                    <li>
                                                        <a href="#panel-l2" data-toggle="tab">单站强度</a>
                                                    </li>
                                                </ul>
                                                <div class="tab-content">
                                                    <div class="tab-pane active" id="panel-l1">
                                                        <p>
                                                            按照累计降水强度进行排序
                                                        </p>
                                                        <div class="panel-footer"
                                                            style="height: 250px;overflow: auto;background-color:#FEF8EF">
                                                            <table id="userTable" style="background-color:#FEF8EF">
                                                                <thead>
                                                                    <tr>
                                                                        <th style="width: 25%;overflow: auto;">序号</th>
                                                                        <th style="width: 25%;overflow: auto;">站号</th>
                                                                        <th style="width: 25%;overflow: auto;">站名</th>
                                                                        <th style="width: 25%;overflow: auto;">乡镇</th>
                                                                        <th style="width: 25%;overflow: auto;">降水</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody id="sum_rr">

                                                                    <!-- <tr>
                                                                                    <td>001</td>
                                                                                    <td>Rammohan </td>
                                                                                    <td>Reddy</td>
                                                                                    <td>A+</td>
                                                                                </tr> -->
                                                                    {% for R in RR_sum %}
                                                                    <tr>
                                                                        <td>{{R.index}}</td>
                                                                        <td>{{R.IIiii}}</td>
                                                                        <td>{{R.county}}</td>
                                                                        <td>{{R.town}}</td>
                                                                        <td>{{R.data}}</td>

                                                                    </tr>
                                                                    {% endfor %}

                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <div class="tab-pane" id="panel-l2">
                                                        <p>
                                                            按照单站强度进行排序
                                                        </p>
                                                        <div class="panel-footer"
                                                            style="height: 250px;overflow: auto;background-color:#FEF8EF">
                                                            <table id="userTable" style="background-color:#FEF8EF">
                                                                <thead>
                                                                    <tr>
                                                                        <th style="width: 25%;overflow: auto;">序号</th>
                                                                        <th style="width: 25%;overflow: auto;">站号</th>
                                                                        <th style="width: 25%;overflow: auto;">站名</th>
                                                                        <th style="width: 25%;overflow: auto;">乡镇</th>
                                                                        <th style="width: 25%;overflow: auto;">降水</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody id="sum_rr">

                                                                    {% for R in RR_rx %}
                                                                    <tr>
                                                                        <td>{{R.index}}</td>
                                                                        <td>{{R.IIiii}}</td>
                                                                        <td>{{R.county}}</td>
                                                                        <td>{{R.town}}</td>
                                                                        <td>{{R.data}}</td>

                                                                    </tr>
                                                                    {% endfor %}

                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6 column">
                                            <p>站点分布</p>
                                            <div id="bar_rr" style="width: 100%;height: 250%;margin: 0 auto"></div>

                                            <script>
                                                // var bar_rrdiv = document.getElementById('bar_rr');
                                                var bar_rrdiv = echarts.init(document.getElementById('bar_rr'), 'vintage');
                                                bar_rrdiv.setOption({
                                                    xAxis: {
                                                        type: 'category',
                                                        data: ['小雨', '中雨', '大雨', '暴雨', '大暴雨', '特大暴雨']
                                                    },
                                                    yAxis: {
                                                        type: 'value'
                                                    },
                                                    series: [
                                                        {
                                                            data: {{ RR_rank }},
                                                    center: [125, 170],
                                                    type: 'bar'
                                                                    }
                                                                ]
                                                            })
                                                            // piediv.setOption(option);
                                            </script>
                                        </div>
                                    </div>
                                    <div class="row clearfix">
                                        <div class="col-md-12 column">
                                            <div class="tabbable" id="tabs-977128">
                                                <ul class="nav nav-tabs">
                                                    <li class="active">
                                                        <a href="#panel-ld1" data-toggle="tab">市县降水</a>
                                                    </li>
                                                    <li>
                                                        <a href="#panel-ld2" data-toggle="tab">流域降水</a>
                                                    </li>
                                                </ul>
                                                <div class="tab-content">
                                                    <div class="tab-pane active" id="panel-ld1">
                                                        <p>
                                                            市县降水的分布
                                                        </p>
                                                        <div id="bar1" style="height: 250px;overflow: auto;"></div>
                                                        <script>
                                                            var bardiv1 = echarts.init(document.getElementById('bar1'), 'vintage');
                                                            option1 = {
                                                                legend: {},
                                                                tooltip: {},
                                                                dataset: {
                                                                    // 提供一份数据。
                                                                    source: {{ RR_bar | safe }}
                                                                                // source: [
                                                                                //     ['product', '市县降水', '流域降水'],
                                                                                //     ['市局', 43.3, 85.8],
                                                                                //     ['天台', 83.1, 73.4],
                                                                                //     ['仙居', 86.4, 65.2],
                                                                                //     ['三门', 72.4, 53.9],
                                                                                //     ['临海', 72.4, 53.9],
                                                                                //     ['椒江', 72.4, 53.9],
                                                                                //     ['黄岩', 72.4, 53.9],
                                                                                //     ['路桥', 72.4, 53.9],
                                                                                //     ['温岭', 72.4, 53.9],
                                                                                //     ['玉环', 72.4, 53.9],
                                                                                // ]
                                                                            },
                                                            // 声明一个 X 轴，类目轴（category）。默认情况下，类目轴对应到 dataset 第一列。
                                                            xAxis: { type: 'category' },
                                                            // 声明一个 Y 轴，数值轴。
                                                            yAxis: { },
                                                            // 声明多个 bar 系列，默认情况下，每个系列会自动对应到 dataset 的每一列。
                                                            series: [
                                                                { type: 'bar' },
                                                                { type: 'bar' }
                                                            ]
                                                                        }
                                                            bardiv1.setOption(option1);

                                                        </script>
                                                    </div>
                                                    <div class="tab-pane " id="panel-ld2">
                                                        <p>
                                                            流域降水的分布
                                                        </p>
                                                        <div id="bar2" style="height: 250px;overflow: auto;"></div>
                                                        <script>
                                                            var bardiv2 = echarts.init(document.getElementById('bar2'), 'vintage');
                                                            option2 = {
                                                                xAxis: {
                                                                    type: 'category',
                                                                    data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']
                                                                },
                                                                yAxis: {
                                                                    type: 'value'
                                                                },
                                                                series: [
                                                                    {
                                                                        data: [120, 200, 150, 80, 70, 110, 130],
                                                                        type: 'bar'
                                                                    }
                                                                ]
                                                            };
                                                            bardiv2.setOption(option2);
                                                        </script>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row clearfix">
                                <div class="col-md-12 column">
                                    <blockquote>
                                        <p>
                                            降水统计
                                        </p> <small>昨天08时到今天，全是降水80毫米 <cite>面雨量最大的城市主要集中在台州的中北部</cite></small>
                                    </blockquote>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 温度 -->
            <div class="tab-pane" id="panel-a2">
                <!-- 气温模块 -->
                <div class="container-fiuled" style="padding-right: 30px; padding-left: 30px;">
                    <legend>气温统计</legend>
                    <div class="row clearfix">
                        <div class="col-md-6 column">
                            <div class="tabbable" id="tabs-781671">
                                <ul class="nav nav-tabs">
                                    <li>
                                        <a href="#panel-932232" data-toggle="tab">最高气温</a>
                                    </li>
                                    <li class="active">
                                        <a href="#panel-214106" data-toggle="tab">最低气温</a>
                                    </li>
                                    <li>
                                        <a href="#panel-299601" data-toggle="tab">低温警报</a>
                                    </li>
                                    <li>
                                        <a href="#panel-713911" data-toggle="tab">高温警报</a>
                                    </li>
                                    <li>
                                        <a href="#panel-299645" data-toggle="tab">低温分布</a>
                                    </li>
                                    <li>
                                        <a href="#panel-713979" data-toggle="tab">高温分布</a>
                                    </li>
                                </ul>
                                <div class="tab-content">
                                    <div class="tab-pane active" id="panel-932232">
                                        <p>
                                            最高气温
                                        </p>
                                        <div id="map_tmp_max2" style="height: 550%;overflow: auto;"></div>
                                        <script>
                                            var map_tmp_max2 = echarts.init(document.getElementById('map_tmp_max2'), 'theme');
                                            var taizhou = {{ taizhou| safe}};
                                            echarts.registerMap('taizhou', taizhou, {});
                                            map_tmp_max2.setOption({
                                                title: {
                                                    text: '',
                                                    textStyle: { fontSize: 50 },
                                                },
                                                tooltip: {
                                                    trigger: 'item',
                                                    formatter: function (params) {
                                                        // do some thing
                                                        // return params.name + ":" + params.value[2]
                                                        return params.value[6]
                                                    }
                                                },
                                                geo: {
                                                    map: 'taizhou',


                                                },
                                                label: {
                                                    show: true,
                                                    color: "rgba(50, 44, 44, 1)",
                                                    formatter: function (params) {
                                                        // do some thing
                                                        var res = 123
                                                        if (params.value != null) {
                                                            // console.log(params.value)
                                                            res = params.value[6]
                                                        }
                                                        // console.log("测试")
                                                        // console.log(params.value)
                                                        // res = params.value

                                                        return res
                                                    }
                                                },
                                                series: [{
                                                    name: ' ',
                                                    type: 'effectScatter',

                                                    symbolSize: 5,
                                                    coordinateSystem: 'geo',

                                                    data: {{ tx_scatter| safe}},
                                                }]
                                            });
                                            map_tmp_max2.on("click", function (e) {
                                                $("#modal-content").text("修改模块内容")
                                                $("#modal-one").modal({
                                                    backdrop: false, // 相当于data-backdrop
                                                    keyboard: false, // 相当于data-keyboard
                                                    show: true, // 相当于data-show
                                                    remote: "" // 相当于a标签作为触发器的href
                                                });
                                                // window.open(e.data.url);
                                            });
                                        </script>
                                    </div>
                                    <div class="tab-pane " id="panel-214106">
                                        <p>
                                            最低气温
                                        </p>
                                        <div id="map_tmp_min2" style="height: 550%;overflow: auto;"></div>
                                        <script>
                                            var map_tmp_min2 = echarts.init(document.getElementById('map_tmp_min2'), 'theme');
                                            // console.log("666")
                                            var taizhou = {{ taizhou| safe}};
                                            echarts.registerMap('taizhou', taizhou, {});
                                            // console.log("666")
                                            // console.log(taizhou)
                                            map_tmp_min2.setOption({
                                                title: {
                                                    text: '',
                                                    textStyle: { fontSize: 50 },
                                                },
                                                tooltip: {
                                                    trigger: 'item',
                                                    formatter: function (params) {
                                                        // do some thing
                                                        return params.name + ":" + params.value[7]
                                                    }
                                                },
                                                geo: {
                                                    map: 'taizhou',
                                                    itemStyle: {
                                                        color: 'white'
                                                        // areaColor = '#333',
                                                    }


                                                },
                                                label: {
                                                    show: true,
                                                    color: "rgba(50, 44, 44, 1)",
                                                    //formatter: '{c}[2]'
                                                    formatter: function (params) {
                                                        var res = 123
                                                        if (params.value != null) {
                                                            res = params.value[7]
                                                        }
                                                        return res
                                                    }
                                                },
                                                series: [{
                                                    name: ' ',
                                                    type: 'effectScatter',

                                                    symbolSize: 5,
                                                    coordinateSystem: 'geo',

                                                    data: {{ tn_scatter| safe}}
                                                }]
                                            });
                                            map_tmp_min2.on("click", function (e) {
                                                window.open(e.data.url);
                                            });
                                        </script>

                                    </div>
                                    <div class="tab-pane " id="panel-299601">
                                        <p>
                                            高温警报
                                        </p>
                                        <div id="map_temp_event" style="height: 550%;overflow: auto;"></div>
                                        <script>
                                            var map_temp_event = echarts.init(document.getElementById('map_temp_event'), 'light');
                                            // console.log("666")
                                            var taizhou = {{ taizhou| safe}};
                                            echarts.registerMap('taizhou', taizhou, {});
                                            // console.log("666")
                                            // console.log(taizhou)
                                            map_temp_event.setOption({
                                                title: {
                                                    text: '气温警报',
                                                    textStyle: { fontSize: 30 },
                                                },
                                                tooltip: {
                                                    trigger: 'item',
                                                    formatter: function (params) {
                                                        // do some thing
                                                        return params.name + ":" + params.value[2]
                                                    }
                                                },
                                                visualMap: {
                                                    type: "piecewise",


                                                    pieces: [
                                                        { max: 42, min: 35, label: '高温', color: 'red' },
                                                        { max: 3, min: 0, label: '霜冻', color: 'green' },// 不指定 max，表示 max 为无限大（Infinity）。
                                                        { max: 0, min: -10, label: '冻害', color: 'blue' }]

                                                },
                                                geo: {
                                                    map: 'taizhou',
                                                    roam: true,
                                                    itemStyle: {
                                                        color: 'white'
                                                        // areaColor = '#333',
                                                    }


                                                },
                                                label: {
                                                    show: true,
                                                    color: "rgba(50, 44, 44, 1)",
                                                    //formatter: '{c}[2]'
                                                    formatter: function (params) {
                                                        var res = 123
                                                        if (params.value != null) {
                                                            res = params.value[2]
                                                        }
                                                        return params.name
                                                    }
                                                },
                                                series: [{
                                                    name: ' ',
                                                    type: 'scatter',

                                                    symbolSize: 5,
                                                    coordinateSystem: 'geo',

                                                    data: {{ tmp_event| safe}}
                                                }]
                                            });
                                            map_temp_event.on("click", function (e) {
                                                window.open(e.data.url);
                                            });
                                        </script>
                                    </div>
                                    <div class="tab-pane " id="panel-713911">
                                        <p>
                                            低温警报
                                        </p>
                                    </div>
                                    <div class="tab-pane " id="panel-299645">
                                        <p>
                                            低温分布
                                        </p>
                                    </div>
                                    <div class="tab-pane " id="panel-713979">
                                        <p>
                                            高温分布
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 column">
                            <div class="col-md-12 column">
                                <div class="tabbable" id="tabs-294640">
                                    <ul class="nav nav-tabs">
                                        <li class="active">
                                            <a href="#panel-131393" data-toggle="tab">时序图</a>
                                        </li>
                                    </ul>
                                    <div class="tab-content">
                                        <div class="tab-pane active" id="panel-131393">
                                            <p>
                                                市气温
                                            </p>
                                            <div id="bar_tmp1" style="height: 250px;overflow: auto;"></div>
                                            <script>
                                                var bar_tmpdiv1 = echarts.init(document.getElementById('bar_tmp1'));
                                                option_tmp1 = {
                                                    legend: {},
                                                    tooltip: {},
                                                    dataset: {
                                                        // 提供一份数据。
                                                        source: {{ tmp_bar | safe }}
                                                                    },
                                                // 声明一个 X 轴，类目轴（category）。默认情况下，类目轴对应到 dataset 第一列。
                                                xAxis: { type: 'category' },
                                                // 声明一个 Y 轴，数值轴。
                                                yAxis: { },
                                                // 声明多个 bar 系列，默认情况下，每个系列会自动对应到 dataset 的每一列。
                                                series: [
                                                    { type: 'bar' },
                                                    { type: 'bar' },
                                                ]
                                                                }
                                                bardiv1.setOption(option1);
                                                bar_tmpdiv1.setOption(option_tmp1);
                                            </script>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div class="col-md-12 column">
                                <p>
                                    气温警报统计
                                </p>
                                <blockquote>
                                    <p>
                                        气温统计
                                    </p> <small>昨天08时到今天，全是降水80毫米 <cite>面雨量最大的城市主要集中在台州的中北部</cite></small>
                                </blockquote>

                            </div>

                        </div>

                    </div>
                </div>
            </div>


            <!-- 能见度 -->
            <div class="tab-pane" id="panel-a3">
                <!-- 能见度模块 -->
                <div class="container-fiuled" style="padding-right: 30px; padding-left: 30px;">
                    <legend>能见度统计</legend>
                    <div class="row clearfix">
                        <div class="col-md-6 column">
                            <div class="tabbable" id="tabs-285011">
                                <ul class="nav nav-tabs">
                                    <li class="active">
                                        <a href="#panel-786570" data-toggle="tab">能见度</a>
                                    </li>
                                    <li>
                                        <a href="#panel-615445" data-toggle="tab">预警</a>
                                    </li>
                                </ul>
                                <div class="tab-content">
                                    <div class="tab-pane active" id="panel-786570">
                                        <p>
                                            这是能见度的图.
                                        </p>
                                        <div id="map_vue" style="height: 600%;overflow: auto;"></div>
                                        <script>
                                            var map_vue = echarts.init(document.getElementById('map_vue'), 'vintage');
                                            // console.log("666")
                                            // console.log({{ testdata| safe}})
                                            var taizhou = {{ context.taizhou }}
                                            echarts.registerMap('taizhou', taizhou, {});
                                            // console.log("666")
                                            // console.log(taizhou)
                                            map_vue.setOption({
                                                title: {
                                                    text: '',
                                                    textStyle: { fontSize: 50 },
                                                },
                                                tooltip: {
                                                    trigger: 'item',
                                                    formatter: function (params) {
                                                        // do some thing
                                                        return params.name + ":" + params.value[4]
                                                    }
                                                },
                                                visualMap: {
                                                    type: "piecewise",
                                                    dimension: 4,


                                                    pieces: [
                                                        { max: 5000, min: 500, label: '轻霾', color: 'blue' },
                                                        { max: 500, min: 200, label: '大雾', color: 'yellow' },
                                                        { max: 200, min: 50, label: '浓雾', color: 'orange' },    // 不指定 min，表示 min 为无限大（-Infinity）。
                                                        { max: 50, min: 0, label: '强浓雾', color: 'red' }
                                                    ],
                                                },
                                                geo: {
                                                    map: 'taizhou',
                                                    roam: true


                                                },
                                                label: {
                                                    show: true,
                                                    color: "black",
                                                    formatter: function (params) {
                                                        // do some thing
                                                        return params.name
                                                    }
                                                },
                                                series: [{
                                                    // name: ' ',
                                                    type: 'scatter',
                                                    Symbol: 'circle',
                                                    symbolSize: 10,
                                                    coordinateSystem: 'geo',
                                                    data: {{ vv_scatter| safe}}
                                                                // data: [{ value: [121.5, 28.5, 80], url: "url_data" }]
                                                            }]
                                                        });
                                            map_vue.on("click", function (e) {
                                                window.open(e.data.url);
                                            });
                                        </script>

                                    </div>
                                    <div class="tab-pane" id="panel-615445">
                                        <p>
                                            这是目前已知的预警.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 column">
                            <div class="row clearfix">
                                <div class="col-md-12 column">
                                    <p>
                                        最低能见度站点
                                    </p>
                                    <div id="bar_vue" style="height: 350px;overflow: auto;"></div>
                                    <script>
                                        var bar_vue = echarts.init(document.getElementById('bar_vue'));
                                        option_tmp2 = {
                                            xAxis: {
                                                type: 'category',
                                                // data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']
                                                data: {{ vv_time | safe }}
                                                        },
                                        yAxis: {
                                            type: 'value'
                                        },
                                        dataZoom: [
                                            {
                                                type: 'slider',
                                                start: 0,
                                                end: 24,
                                                show: true

                                            },

                                        ],
                                            series: [
                                                {
                                                    // data: [820, 932, 901, 934, 1290, 1330, 1320],
                                                    data: {{ vv_value| safe}},
                                                type: 'line',
                                                smooth: true
                                                            }
                                            ]
                                                    };
                                        bar_vue.setOption(option_tmp2);
                                    </script>
                                </div>
                            </div>
                            <div class="row clearfix">
                                <div class="col-md-12 column">
                                    <p>
                                        能见度站点统计
                                    </p>
                                    <blockquote>
                                        <p>
                                            能见度统计
                                        </p> <small>昨天08时到今天，全是降水80毫米 <cite>面雨量最大的城市主要集中在台州的中北部</cite></small>
                                    </blockquote>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 大风 -->
            <div class="tab-pane" id="panel-a4">
                <!-- 大风 -->
                <div class="container-fiuled" style="padding-right: 30px; padding-left: 30px;">
                    <legend>级大风统计</legend>
                    <div class="row clearfix">
                        <div class="col-md-6 column">
                            <div class="tabbable" id="tabs-285011">
                                <ul class="nav nav-tabs">
                                    <li class="active">
                                        <a href="#panel-786570" data-toggle="tab">极大风</a>
                                    </li>
                                    <li>
                                        <a href="#panel-615445" data-toggle="tab">预警</a>
                                    </li>
                                </ul>
                                <div class="tab-content">
                                    <div class="tab-pane active" id="panel-786570">
                                        <p>
                                            这是级大风的图.
                                        </p>
                                        <div id="map_fy" style="height: 500%;overflow: auto;"></div>
                                        <script>
                                            var map_fy = echarts.init(document.getElementById('map_fy'), 'light');
                                            // console.log("666")
                                            var taizhou = {{ taizhou| safe}};
                                            echarts.registerMap('taizhou', taizhou, {});
                                            // console.log("666")
                                            // console.log(taizhou)
                                            map_fy.setOption({
                                                title: {
                                                    text: '',
                                                    textStyle: { fontSize: 50 },
                                                },
                                                tooltip: {
                                                    trigger: 'item',
                                                    formatter: function (params) {
                                                        // do some thing
                                                        return params.name + ":" + params.value[2] + params.value[3]
                                                    }
                                                },
                                                visualMap: {
                                                    type: "piecewise",
                                                    dimension: 2,


                                                    pieces: [
                                                        { min: 20.7, label: '9级以上大风', color: 'red' },
                                                        { max: 20.7, min: 17.1, label: '8级大风', color: 'orange' },
                                                        { max: 17.1, min: 13.8, label: '7级大风', color: 'blue' }   // 不指定 min，表示 min 为无限大（-Infinity）。
                                                        // { max: 50, min: 0, label: '强浓雾', color: 'red' }
                                                    ],
                                                },
                                                geo: {
                                                    map: 'taizhou',
                                                    roam: true,
                                                    // tooltip:{borderColor = '#333'}
                                                    itemStyle: {
                                                        color: 'white'
                                                        // areaColor = '#333',
                                                    }


                                                },
                                                label: {
                                                    show: true,
                                                    color: "rgba(50, 44, 44, 1)",
                                                    formatter: function (params) {
                                                        // do some thing
                                                        return params.name
                                                    }
                                                },
                                                series: [{
                                                    name: ' ',
                                                    type: 'scatter',

                                                    symbolSize: 15,
                                                    coordinateSystem: 'geo',

                                                    data: {{ fy_scatter| safe}},
                                                            }]
                                                        });
                                            map_fy.on("click", function (e) {
                                                $("#modal-content").text("修改模块内容")
                                                $("#modal-one").modal({
                                                    backdrop: false, // 相当于data-backdrop
                                                    keyboard: false, // 相当于data-keyboard
                                                    show: true, // 相当于data-show
                                                    remote: "" // 相当于a标签作为触发器的href
                                                });
                                                // window.open(e.data.url);
                                            });
                                        </script>

                                    </div>
                                    <div class="tab-pane" id="panel-615445">
                                        <p>
                                            这是目前已知的预警.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 column">
                            <div class="row clearfix">
                                <div class="col-md-12 column">
                                    <p>
                                        柱状图
                                    </p>
                                    <div class="panel-footer"
                                        style="height: 250px;overflow: auto;background-color:#FEF8EF">
                                        <table id="userTable" style="background-color:#FEF8EF">
                                            <thead>
                                                <tr>
                                                    <th style="width: 25%;overflow: auto;">序号</th>
                                                    <th style="width: 25%;overflow: auto;">站号</th>
                                                    <th style="width: 25%;overflow: auto;">站名</th>
                                                    <th style="width: 25%;overflow: auto;">乡镇</th>
                                                    <th style="width: 25%;overflow: auto;">极大风</th>
                                                </tr>
                                            </thead>
                                            <tbody id="sum_rr">
                                                {% for fy in fy_list %}
                                                <tr>
                                                    <td>{{fy.index}}</td>
                                                    <td>{{fy.IIiii}}</td>
                                                    <td>{{fy.county}}</td>
                                                    <td>{{fy.town}}</td>
                                                    <td>{{fy.data}}</td>

                                                </tr>
                                                {% endfor %}

                                            </tbody>
                                        </table>
                                    </div>
                                </div>


                            </div>
                            <div class="row clearfix">
                                <div class="col-md-12 column">
                                    <p>
                                        柱状图
                                    </p>
                                    <blockquote>
                                        <p>
                                            极大风统计
                                        </p> <small>昨天08时到今天，全是降水80毫米 <cite>面雨量最大的城市主要集中在台州的中北部</cite></small>
                                    </blockquote>


                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>


    </div>



    <!-- 降水模块 -->
    {% csrf_token %}









    <!-- 遮罩窗体 -->
    <div class="modal fade" id="modal-one" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    <h4 class="modal-title" id="myModalLabel">
                        标题
                    </h4>
                </div>
                <div class="modal-body" id="modal-content">
                    内容...
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button> <button type="button"
                        class="btn btn-primary">保存</button>
                </div>
            </div>

        </div>

    </div>








</body>

</html>