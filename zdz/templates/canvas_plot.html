<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="static/js/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="static/js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="static/css/jquery.datetimepicker.css" />
    <script src="static/js/jquery.datetimepicker.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.actual/1.0.19/jquery.actual.min.js"></script>
    <!-- leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
        integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
        integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM=" crossorigin=""></script>
    <!-- 使用turf -->
    <script src="https://unpkg.com/@turf/turf/turf.min.js"></script>
    <!-- echart -->
    <script type="text/javascript" src="static/js/echarts.min.js"></script>
    <script type="text/javascript" src="static/js/echarts-gl.min.js"></script>
    <script type="text/javascript" src="static/js/ecStat.min.js"></script>
    <script type="text/javascript" src="static/js/dataTool.min.js"></script>
    <script type="text/javascript" src="static/js/china.js"></script>
    <script type="text/javascript" src="static/js/world.js"></script>

    <!-- 引入 layui.css -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/layui/2.7.6/css/layui.css" rel="stylesheet">
    <!-- 引入 layui.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/layui/2.7.6/layui.js"></script>
    <!-- 数据 -->
    <script src='static/js/taizhou.js'></script>
    <script src='static/js/county.js'></script>
    <!-- 市县地图 -->
    <script src='static/js/xiangzhen/sanmen.js'></script>
    <script src='static/js/xiangzhen/tiantai.js'></script>
    <script src='static/js/xiangzhen/xianju.js'></script>
    <script src='static/js/xiangzhen/linhai.js'></script>
    <script src='static/js/xiangzhen/jiaojiang.js'></script>
    <script src='static/js/xiangzhen/luqiao.js'></script>
    <script src='static/js/xiangzhen/huangyan.js'></script>
    <script src='static/js/xiangzhen/wenling.js'></script>
    <script src='static/js/xiangzhen/yuhuan.js'></script>

    <script src='static/js/taizhoulist.js'></script>
    <title>快速画图</title>
    <style type="text/css">
        .scrollbar::-webkit-scrollbar {
            display: none;
        }

        .my-div-icon {
            font-size: 25px;
            /* border:1px solid black; */
            /* width: 600px;
            height:150px; */
            /*background:red;*/
            /*width:5px;*/
            color: rgb(22, 21, 21);
        }
    </style>
</head>

<body>
    {% csrf_token %}
    <div
        style="display: flex;align-content:flex-start;position: absolute; justify-content: center; flex-wrap: wrap; width: 100%;height: 100%;background-color: white">
        <div class="col-md-12 column" style="width: 100%;height: 100%;padding-top: 15px;">
            <div class="tabbable" id="tabs-611922" style="width: 100%;height: 100%;">
                <ul class="nav nav-tabs" style="text-align:center;font-size: 16px;font-weight:900;font-family:'宋体';color:blue">
                    <li class="active">
                        <a href="#canvas-1" data-toggle="tab">降水订正</a>
                    </li>
                    <li>
                        <a id="quick_plot_link" href="#canvas-2" data-toggle="tab">快速绘图</a>
                    </li>
                    <li>
                        <a href="#canvas-3" data-toggle="tab">趋势图</a>
                    </li>

                </ul>
                <div class="tab-content">
                    <div class="tab-pane active" id="canvas-1">
                        <!-- 自定义绘图的位置 -->
                        <div style="display: flex;width: 100%;height:700px;border: 1px solid black;">
                            <!-- 自定义绘图 -->
                            <div style="width: 50%;height:700px;">
                                
                                <div style="width: 100%;height:5%;padding-top:8px;border-bottom: 1px solid black;">
                                    <span>&nbsp;&nbsp;</span>
                                    <span>&nbsp;&nbsp;</span>
                                    <select id="canvas_var" style="border:none;background-color:white;">
                                        <option value="+">加</option>
                                        <option value="-">减</option>
                                    </select>
                                    <span>&nbsp;&nbsp;</span>
                                    <span>0.1</span><input checked="checked" type="radio" name="canvas_num"
                                        style="width:5%;" value="0.1">
                                    <span>0.3</span><input type="radio" name="canvas_num" style="width:5%" value="0.3">
                                    <span>0.5</span><input type="radio" name="canvas_num" style="width:5%" value="0.5">
                                    <span>1</span><input type="radio" name="canvas_num" style="width:5%" value="1">
                                    <span>3</span><input type="radio" name="canvas_num" style="width:5%" value="3">
                                    <span>5</span><input type="radio" name="canvas_num" style="width:5%" value="5">
                                    <span>10</span><input type="radio" name="canvas_num" style="width:5%" value="10">
                                    

                                </div>
                                <div style="width: 100%;height:70%">
                                    <canvas id="plot_canvas"
                                        style="width:100%;height:100%;"></canvas>
                                </div>

                                <div style="display: flex;width: 100%;height:25%;border-top: 1px solid black;">
                                    <!--画图 菜单 -->
                                    <div style="display:block;width: 8%;height:100%;border-right: 1px solid;padding-left:3px;">
                                        <button id="plot_1st_data" class="layui-btn layui-btn-sm " style="margin-bottom:3px;margin-top:3px">
                                            模式
                                        </button>
                                        <button id="plot_2st_data" class="layui-btn layui-btn-sm " style="margin:0px;margin-bottom:3px">
                                            实况
                                        </button>
                                        <button id="plot_1st_color" class="layui-btn layui-btn-sm "
                                            style="margin:0px;margin-bottom:3px">
                                            颜色
                                        </button>


                                    </div>

                                    <div style="width: 92%;height:100%">
                                        <!-- 工具栏 -->
                                        <div style="width: 100%;height:70%;">
                                            <div id="plot_1st_tool1"
                                                style="display:inline-block;width:100%;height:100%;">
                                                <div style="width:100%;height:30%;"></div>
                                                <div
                                                    style="display: inline-flex;;width:100%;height:30%;border-radius:15px;padding-left:3%;">
                                                   
                                                    <div class="layui-card-body" style="">                                                                                    
                                                        <label class="layui-form-label" >模式</label>                                                                                                                                                       
                                                        <div class="layui-inline" id="plot_date_range">
                                                            <div class="layui-input-inline">
                                                                <input type="text" autocomplete="off" id="plot-startDate-1" class="layui-input" placeholder="开始日期">
                                                            </div>
                                                            <div class="layui-form-mid">:</div>
                                                            -
                                                            <div class="layui-input-inline">
                                                                <input type="text" autocomplete="off" id="plot-endDate-1" class="layui-input" placeholder="结束日期">
                                                            </div>
                                                            <button id="self_plot_download" type="button" class="layui-btn layui-btn-radius" style="float: right;">
                                                                <i class="layui-icon layui-icon-search"></i>
                                                            </button>                                                        
                                                        </div>
                                                                                                                            
                                                    </div>
                                                    <script>
                                                        function getNextDate(date, day) {
                                                                var dd = new Date(date);
                                                                dd.setDate(dd.getDate() + day);
                                                                var y = dd.getFullYear();
                                                                var m = dd.getMonth() + 1 < 10 ? "0" + (dd.getMonth() + 1) : dd.getMonth() + 1;
                                                                var d = dd.getDate() < 10 ? "0" + dd.getDate() : dd.getDate();
                                                                return y + "-" + m + "-" + d;
                                                            };
                                                        // 周报日期                            
                                                        layui.use('laydate', function () {
                                                            var laydate = layui.laydate;
                                                            //日期范围
                                                            var today = new Date()
                                                            var y = today.getFullYear();
                                                            var m = today.getMonth() + 1 < 10 ? "0" + (today.getMonth() + 1) : today.getMonth() + 1;
                                                            var d = today.getDate() < 10 ? "0" + today.getDate() : today.getDate();
                                                            var h = today.getHours() < 10 ? "0" + today.getHours() + ":00:00" : today.getHours() + ":00:00";
                                                            var today_str = y + "-" + m + "-" + d + " " + h;
                                                            var seven_day = getNextDate(today_str, day = -7)
                                                            seven_day = seven_day + " " + h
                                                            function date_to_str(date) {
                                                                var year = date.year
                                                                var month = date.month < 10 ? "0" + date.month.toString() : date.month.toString()
                                                                var day = date.date < 10 ? "0" + date.date.toString() : date.date.toString()
                                                                var hour = date.hours < 10 ? "0" + date.hours.toString() + ":00:00" : date.hours.toString() + ":00:00"
                                                                date_str = year + "-" + month + "-" + day + " " + hour;
                                                                return date_str
                                                            }
                                                            laydate.render({
                                                                elem: '#plot_date_range'
                                                                //设置开始日期、日期日期的 input 选择器
                                                                //数组格式为 2.6.6 开始新增，之前版本直接配置 true 或任意分割字符即可
                                                                , type: 'datetime'
                                                                , theme: 'molv'
                                                                , max: today_str
                                                                , min: seven_day
                                                                , value: [seven_day, today_str]
                                                                , isInitValue: true
                                                                , done: function (value, date, endDate) {
                                                                    // zdz_recdata_obj.start_date = date_to_str(date)
                                                                    // zdz_recdata_obj.end_date = date_to_str(endDate)
                                                                    // console.log(seven_day)
                                                                }
                                                                , range: ['#plot-startDate-1', '#plot-endDate-1']
                                                            });
                                                        })
                                                    </script>
                                                </div>

                                            </div>
                                            <div id="plot_2st_tool1"
                                                style="display:none;;width:100%;height:100%;">
                                                <div style="width:100%;height:30%;"></div>
                                                <div
                                                    style="display: inline-flex;;width:100%;height:30%;border-radius:15px;padding-left:3%;">                                                 
                                                    <div class="layui-card-body" style="">                                                                                    
                                                        <label class="layui-form-label" >实况</label>                                                                                                                                                       
                                                        <div class="layui-inline" id="zdz_date_range">
                                                            <div class="layui-input-inline">
                                                                <input type="text" autocomplete="off" id="zdz-startDate-1" class="layui-input" placeholder="开始日期">
                                                            </div>
                                                            <div class="layui-form-mid">:</div>
                                                            -
                                                            <div class="layui-input-inline">
                                                                <input type="text" autocomplete="off" id="zdz-endDate-1" class="layui-input" placeholder="结束日期">
                                                            </div>
                                                            <button id="self_plot_download" type="button" class="layui-btn layui-btn-radius" style="float: right;">
                                                                <i class="layui-icon layui-icon-search"></i>
                                                            </button>                                                        
                                                        </div>
                                                                                                                            
                                                    </div>
                                                    <script>
                                                        
                                                        // 周报日期                            
                                                        layui.use('laydate', function () {
                                                            var laydate = layui.laydate;
                                                            //日期范围
                                                            var today = new Date()
                                                            var y = today.getFullYear();
                                                            var m = today.getMonth() + 1 < 10 ? "0" + (today.getMonth() + 1) : today.getMonth() + 1;
                                                            var d = today.getDate() < 10 ? "0" + today.getDate() : today.getDate();
                                                            var h = today.getHours() < 10 ? "0" + today.getHours() + ":00:00" : today.getHours() + ":00:00";
                                                            var today_str = y + "-" + m + "-" + d + " " + h;
                                                            var seven_day = getNextDate(today_str, day = -7)
                                                            seven_day = seven_day + " " + h
                                                            function date_to_str(date) {
                                                                var year = date.year
                                                                var month = date.month < 10 ? "0" + date.month.toString() : date.month.toString()
                                                                var day = date.date < 10 ? "0" + date.date.toString() : date.date.toString()
                                                                var hour = date.hours < 10 ? "0" + date.hours.toString() + ":00:00" : date.hours.toString() + ":00:00"
                                                                date_str = year + "-" + month + "-" + day + " " + hour;
                                                                return date_str
                                                            }
                                                            laydate.render({
                                                                elem: '#zdz_date_range'
                                                                //设置开始日期、日期日期的 input 选择器
                                                                //数组格式为 2.6.6 开始新增，之前版本直接配置 true 或任意分割字符即可
                                                                , type: 'datetime'
                                                                , theme: 'molv'
                                                                , max: today_str
                                                                , min: seven_day
                                                                , value: [seven_day, today_str]
                                                                , isInitValue: true
                                                                , done: function (value, date, endDate) {
                                                                    // zdz_recdata_obj.start_date = date_to_str(date)
                                                                    // zdz_recdata_obj.end_date = date_to_str(endDate)
                                                                    // console.log(seven_day)
                                                                }
                                                                , range: ['#zdz-startDate-1', '#zdz-endDate-1']
                                                            });
                                                        })
                                                    </script>
                                                </div>

                                            </div>
                                            <div id="plot_1st_tool2" style="display:none;width:100%;height:100%">
                                                <div style="width:100%;height:35%;"></div>
                                                <div style="width:100%;height:30%;padding-left:1%;">
                                                    <div
                                                        style="display: inline-flex;width:99%;height:100%;border: 1px solid black;;border-radius:15px;padding-left:1.5%;padding-top:1%;padding-right:1%">
                                                        <div id="self_color_select_option"></div>
                                                        <div id="self_color_select_list" style="width:90%;height:99.5%">
                                                        </div>
                                                        <input id="self_color_bar_del" type="button" value="-"
                                                            onclick="self_color_bar_del()"
                                                            style="width: 4%;height: 75%;float: right;">
                                                    </div>
                                                </div>
                                                <div style="width:100%;height:30%;padding-left:20%;padding-top:10px;">
                                                     每个颜色框内填写{颜色}-{解释} eg:10-小雨
                                                </div>
                                                <script>
                                                    layui.use('colorpicker', function () {
                                                        var $ = layui.$
                                                            , colorpicker = layui.colorpicker;
                                                        //常规使用
                                                        colorpicker.render({
                                                            elem: '#self_color_select_option'
                                                            , color: 'white'
                                                            , predefine: true // 开启预定义颜色
                                                            , colors: [ 'rgb(140,246,130)', 'rgb(0,191,27)', 'rgb(62,185,255)', 'rgb(25,0,235)', 'rgb(255,0,255)', 'rgb(140,0,65)','rgb(255,255,255)']
                                                            , done: function (color) {
                                                                // console.log("颜色", color)
                                                                if (color != 'none') {
                                                                    var add_radio = document.createElement('input')
                                                                    add_radio.style = "border-radius:5px;margin-right:3px"
                                                                    add_radio.style.width = "13%"
                                                                    add_radio.style.height = "80%"
                                                                    add_radio.style.backgroundColor = color
                                                                    add_radio.style.display = "inline-block"
                                                                    add_radio.style.border = "1px solid black"
                                                                    add_radio.setAttribute("class", "self_color_bar")
                                                                    add_radio.setAttribute("type", "text")
                                                                    $('#self_color_select_list').append(add_radio)
                                                                }

                                                            }
                                                        })
                                                    })
                                                    function self_color_bar_del() {
                                                        $('#self_color_select_list').children().last().remove()
                                                    }
                                                </script>
                                            </div>

                                        </div>
                                        <!-- 按钮 -->
                                        <div style="width: 100%;height:30%;border-top: 1px solid black;padding:8px;">


                                            <input id="self_title_content" type="text"
                                                style="width:65%;height: 100%;float:left;" placeholder="请输入标题">
                                            
                                            <input id="plot_self_button" type="button" value="绘制"
                                                style="width:10%;height: 100%;float:right;background-color:rgb(0,150,136);border: none;margin-right:3px;border-radius:3px;">
                                            <input id="plot_self_flash" type="button" value="刷新"
                                                style="width:10%;height:100%;float:right;;background-color:rgb(0,150,136);;border: none;margin-right:3px;;border-radius:3px;">
                                            <input id="plot_self_close" type="button" value="关闭"
                                                style="width:10%;height:100%;float:right;;background-color:rgb(0,150,136);;border: none;;margin-right:3px;;border-radius:3px">

                                        </div>

                                    </div>


                                </div>

                            </div>
                            <!-- 预览 -->
                            <div style="width: 50%;height:700px;border-left: 1px solid black;;border-bottom: 1px solid black;">
                                <div id="self_plot_div"
                                    style="width: 100%;height:100%;;background-color: white;">
                                </div>
                                <!-- <div style="display: inline-flex;width: 100%;height:25%;border: 1px solid">
                                    <div id="self_bar" style="width: 60%;height:100%;border: 1px solid">

                                    </div>
                                    <div id="self_table" style="width: 40%;height:100%;border: 1px solid">

                                    </div>

                                </div> -->

                            </div>
                            <!-- 自定义画图的核心js -->
                            <script src='static/js/self_plot.js'></script>
                            <script>
                                // 绘制底图
                                var boundaries = {
                                    type: "FeatureCollection",
                                    name: "boundaries",
                                    crs: { type: "name", properties: { name: "urn:ogc:def:crs:OGC:1.3:CRS84" } },
                                    features: taizhoulist
                                };
                                var lines = L.geoJSON(boundaries, {
                                    style: function (feature) {
                                        return { color: 'black', weight: 1, fillOpacity: 0.01 };
                                    }
                                })
                                var map = new L.Map('self_plot_div', {
                                    center: new L.LatLng(28.7, 121.1),//110.763, 41.376   39.62353145, 121.9937485
                                    zoom: 9, //4
                                    zoomControl: false,
                                    dragging: false,
                                    // scrollWheelZoom: false,
                                    doubleClickZoom: false,
                                    attributionControl: false, //是否去除右下角标志
                                    bounds: turf.bbox(boundaries),
                                    layers: [lines]
                                });

                                // 关闭对话并传参
                                $('#plot_self_close').click(function () {
                                    window.parent.postMessage({
                                        mceAction: 'insertContent',
                                        content: "关闭选项"
                                    }, '*');
                                    window.parent.postMessage({
                                        mceAction: 'close'
                                    }, "*");
                                })

                                $('#self_plot_start_time').datetimepicker(
                                    {
                                        theme: 'dark',
                                        format: 'Y-m-d H:i',
                                        minView: "month",
                                        language: 'zh',
                                        startView: 2

                                    }
                                );
                                $("#self_plot_start_time").datetimepicker("setDate", new Date());

                                $('#self_plot_end_time').datetimepicker(
                                    {
                                        theme: 'dark',
                                        format: 'Y-m-d H:i'
                                    }
                                );

                                $('#plot_1st_data').click(function () {

                                    $('#plot_1st_tool1').attr("style", "display:inline-block;width:100%;height:100%")
                                    $('#plot_2st_tool1').attr("style", "display:none;width:100%;height:100%")
                                    $('#plot_1st_tool2').attr("style", "display:none;width:100%;height:100%")
                                })
                                $('#plot_1st_color').click(function () {
                                    $('#plot_1st_tool1').attr("style", "display:none;width:100%;height:100%")
                                    $('#plot_2st_tool1').attr("style", "display:none;width:100%;height:100%")
                                    $('#plot_1st_tool2').attr("style", "display:inline-block;width:100%;height:100%")
                                })
                                $('#plot_2st_data').click(function () {
                                    $('#plot_1st_tool1').attr("style", "display:none;width:100%;height:100%")
                                    $('#plot_2st_tool1').attr("style", "display:inline-block;width:100%;height:100%")
                                    $('#plot_1st_tool2').attr("style", "display:none;width:100%;height:100%")
                                })
                                $('#self_plot_download').click(function () {
                                    var csrf = $('input[name="csrfmiddlewaretoken"]').val();
                                    var self_plot_start_time = $('#self_plot_start_time').val();
                                    var self_plot_end_time = $('#self_plot_end_time').val();
                                    self_plot_object.download(csrf, self_plot_start_time, self_plot_end_time)
                                })
                                //绘制图片时的代码
                                $('#plot_self_button').click(function () {
                                    var plot_title = "请输入标题"
                                    var today = new Date()
                                    var y = today.getFullYear();
                                    var m = today.getMonth() + 1 < 10 ? "0" + (today.getMonth() + 1) : today.getMonth() + 1;
                                    var d = today.getDate() < 10 ? "0" + today.getDate() : today.getDate();
                                    var h = today.getHours() < 10 ? "0" + today.getHours() + ":00:00" : today.getHours() + ":00";
                                    var time = y + "-" + m + "-" + d + " " + h;                            
                                    if($("#self_title_content").val()){
                                        plot_title = $("#self_title_content").val()
                                    }
                                    console.log(plot_title,time)
                                    var csrf = $('input[name="csrfmiddlewaretoken"]').val();
                                    self_plot_object.plot(csrf, map,plot_title,time)
                                })
                                $('#plot_self_flash').click(function () {
                                    var csrf = $('input[name="csrfmiddlewaretoken"]').val();
                                    self_plot_object.flush(csrf)

                                })
                            </script>

                        </div>

                    </div>
                    <div class="tab-pane" id="canvas-2">
                        <div style="width: 100%;height:700px;border: 1px solid black">
                            <div style="width: 100%;height:700px">
                                <div style="display: flex;width: 100%;height:100%;">
                                    <!-- 底图选项 -->
                                    <div class="scrollbar"
                                        style="width: 20%;height:100%;border-right: 1px solid black;overflow-x: hidden;overflow-y:scroll;border-bottom: 1px solid black;">
                                        <button id="county_json" class="btn_shp"
                                            style="width: 90%;height:25%;background-image: url(static/src/shp_county.png);background-size: 100%;background-repeat: no-repeat;border-radius: 10px;margin:10px;"></button>
                                        <button id="sm_json" class="btn_shp"
                                            style="width: 90%;height:25%;background-image: url(static/src/shp_sm.png);background-size: 100%;background-repeat: no-repeat;border-radius: 10px;margin:10px;"></button>
                                        <button id="tt_json" class="btn_shp"
                                            style="width: 90%;height:25%;background-image: url(static/src/shp_tt.png);background-size: 100%;background-repeat: no-repeat;border-radius: 10px;margin:10px;"></button>
                                        <button id="xj_json" class="btn_shp"
                                            style="width: 90%;height:25%;background-image: url(static/src/shp_xj.png);background-size: 100%;background-repeat: no-repeat;border-radius: 10px;margin:10px;"></button>
                                        <button id="lh_json" class="btn_shp"
                                            style="width: 90%;height:25%;background-image: url(static/src/shp_lh.png);background-size: 100%;background-repeat: no-repeat;border-radius: 10px;margin:10px;"></button>
                                        <button id="lq_json" class="btn_shp"
                                            style="width: 90%;height:25%;background-image: url(static/src/shp_lq.png);background-size: 100%;background-repeat: no-repeat;border-radius: 10px;margin:10px;"></button>
                                        <button id="jj_json" class="btn_shp"
                                            style="width: 90%;height:25%;background-image: url(static/src/shp_jj.png);background-size: 100%;background-repeat: no-repeat;border-radius: 10px;margin:10px;"></button>
                                        <button id="hy_json" class="btn_shp"
                                            style="width: 90%;height:25%;background-image: url(static/src/shp_hy.png);background-size: 100%;background-repeat: no-repeat;border-radius: 10px;margin:10px;"></button>
                                        <button id="wl_json" class="btn_shp"
                                            style="width: 90%;height:25%;background-image: url(static/src/shp_wl.png);background-size: 100%;background-repeat: no-repeat;border-radius: 10px;margin:10px;"></button>
                                        <button id="yh_json" class="btn_shp"
                                            style="width: 90%;height:25%;background-image: url(static/src/shp_yh.png);background-size: 100%;background-repeat: no-repeat;border-radius: 10px;margin:10px;"></button>
                                    </div>
                                    <script>
                                        $(".btn_shp").click(function () {
                                            const quick_plot = document.getElementById("quick_plot");
                                            var shp_data = eval(this.id)// 字符串转变量
                                            // console.log("当前",this.id,shp_data)
                                            var new_json = {
                                                type: "FeatureCollection",
                                                features: []
                                            }
                                            if (this.id == "yh_json") {
                                                var sp = eval(this.id)
                                                for (var i = 0; i < sp.geometries.length; i++) {
                                                    var single = {
                                                        type: "Feature",
                                                        geometry: sp.geometries[i]
                                                    }
                                                    new_json.features.push(single)

                                                }
                                                quick_plot_object.geoData = new_json
                                                console.log("玉环", new_json)


                                            }
                                            else {
                                                quick_plot_object.geoData = shp_data
                                            }

                                            quick_plot_object.run(quick_plot)

                                        })

                                    </script>
                                    <div style="width: 80%;height:100%;border-bottom: 1px solid black;">
                                        <div style="width: 100%;height:85%;border-bottom: 1px solid black">
                                            <canvas id="quick_plot"
                                                style="width: 100%;height:100%;background-color: white;"></canvas>

                                        </div>

                                        <script src='static/js/quick_plot.js'></script>
                                        <div style="width: 100%;height:15%;">
                                            <!-- 工具栏 -->
                                            <div
                                                style="display:inline-block;width:100%;height:33%;border-bottom: 1px solid black">
                                                等值线:&nbsp;<input id="taizhou_quick_plot_contour" type="radio"
                                                    checked="checked" name="taizhou_quick_plot_type"
                                                    value="contour">&nbsp;&nbsp;&nbsp;
                                                图示:&nbsp;<input id="taizhou_quick_plot_icon" type="radio"
                                                    name="taizhou_quick_plot_type"
                                                    value="scatter_icon">&nbsp;&nbsp;&nbsp;
                                                <!-- 文字:&nbsp;<input id="taizhou_quick_plot_text" type="radio"
                                                    name="taizhou_quick_plot_type"
                                                    value="scatter_text">&nbsp;&nbsp;&nbsp; -->
                                                图例:&nbsp;<input id="taizhou_quick_plot_pic" type="radio"
                                                    name="taizhou_quick_plot_type"
                                                    value="scatter_pic">&nbsp;&nbsp;&nbsp;

                                                    
                                                    <button id="forward_canvas" class="layui-btn layui-btn-sm layui-btn-primary" style="float: right;">
                                                        <i class="layui-icon layui-icon-next"></i>
                                                    </button>
                                                    <button id="reback_canvas" class="layui-btn layui-btn-sm layui-btn-primary" style="float: right;">
                                                        <i class="layui-icon layui-icon-prev"></i>
                                                    </button>
                                                
                                              
                                                <button id="flash_canvas" class="layui-btn layui-btn-sm layui-btn-primary" style="float: right;">
                                                    <i class="layui-icon layui-icon-refresh-3"></i>
                                                </button>

                                            </div>
                                            <div id="taizhou_quick_plot_type_view0"
                                                style="display:inline-block;width:100%;height:70%;">
                                                <div style="width: 100%;height:20%">

                                                </div>
                                                <div style="width: 100%;height:55%;padding-left:10%">
                                                    <div
                                                        style="width: 80%;height:100%;border: 1px solid black;padding-top: 5px;border-radius:10px;">
                                                        <select id="view0_line"
                                                            style="border:none;">
                                                            <option value="contour">等值线</option>
                                                            <option value="line">曲线</option>
                                                        </select>
                                                        <label> </label>
                                                        <label>颜色</label>
                                                        <div id="quick_color_select_option"></div>
                                                        <label>粗细</label>

                                                        <input id="view0_width" type="number" value=5
                                                            style="width: 6%; height:80%;border: none;;border-radius:5px;">
                                                        <div style="display: inline-block;width:5%;"></div>

                                                        <label>标题:</label>
                                                        <input id="taizhou_quick_plot_text" type="radio"
                                                            name="taizhou_quick_plot_type" value="scatter_text" style="margin-right:10px;">


                                                        <input id="taizhou_quick_plot_text_content" placeholder="请输入文字"
                                                            value="请输入文字" type="text"
                                                            style="width:40%;height:80%;border-radius:5px;">
                                                        <label>字体大小:</label>
                                                        <input id="taizhou_quick_plot_text_size" type="number" max="80"
                                                            min="0" placeholder="25" value=25
                                                            style="width: 6%;height:80%;border-radius:5px;">



                                                    </div>

                                                    <script>
                                                        layui.use('colorpicker', function () {
                                                            var $ = layui.$
                                                                , colorpicker = layui.colorpicker;
                                                            //常规使用
                                                            colorpicker.render({
                                                                elem: '#quick_color_select_option'
                                                                , color: 'black'
                                                                , format: "rgb"
                                                                , predefine: true // 开启预定义颜色
                                                                , colors: ['rgb(255,255,255)', 'rgb(140,246,130)', 'rgb(0,191,27)', 'rgb(62,185,255)', 'rgb(25,0,235)', 'rgb(255,0,255)', 'rgb(140,0,65)','rgb(255,255,255)']
                                                                , done: function (color) {
                                                                    // console.log("颜色", color)
                                                                    if (color != 'none') {
                                                                        quick_plot_object.plotColor = color
                                                                    }

                                                                }
                                                            })
                                                        })

                                                    </script>

                                                </div>



                                                <!-- <select id="view0_color">
                                                    <option value="rgb(255,255,255)">无降水</option>
                                                    <option value="rgb(140,246,130)">零星降水</option>
                                                    <option value="rgb(0,191,27)">小雨</option>
                                                    <option value="rgb(62,185,255)">小到中雨</option>
                                                    <option value="rgb(25,0,235)">中雨</option>
                                                    <option value="rgb(255,0,255)">大雨</option>
                                                    <option value="rgb(140,0,65)">暴雨</option>
                                                </select>
                                                <select id="view0_line">
                                                    <option value="contour">等值线</option>
                                                    <option value="line">曲线</option>
                                                </select>
                                                <label>粗细</label>
                                                <input id="view0_width" type="number" value=3> -->


                                            </div>
                                            <div id="taizhou_quick_plot_type_view1" class="scrollbar"
                                                style="display:none;width:100%;height:70%;;overflow-x: hidden;overflow-y:scroll;">
                                                <img class="icon_scatter" src="static/src/icon/35到37度.png"
                                                    style="width:45px;height:45px;border-radius:5px;padding:2px;margin:2px">
                                                <img class="icon_scatter" src="static/src/icon/6-8级大风.png"
                                                    style="width:45px;height:45px;border-radius:5px;padding:2px;margin:2px">
                                                <img class="icon_scatter" src="static/src/icon/40度以上.png"
                                                    style="width:45px;height:45px;border-radius:5px;padding:2px;margin:2px">
                                                <img class="icon_scatter" src="static/src/icon/7-9级大风.png"
                                                    style="width:45px;height:45px;border-radius:5px;padding:2px;margin:2px">
                                                <img class="icon_scatter" src="static/src/icon/7~9级雷雨大风.png"
                                                    style="width:45px;height:45px;border-radius:5px;padding:2px;margin:2px">



                                            </div>
                                            <!-- <div id="taizhou_quick_plot_type_view2"
                                                style="display:none;width:100%;height:70%;">
                                                内容:&nbsp;<input id="taizhou_quick_plot_text_content" placeholder="请输入文字"
                                                    value="请输入文字" type="text" style="width: 40%;">
                                                大小:&nbsp;<input id="taizhou_quick_plot_text_size" type="number" max="80"
                                                    min="0" placeholder="25" style="width: 6%;">


                                            </div> -->
                                            <div id="taizhou_quick_plot_type_view3"
                                                style="display:none;width:100%;height:70%;border: 3px solid black">
                                                <div style="width: 100%;height:20%">

                                                </div>
                                                <div style="width: 100%;height:55%;padding-left:10%">
                                                    <div
                                                        style="width: 80%;height:100%;">
                                                        <div
                                                            style="display: inline-flex;width:99%;height:100%;border: 1px solid black;;border-radius:10px;padding-left:1.5%;padding-right:1%;padding-top: 3px;">
                                                            <div id="color_select_option"></div>
                                                            <div id="color_select_list" style="width:90%;height:99.5%">
                                                            </div>
                                                            <input id="color_bar_del" type="button" value="-"
                                                                onclick="color_bar_del()"
                                                                style="width: 4%;height: 75%;float: right;">
                                                        </div>
                                                        <script>

                                                            layui.use('colorpicker', function () {
                                                                var $ = layui.$
                                                                    , colorpicker = layui.colorpicker;
                                                                //常规使用
                                                                colorpicker.render({
                                                                    elem: '#color_select_option'
                                                                    , color: 'white'
                                                                    , predefine: true // 开启预定义颜色
                                                                    , colors: [ 'rgb(140,246,130)', 'rgb(0,191,27)', 'rgb(62,185,255)', 'rgb(25,0,235)', 'rgb(255,0,255)', 'rgb(140,0,65)','rgb(255,255,255)']
                                                                    , done: function (color) {
                                                                        // console.log("颜色", color)
                                                                        if (color != 'none') {
                                                                            var add_radio = document.createElement('input')
                                                                            add_radio.style = "border-radius:5px;margin-right:3px"
                                                                            add_radio.style.width = "13%"
                                                                            add_radio.style.height = "90%"
                                                                            add_radio.style.backgroundColor = color
                                                                            add_radio.style.display = "inline-block"
                                                                            add_radio.style.border = "1px solid black"
                                                                            add_radio.setAttribute("class", "color_bar")
                                                                            add_radio.setAttribute("type", "text")
                                                                            $('#color_select_list').append(add_radio)
                                                                        }

                                                                    }
                                                                })
                                                            })
                                                            function color_bar_del() {
                                                                $('#color_select_list').children().last().remove()
                                                            }


                                                        </script>

                                                    </div>
                                                </div>
                                                <!-- 添加颜色的radio -->
                                                <!-- <div id="color_select_list"
                                                    style="display: inline-block;width:100%;height: 40%; "></div>
                                                <div style="width:100%;height: 10%; "></div>

                                                <select id="color_select_option" style="width: 10%;height: 35%;">
                                                    <option style="display:none" value="none"></option>
                                                    <option value="black">黑色</option>
                                                    <option value="green">绿色</option>
                                                    <option value="red">红色</option>
                                                    <option value="blue">蓝色</option>
                                                </select>

                                                <input id="color_bar_del" type="button" value="删除"
                                                    onclick="color_bar_del()"
                                                    style="width: 10%;height: 35%;float: right;"> -->


                                            </div>

                                            <script type="text/javascript">
                                                $('#flash_canvas').click(function () {
                                                    const quick_plot = document.getElementById("quick_plot");
                                                    quick_plot_object.geoData = county_json
                                                    quick_plot_object.run(quick_plot)



                                                })

                                                $('#reback_canvas').click(function () {
                                                    if (quick_plot_object.memory_list.length - 1 > quick_plot_object.click_num) {
                                                        quick_plot_object.ctx_quick_plot.clearRect(0, 0, quick_plot_object.canvasW, quick_plot_object.canvasH)
                                                        quick_plot_object.ctx_quick_plot.putImageData(quick_plot_object.memory_list[quick_plot_object.memory_list.length - 2 - quick_plot_object.click_num], 0, 0);
                                                        quick_plot_object.click_num = quick_plot_object.click_num + 1


                                                    }

                                                })

                                                $('#forward_canvas').click(function () {
                                                    if (quick_plot_object.click_num != 0) {
                                                        quick_plot_object.ctx_quick_plot.clearRect(0, 0, quick_plot_object.canvasW, quick_plot_object.canvasH)
                                                        quick_plot_object.ctx_quick_plot.putImageData(quick_plot_object.memory_list[quick_plot_object.memory_list.length - quick_plot_object.click_num], 0, 0);
                                                        quick_plot_object.click_num = quick_plot_object.click_num - 1

                                                    }
                                                    else {
                                                        quick_plot_object.ctx_quick_plot.clearRect(0, 0, quick_plot_object.canvasW, quick_plot_object.canvasH)
                                                        quick_plot_object.ctx_quick_plot.putImageData(quick_plot_object.memory_list[quick_plot_object.memory_list.length - 1], 0, 0);

                                                    }

                                                })

                                                $('#color_select_option').change(function () {
                                                    var select_color = $('#color_select_option option:selected').val();
                                                    if (select_color != 'none') {
                                                        var add_radio = document.createElement('input')
                                                        add_radio.style.width = "8%"
                                                        add_radio.style.height = "80%"
                                                        add_radio.style.backgroundColor = select_color
                                                        add_radio.style.display = "inline-block"
                                                        add_radio.style.border = "1px solid black"
                                                        add_radio.setAttribute("class", "color_bar")
                                                        add_radio.setAttribute("type", "text")
                                                        $('#color_select_list').append(add_radio)
                                                    }

                                                })

                                                function color_bar_del() {
                                                    $('#color_select_list').children().last().remove()
                                                    quick_plot_object.labelinfo.color.pop()
                                                    quick_plot_object.labelinfo.text.pop()
                                                    // console.log($(".color_bar").val())
                                                }
                                                var el = window.document.body; //声明一个变量，默认值为body
                                                var select_icon_img = []
                                                window.document.body.onmouseover = function (event) {
                                                    el = event.target; //鼠标每经过一个元素，就把该元素赋值给变量el
                                                    var class_name = el.className
                                                    el.addEventListener("click", function () {
                                                        if (class_name == 'icon_scatter') {
                                                            $('.icon_scatter').css("border", "0px")
                                                            el.setAttribute("border", "3px")
                                                            el.style.border = "1px solid black"
                                                            select_icon_img = []
                                                            select_icon_img.push(el)
                                                            console.log(el.className)

                                                        }


                                                    })

                                                }
                                                // var taizhou_quick_plot_type = $("input[name='taizhou_quick_plot_type']:checked").val()

                                                // 前端绘图模块的
                                                $('#taizhou_quick_plot_contour').click(function () {
                                                    $('#taizhou_quick_plot_type_view0').attr("style", "display:inline-block;width:100%;height:70%;border: 3px solid black");
                                                    $('#taizhou_quick_plot_type_view1').attr("style", "display:none;width:100%;height:70%;border: 3px solid black");
                                                    // $('#taizhou_quick_plot_type_view2').attr("style", "display:none;width:100%;height:70%;border: 3px solid black");
                                                    $('#taizhou_quick_plot_type_view3').attr("style", "display:none;width:100%;height:70%;border: 3px solid black");

                                                })

                                                $('#taizhou_quick_plot_icon').click(function () {
                                                    $('#taizhou_quick_plot_type_view0').attr("style", "display:none;width:100%;height:70%;border: 3px solid black");
                                                    $('#taizhou_quick_plot_type_view1').attr("style", "display:inline-block;width:100%;height:70%;border: 3px solid black;;overflow-x: hidden;overflow-y:scroll;");
                                                    // $('#taizhou_quick_plot_type_view2').attr("style", "display:none;width:100%;height:70%;border: 3px solid black");
                                                    $('#taizhou_quick_plot_type_view3').attr("style", "display:none;width:100%;height:70%;border: 3px solid black");

                                                })
                                                // $('#taizhou_quick_plot_text').click(function () {
                                                //     $('#taizhou_quick_plot_type_view0').attr("style", "display:inline-block;width:100%;height:70%;border: 3px solid black");
                                                //     $('#taizhou_quick_plot_type_view1').attr("style", "display:none;width:100%;height:70%;border: 3px solid black");
                                                //     // $('#taizhou_quick_plot_type_view2').attr("style", "display:inline-block;width:100%;height:70%;border: 3px solid black");
                                                //     $('#taizhou_quick_plot_type_view3').attr("style", "display:none;width:100%;height:70%;border: 3px solid black");

                                                // })
                                                $('#taizhou_quick_plot_pic').click(function () {
                                                    $('#taizhou_quick_plot_type_view0').attr("style", "display:none;width:100%;height:70%;border: 3px solid black");
                                                    $('#taizhou_quick_plot_type_view1').attr("style", "display:none;width:100%;height:70%;border: 3px solid black");
                                                    // $('#taizhou_quick_plot_type_view2').attr("style", "display:none;width:100%;height:70%;border: 3px solid black");
                                                    $('#taizhou_quick_plot_type_view3').attr("style", "display:inline-block;width:100%;height:70%;border: 3px solid black");
                                                })



                                            </script>

                                        </div>

                                    </div>




                                </div>

                            </div>

                        </div>


                    </div>
                    <div class="tab-pane" id="canvas-3">
                        <div style="display: flex;width: 100%;height:700px;">
                            <!-- 数据栏 -->
                            <div style="display: flex;width: 20%;height:700px;border: 2px solid ;border-right: none;">
                                <div style="width: 5%;height:700px;padding-top:85%;">
                                                                      
                                </div>
                                <div style="width: 90%;height:700px;">
                                    <!-- 行增加 -->
                                    <div style="width: 100%;height:2%;padding-left:25%;margin-bottom: 2px;">
                                        
                                    </div>
                                    <!-- 选项 -->
                                    <div style="display: inline-flex;width: 100%;height:6%;margin-top:2px;;border: 1px solid ">
                                        <!-- <div style="width: 10%;height:100%;border: 1px solid"></div> -->
                                        <input type="text" id="series_label" placeholder="请输入图题" style="width: 100%;height: 100%;"></input>
                                    
                                    </div>
                                    <!-- 数据 -->
                                    <div style=";width: 100%;height:90%;;border: 2px solid ;border-top:none">
                                        <div style="display: inline-flex;width: 100%;height:5%">
                                            <div style=";width: 5%;height:100%">
                                            </div>
                                            <div id="series_name" style=";width: 95%;height:100%;padding-top:5px">
                                            </div>
                                        </div>
                                        <div style="display: flex;width: 100%;height:90%;">
                                            <div id="index_name" style=";width: 5%;height:100%;border-top: 2px solid ;padding-top: 5px;">
                                            </div>
                                            <div id="data_line"
                                                style="display: flex;;width: 100%;height:100%;border-top: 2px solid ;padding-top: 5px;">
                                            </div>                                     
                                        </div>
                                        <div style="display: flex;width: 100%;height:5%;border-top: 2px solid ;padding-top: 3px;">
                                            <button type="button" id="clonadd" class="layui-btn layui-btn-xs" >添加行</button>
                                            <button type="button" id="clondel" class="layui-btn layui-btn-xs layui-border-orange" >删除行</button>
                                            <button type="button" id="rowadd" class="layui-btn layui-btn-xs" >添加列</button>
                                            <button type="button" id="rowdel" class="layui-btn layui-btn-xs layui-border-orange" >删除列</button>
                                        </div>
                                    </div>                             
                                </div>
                                <script>
                                    var plot_line_obj = {
                                        data: [],
                                        rownum: undefined,
                                        clonnum: undefined,
                                        series: undefined,
                                        xAxis: undefined,
                                        indexnum: undefined,
                                        tmax:100,
                                        tmin:0,
                                        titem:10,
                                        rmax:100,
                                        rmin:0,
                                        ritem:10,
                                        barWidth:10,
                                        lineWidth:1,
                                        initfnc: function () {
                                            this.rownum = 4
                                            this.clonnum = 7
                                            var data_line = document.getElementById("data_line")
                                            var index_div = document.getElementById("index_name")
                                            var series_option_div = document.getElementById("series_option")
                                            for (var j = 0; j < this.clonnum; j++) {
                                                var index_label = document.createElement("div")
                                                index_label.style = "width: 100%;height:5%;padding-top:8px"
                                                index_label.innerText = j.toString()                               
                                                index_div.append(index_label)

                                            }
                                            for (var i = 0; i < this.rownum; i++) {
                                                var data_single_line = document.createElement("div")
                                                data_single_line.style = "width: 20%;height:100%;"
                                                var series_name_div = document.getElementById("series_name")
                                                var series_name = document.createElement("label")
                                                series_name.style = "width: 20%;height:100%;border: 1px solid"
                                                if (i == 0) {
                                                    series_name.innerText = "X"

                                                }
                                                else {
                                                    series_name.innerText = "Y" + i.toString()
                                                }
                                                series_name_div.append(series_name)
                                                var series_option = document.createElement("div")
                                                series_option.style = "width: 10%;height:100%;border: 1px solid"
                                                //选项卡
                                                // if (i != 0) {
                                                //     var select = this.create_select()
                                                //     series_option.append(select)
                                                //     series_option_div.append(series_option)
                                                // }
                                                // else {
                                                //     series_option_div.append(series_option)
                                                // }


                                                for (var j = 0; j < this.clonnum; j++) {

                                                    var single_clon = document.createElement("input")
                                                    single_clon.style = "width: 100%;height:5%;border: 1px solid"
                                                    single_clon.setAttribute("class", "plot_value")
                                                    if (i != 0) {
                                                        single_clon.value = (Math.random() * 100).toFixed(0)
                                                    }

                                                    data_single_line.append(single_clon)
                                                }
                                                data_line.append(data_single_line)
                                            }
                                        },
                                        //列
                                        rowadd: function () {
                                            this.rownum = this.rownum + 1
                                            var data_line = document.getElementById("data_line")
                                            var data_single_line = document.createElement("div")
                                            var series_name_div = document.getElementById("series_name")
                                            var series_option_div = document.getElementById("series_option")
                                            var series_name = document.createElement("label")
                                            series_name.style = "width: 20%;height:100%;border: 1px solid"
                                            if (this.rownum == 0) {
                                                series_name.innerText = "X"

                                            }
                                            else {
                                                series_name.innerText = "Y" + (this.rownum - 1).toString()
                                            }
                                            series_name_div.append(series_name)
                                            // 选项
                                            // var series_option = document.createElement("div")
                                            // series_option.style = "width: 10%;height:100%;border: 1px solid"
                                            // var select = this.create_select()
                                            // series_option.append(select)
                                            // series_option_div.append(series_option)
                                            //
                                            data_single_line.style = "width: 20%;height:100%;"
                                            for (var j = 0; j < this.clonnum; j++) {
                                                var single_clon = document.createElement("input")
                                                single_clon.style = "width: 100%;height:5%;border: 1px solid"
                                                single_clon.setAttribute("class", "plot_value")
                                                data_single_line.append(single_clon)
                                            }
                                            data_line.append(data_single_line)

                                        },
                                        //行
                                        clonadd: function () {
                                            this.clonnum = this.clonnum + 1
                                            var data_line = document.getElementById("data_line")
                                            var line_list = data_line.children
                                            var index_div = document.getElementById("index_name")
                                            var index_label = document.createElement("div")
                                            index_label.innerText = (this.clonnum - 1).toString()
                                            index_label.style = "width: 100%;height:5%;;padding-top:8px"
                                            index_div.append(index_label)

                                            for (var i = 0; i < line_list.length; i++) {
                                                var single_row = line_list[i]
                                                var single_clon = document.createElement("input")
                                                single_clon.style = "width: 100%;height:5%;border: 1px solid"
                                                single_clon.setAttribute("class", "plot_value")
                                                single_row.append(single_clon)
                                            }
                                        },
                                        rowdel: function () {
                                            this.rownum = this.rownum - 1
                                            var data_line = document.getElementById("data_line")
                                            data_line.lastChild.remove()
                                            var series_name_div = document.getElementById("series_name")
                                            series_name_div.lastChild.remove()
                                            // var select_option = document.getElementById("series_option")
                                            // select_option.lastChild.remove()
                                        },
                                        clondel: function () {
                                            this.clonnum = this.clonnum - 1
                                            var data_line = document.getElementById("data_line")
                                            for (var i = 0; i < data_line.childElementCount; i++) {
                                                var single_line = data_line.children[i]
                                                single_line.lastChild.remove()
                                            }
                                            var index_div = document.getElementById("index_name")
                                            index_div.lastChild.remove()
                                        },
                                        create_select: function () {
                                            var select = document.createElement("select")
                                            select.style = "width: 100%;height:100%;border: 1px solid"
                                            var optline = document.createElement("option")
                                            optline.value = 1
                                            optline.innerText = "曲线图"
                                            var optbar = document.createElement("option")
                                            optbar.value = 0
                                            optbar.innerText = "柱状图"
                                            select.setAttribute("class", "select_class")
                                            select.append(optline, optbar)
                                            return select

                                        },
                                        get_select: function () {
                                            var data = [2]
                                            $(".select_class").each(function () {
                                                data.push(this.value)
                                            })
                                            this.indexnum = data
                                        },
                                        getdata: function () {
                                            this.get_select()
                                            var data = []
                                            $(".plot_value").each(function () {
                                                data.push(this.value)
                                            })
                                            //数据列表
                                            var return_data = []
                                            var item_index = 0
                                            var series = []
                                            var axisx = undefined
                                            for (var i = 0; i < this.rownum; i++) {
                                                var single_list = []
                                                for (var j = 0; j < this.clonnum; j++) {
                                                    single_list.push(data[item_index])
                                                    item_index = item_index + 1
                                                }
                                                return_data.push(single_list)
                                                if (i == 0) {
                                                    axisx = single_list
                                                }
                                                else {
                                                    if (this.indexnum[i] == 0) {
                                                        var plot_type = "bar"
                                                        var datasingle = {
                                                            name: 'data' + i.toString(),
                                                            type: plot_type,
                                                            color:"black",
                                                            barWidth: 10,
                                                            // smooth: true,
                                                            yAxisIndex: this.indexnum[i],
                                                            data: single_list
                                                        }
                                                    }
                                                    else {
                                                        var plot_type = "line"
                                                        var datasingle = {
                                                            name: 'data' + i.toString(),
                                                            type: plot_type,
                                                            color:"black",
                                                            lineStyle:{
                                                                width:2
                                                            },
                                                            smooth: true,
                                                            yAxisIndex: this.indexnum[i],
                                                            data: single_list
                                                        }
                                                    }

                                                    series.push(datasingle)

                                                }

                                            }
                                            this.series = series
                                            this.xAxis = axisx
                                        },
                                        plot_all: function () {
                                            const colors = ['#5470C6', '#91CC75', '#EE6666'];
                                            //清除缓存
                                            var chartDom = document.getElementById("line_plot")
                                            if (chartDom.hasAttribute("_echarts_instance_")) {
                                                chartDom.removeAttribute("_echarts_instance_");
                                            }
                                            const lineChart = echarts.init(chartDom);
                                            lineChart.setOption({
                                                color: colors,
                                                backgroundColor: 'white',
                                                title: {
                                                    text: '',
                                                    left: 'middle',
                                                    textStyle: {
                                                        color: '#826'
                                                    }
                                                },
                                                tooltip: {
                                                    triggerOn: 'none',
                                                },
                                                grid: {
                                                    top: '8%',
                                                    right: '6%',
                                                    left: '6%',
                                                    bottom: '8%'
                                                },
                                                xAxis: [
                                                    {
                                                        type: 'category',
                                                        axisTick: {
                                                            alignWithLabel: true
                                                        },
                                                        axisLine: {
                                                            show: true,
                                                            lineStyle: {
                                                                color: "black",
                                                                width:2
                                                            }
                                                        },                                                     
                                                        data: plot_line_obj.xAxis
                                                    }
                                                ],
                                                yAxis: [{
                                                    type: 'value',
                                                    name: '',
                                                    position: 'right',
                                                    alignTicks: true,
                                                    // max: function (value) {
                                                    //     return value.max * 2.5;
                                                    // },
                                                    max:plot_line_obj.rmax,
                                                    min:plot_line_obj.rmin,
                                                    interval: plot_line_obj.ritem,
                                                    axisLine: {
                                                        show: true,
                                                        lineStyle: {
                                                            color: "black",
                                                            width:2
                                                        }
                                                    },
                                                    splitLine: { show: false },
                                                    axisLabel: {
                                                        formatter: '{value} mm'
                                                    }
                                                },
                                                {
                                                    type: 'value',
                                                    name: '',
                                                    position: 'left',
                                                    splitLine: { show: false },
                                                    alignTicks: true,
                                                    // max: function (value) {
                                                    //     return value.max + 3;
                                                    // },
                                                    // min: function (value) {
                                                    //     return value.min - 10;
                                                    // },
                                                    max:plot_line_obj.tmax,
                                                    min:plot_line_obj.tmin,
                                                    interval: plot_line_obj.titem,
                                                    axisLine: {
                                                        show: true,
                                                        lineStyle: {
                                                            color: "black",
                                                            width:2
                                                        }
                                                    },
                                                    axisLabel: {
                                                        formatter: '{value} °C'
                                                    }
                                                }],
                                                series: plot_line_obj.series
                                            });




                                        }

                                    }
                                    plot_line_obj.initfnc()
                                    $("#rowadd").click(function () {
                                        plot_line_obj.rowadd()
                                    })
                                    $("#clonadd").click(function () {
                                        plot_line_obj.clonadd()
                                    })
                                    $("#rowdel").click(function () {
                                        plot_line_obj.rowdel()
                                    })
                                    $("#clondel").click(function () {
                                        plot_line_obj.clondel()
                                    })
                                </script>
                            </div>
                            <div style="width: 80%;height:700px;">
                                <!-- 绘图区 -->
                                <div id="line_plot" style="width: 100%;height:655px;border: 2px solid ;border-bottom: none;">

                                </div>
                                <!-- 按钮组 -->
                                <div style="width: 100%;height:45px;border: 2px solid ;;padding-left:80%;padding-top:5px;">                              
                                    <button id="getdata" class="layui-btn layui-btn-sm layui-btn-primary">
                                        <i class="layui-icon layui-icon-refresh"></i>
                                    </button>

                                    <button id="flushdata" class="layui-btn layui-btn-sm layui-btn-primary">
                                        <i class="layui-icon layui-icon-edit"></i>
                                    </button>

                                    <button id="plot" class="layui-btn layui-btn-sm layui-btn-primary">
                                        <i class="layui-icon layui-icon-triangle-r"></i>
                                    </button>

                                </div>
                                <script>
                                    // $("#getdata").click(function () {
                                    //     plot_line_obj.get_select()
                                    // })
                                    $("#plot").click(function () {
                                        plot_line_obj.getdata()
                                        plot_line_obj.plot_all()
                                    })
                                    

                                    
                                </script>

                            </div>


                        </div>
                    </div>

                </div>
            </div>
        </div>



    </div>
    <!-- 隐藏栏目 -->
    <div id="hidediv"
        style="display: none;;width:420px;height:600px;position:absolute;top:10%;left:35.5%;z-index:100;background-color: white;padding-left:50px;padding-top:50px;">
        <div style="width:325px;height:497px;border: 3px solid black;border-radius:10px;">
            <div id="hidelabel"
                style="width:320px;height:50px;;padding-top:5%;padding-left:5%;">
                <h3>参数设置</h3>
            </div>
            <div id="hideseries" style="width:320px;height:330px;border-top: 3px solid black;border-bottom: 3px solid black;padding-top:2%;margin-bottom:15px;">
            </div>
            <div style="width:320px;height:30px;;padding-left:5px">
                <label>气温:</label>
                &nbsp;
                <label>最小</label>
                &nbsp;
                <input id="tmin" type="number" style="width:45px;height:20px;" value=0></input>
                <label>最大</label>
                &nbsp;
                <input id="tmax" type="number" style="width:45px;height:20px;" value=100></input>
                <label>间隔</label>
                &nbsp;
                <input id="titem" type="number" style="width:45px;height:20px;" value=10></input>
            </div>
            <div style="width:320px;height:30px;;padding-left:5px">
                <label>降水:</label>
                &nbsp;
                <label>最小</label>
                &nbsp;
                <input id="rmin" type="number" style="width:45px;height:20px;" value=0></input>
                <label>最大</label>
                &nbsp;
                <input id="rmax" type="number" style="width:45px;height:20px;" value=100></input>
                <label>间隔</label>
                &nbsp;
                <input id="ritem" type="number" style="width:45px;height:20px;" value=10></input>
            </div>
            <div id="hidebutton" style="width:320px;height:37px;border-top: 5px solid black;padding-right:5%;">
                <button id="self_line_opt_save" class="layui-btn layui-btn-sm layui-btn-primary" style="float: right">
                    <i class="layui-icon layui-icon-triangle-r"></i>
                </button>
                <!-- <button id="self_line_opt_quit" style="width:10%;height:100%;float: right;"></button> -->
                <button id="self_line_opt_quit" class="layui-btn layui-btn-sm layui-btn-primary" style="float: right">
                    <i class="layui-icon layui-icon-logout"></i>
                </button>
    
            </div>
        </div>


    </div>
    <script>
        $("#self_line_opt_quit").click(function () { 
            var hidediv = document.getElementById("hidediv")
            hidediv.style="display:none;;width:420px;height:600px;position:absolute;top:10%;left:35.5%;z-index:100;background-color: white;padding-left:50px;padding-top:50px;" 

        })
        $("#self_line_opt_save").click(function () {        
            // 数据
            plot_line_obj.getdata()
            var item = 0
            $(".hideseries").each(function () {
                console.log(this.children[1].value)
                var type = this.children[1].value
                var color = this.children[3].value
                var width = this.children[5].value
                // console.log(width,typeof(width))
                plot_line_obj.series[item].type = type
                plot_line_obj.series[item].color = color
                if (type=="bar"){
                    console.log(plot_line_obj.series[item].barWidth,"bar")
                    plot_line_obj.series[item].barWidth = parseInt(width)
                }
                else {
                    plot_line_obj.series[item].lineStyle.width= parseInt(width)
                }    
                item = item + 1
            })
            // 坐标轴
            plot_line_obj.tmax =parseFloat($("#tmax").val())
            plot_line_obj.tmin = parseFloat($("#tmin").val())
            plot_line_obj.titem = parseFloat($("#titem").val())
            plot_line_obj.rmax = parseFloat($("#rmax").val())
            plot_line_obj.rmin = parseFloat($("#rmin").val())
            plot_line_obj.ritem = parseFloat($("#ritem").val())
            // console.log("self_line_opt_save",typeof($("#ritem").val()))


            var hidediv = document.getElementById("hidediv")
            hidediv.style="display:none;;width:420px;height:600px;position:absolute;top:10%;left:35.5%;z-index:100;background-color: white;padding-left:50px;padding-top:50px;"
            plot_line_obj.plot_all()
        })
        $("#flushdata").click(function () {
            console.log("flushdata")       
            var hidediv = document.getElementById("hidediv")
            hidediv.style="display: inline-block;;width:420px;height:600px;position:absolute;top:10%;left:35.5%;z-index:100;background-color: white;padding-left:50px;padding-top:50px;"
            // 开始表演
            plot_line_obj.getdata()
            $("#hideseries").html("")
            for (var i = 0; i <plot_line_obj.series.length; i++){
                var singleseries = document.createElement("div");
                singleseries.style = "width:312px;height:30px;border:1px solid black;margin:3px;border-radius: 3px;padding-left:5px;padding-top:3px;"
                singleseries.setAttribute("class","hideseries")
                // 按钮组
                // 类型
                var lab_type = document.createElement("label");
                lab_type.innerText = "类型:"
                lab_type.style = "margin-left:5px"
                var select_type = document.createElement("select");
                select_type.style = "width:70px;height:20px;border: none;;background-color: white;"
                var type_opt1 = document.createElement("option");
                type_opt1.value = "line"
                type_opt1.innerText = "等值线"
                var type_opt2 = document.createElement("option");
                type_opt2.value = "bar"
                type_opt2.innerText = "柱状图"
                select_type.append(type_opt1,type_opt2)
                // 颜色
                var lab_color = document.createElement("label");
                lab_color.style = "margin-left:5px"
                lab_color.innerText = "颜色:"
                var select_color = document.createElement("select");
                select_color.style = "width:60px;height:20px;border: none;;background-color: white;"
                var color_opt1 = document.createElement("option");
                color_opt1.value = "red"
                color_opt1.innerText = "红色"
                var color_opt2 = document.createElement("option");
                color_opt2.value = "blue"
                color_opt2.innerText = "蓝色"
                var color_opt3 = document.createElement("option");
                color_opt3.value = "black"
                color_opt3.innerText = "黑色"
                select_color.append(color_opt1,color_opt2,color_opt3)
                // 宽度
                var lab_width = document.createElement("label");
                lab_width.style = "margin-left:5px"
                lab_width.innerText = "宽度: "
                var input_width = document.createElement("input");
                input_width.style = "width:40px;height:20px;;background-color: white;margin-left:10px"
                input_width.setAttribute("type","number")
                input_width.value = 1
                // 添加
                singleseries.append(lab_type,select_type,lab_color,select_color,lab_width,input_width)
                $("#hideseries").append(singleseries)



            }
        })
    </script>
    
    {% csrf_token %}
</body>

</html>