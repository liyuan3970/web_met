tinymce.PluginManager.add('footer', function(editor, url) {
    
    var openDialog = function (dataajax) {
      var datalist = dataajax.datalist 
      // var html_png = dataajax.html_png
      return editor.windowManager.open({
        title: '材料:',
        body: {
          type: 'panel',
          items: [
            {
              type: 'selectbox', // component type
              name: 'SelectMode', // identifier
              label: '报送模板',
              disabled: true, // disabled state
              size: 1, // number of visible values (optional)
              items: datalist
            }


          ]
        },
        buttons: [
          {
            type: 'cancel',
            text: '关闭'
          },
          {
            type: 'submit',
            text: '插入',
            primary: true
          }
        ],
        onSubmit: function (api) {
          var data = api.getData();
          // console.log(data)
          // 将输入框内容插入到内容区光标位置
          if (data.checkpng){
            editor.insertContent(data.SelectMode);
            api.close();
          }
          else{
            editor.insertContent(data.SelectMode);
            api.close();
          }
          
          
        }
      });
    };
    
    // 注册一个工具栏按钮名称
    editor.ui.registry.addButton('footer', {
      text: '报送单位',
      onAction: function () {
        var csrf = $('input[name="csrfmiddlewaretoken"]').val();
        var contentDocument = tinymce.get('content').getContent();
        // 加载文件头  
        var hearder = list_button_object.render_head_info()
        contentDocument = hearder + contentDocument
        var formData = new FormData();
        formData.append("document", contentDocument);

        $.ajax({
            url: "tinymce/footer",  // 请求的地址
            type: "post",  // 请求方式
            timeout: 2500, //设置延迟上限
            data: {
              'csrfmiddlewaretoken': csrf
            },
            dataType: "json",
            success: function (data) {
                // console.log(data.datalist)                 
                // var datalist = [
                //   { value: 'data_one', text: '气象信息快报' },
                //   { value: 'data_two', text: '重要气象报告' }
                // ]
                openDialog(data);
            }

        })

        // openDialog();
      }
    });
  


  });