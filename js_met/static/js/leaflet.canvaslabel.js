(()=>{var i=[,(t,e,i)=>{"use strict";t.exports=n,t.exports.default=n;var r=i(2);function n(t,e){if(!(this instanceof n))return new n(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function d(t,e){x(t,0,t.children.length,e,t)}function x(t,e,i,n,a){(a=a||p(null)).minX=1/0,a.minY=1/0,a.maxX=-1/0,a.maxY=-1/0;for(var l,o=e;o<i;o++)l=t.children[o],u(a,t.leaf?n(l):l);return a}function u(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function o(t,e){return t.minY-e.minY}function m(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function c(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function h(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(t,e,i,n,a){for(var l,o=[e,i];o.length;)(i=o.pop())-(e=o.pop())<=n||(l=e+Math.ceil((i-e)/n/2)*n,r(t,l,e,i,a),o.push(e,l,l,i))}n.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],n=this.toBBox;if(!h(t,e))return i;for(var a,l,o,r,s=[];e;){for(a=0,l=e.children.length;a<l;a++)o=e.children[a],h(t,r=e.leaf?n(o):o)&&(e.leaf?i.push(o):c(t,r)?this._all(o,i):s.push(o));e=s.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!h(t,e))return!1;for(var n,a,l,o,r=[];e;){for(n=0,a=e.children.length;n<a;n++)if(l=e.children[n],h(t,o=e.leaf?i(l):l)){if(e.leaf||c(t,o))return!0;r.push(l)}e=r.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var n,a=this._build(t.slice(),0,t.length-1,0);return this.data.children.length?this.data.height===a.height?this._splitRoot(this.data,a):(this.data.height<a.height&&(n=this.data,this.data=a,a=n),this._insert(a,this.data.height-a.height-1,!0)):this.data=a,this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=p([]),this},remove:function(t,e){if(!t)return this;for(var i,n,a,l,o=this.data,r=this.toBBox(t),s=[],h=[];o||s.length;){if(o||(o=s.pop(),n=s[s.length-1],i=h.pop(),l=!0),o.leaf&&-1!==(a=function(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}(t,o.children,e)))return o.children.splice(a,1),s.push(o),this._condense(s),this;l||o.leaf||!c(o,r)?n?(i++,o=n.children[i],l=!1):o=null:(s.push(o),h.push(i),o=(n=o).children[i=0])}return this},toBBox:function(t){return t},compareMinX:l,compareMinY:o,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,n){var a,l=i-e+1,o=this._maxEntries;if(l<=o)return d(a=p(t.slice(e,i+1)),this.toBBox),a;n||(n=Math.ceil(Math.log(l)/Math.log(o)),o=Math.ceil(l/Math.pow(o,n-1))),(a=p([])).leaf=!1,a.height=n;var r,s,h,u,f=Math.ceil(l/o),c=f*Math.ceil(Math.sqrt(o));for(g(t,e,i,c,this.compareMinX),r=e;r<=i;r+=c)for(g(t,r,h=Math.min(r+c-1,i),f,this.compareMinY),s=r;s<=h;s+=f)u=Math.min(s+f-1,h),a.children.push(this._build(t,s,u,n-1));return d(a,this.toBBox),a},_chooseSubtree:function(t,e,i,n){for(var a,l,o,r,s,h,u,f,c;;){if(n.push(e),e.leaf||n.length-1===i)break;for(h=u=1/0,a=0,l=e.children.length;a<l;a++)s=m(o=e.children[a]),f=t,c=o,(f=(Math.max(c.maxX,f.maxX)-Math.min(c.minX,f.minX))*(Math.max(c.maxY,f.maxY)-Math.min(c.minY,f.minY))-s)<u?(u=f,h=s<h?s:h,r=o):f===u&&s<h&&(h=s,r=o);e=r||e.children[0]}return e},_insert:function(t,e,i){var n=this.toBBox,i=i?t:n(t),a=[],n=this._chooseSubtree(i,this.data,e,a);for(n.children.push(t),u(n,i);0<=e&&a[e].children.length>this._maxEntries;)this._split(a,e),e--;this._adjustParentBBoxes(i,a,e)},_split:function(t,e){var i=t[e],n=i.children.length,a=this._minEntries;this._chooseSplitAxis(i,a,n);n=this._chooseSplitIndex(i,a,n),n=p(i.children.splice(n,i.children.length-n));n.height=i.height,n.leaf=i.leaf,d(i,this.toBBox),d(n,this.toBBox),e?t[e-1].children.push(n):this._splitRoot(i,n)},_splitRoot:function(t,e){this.data=p([t,e]),this.data.height=t.height+1,this.data.leaf=!1,d(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){for(var n,a,l,o,r,s,h,u,f,c=l=1/0,d=e;d<=i-e;d++)n=x(t,0,d,this.toBBox),a=x(t,d,i,this.toBBox),r=n,s=a,f=u=h=void 0,h=Math.max(r.minX,s.minX),u=Math.max(r.minY,s.minY),f=Math.min(r.maxX,s.maxX),s=Math.min(r.maxY,s.maxY),u=Math.max(0,f-h)*Math.max(0,s-u),a=m(n)+m(a),u<c?(c=u,o=d,l=a<l?a:l):u===c&&a<l&&(l=a,o=d);return o},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:l,a=t.leaf?this.compareMinY:o;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,a)&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);for(var a,l=this.toBBox,o=x(t,0,e,l),r=x(t,i-e,i,l),s=f(o)+f(r),h=e;h<i-e;h++)a=t.children[h],u(o,t.leaf?l(a):a),s+=f(o);for(h=i-e-1;e<=h;h--)a=t.children[h],u(r,t.leaf?l(a):a),s+=f(r);return s},_adjustParentBBoxes:function(t,e,i){for(var n=i;0<=n;n--)u(e[n],t)},_condense:function(t){for(var e,i=t.length-1;0<=i;i--)0===t[i].children.length?0<i?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():d(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},function(t){t.exports=function(){"use strict";function t(t,e,i,n,a){m(t,e,i||0,n||t.length-1,a||l)}function m(t,e,i,n,a){while(n>i){if(n-i>600){var l=n-i+1;var o=e-i+1;var r=Math.log(l);var s=.5*Math.exp(2*r/3);var h=.5*Math.sqrt(r*s*(l-s)/l)*(o-l/2<0?-1:1);var u=Math.max(i,Math.floor(e-o*s/l+h));var f=Math.min(n,Math.floor(e+(l-o)*s/l+h));m(t,e,u,f,a)}var c=t[e];var d=i;var x=n;p(t,i,e);if(a(t[n],c)>0)p(t,i,n);while(d<x){p(t,d,x);d++;x--;while(a(t[d],c)<0)d++;while(a(t[x],c)>0)x--}if(a(t[i],c)===0)p(t,i,x);else{x++;p(t,x,n)}if(x<=e)i=x+1;if(e<=x)n=x-1}}function p(t,e,i){var n=t[e];t[e]=t[i];t[i]=n}function l(t,e){return t<e?-1:t>e?1:0}return t}()}],n={};function a(t){var e=n[t];if(void 0!==e)return e.exports;e=n[t]={exports:{}};return i[t].call(e.exports,e,e.exports,a),e.exports}a.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return a.d(e,{a:e}),e},a.d=(t,e)=>{for(var i in e)a.o(e,i)&&!a.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),a.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var e={};(()=>{"use strict";a.r(e);var t=a(1),s=a.n(t);L.CanvasLabel=L.Canvas.extend({options:{defaultLabelStyle:{offsetX:0,offsetY:0,scale:1,rotation:0,text:null,minZoom:null,maxZoom:null,collisionFlg:!0,center:null,zIndex:0,defaultHeight:20,font:"10px sans-serif",fillStyle:"rgba(0,0,0,1)",lineCap:"round",lineDash:[],lineDashOffset:0,lineJoin:"round",strokeStyle:"rgba(0,0,0,1)",textAlign:"center",textBaseline:"middle",lineWidth:1}},initialize:function(t){t.defaultLabelStyle=t.defaultLabelStyle||{},console.log(t.defaultLabelStyle||{}),t.defaultLabelStyle=L.extend({},this.options.defaultLabelStyle,t.defaultLabelStyle),console.log(t),L.Canvas.prototype.initialize.call(this,t)},_update:function(){this._latlngBounds=this._map.getBounds().pad(this.options.padding),L.Canvas.prototype._update.call(this)},_draw:function(){this._textBounds?this._textBounds.clear():this._textBounds=new(s());let e=[];var t,i,n=this._redrawBounds;this._ctx.save(),n&&(i=n.getSize(),this._ctx.beginPath(),this._ctx.rect(n.min.x,n.min.y,i.x,i.y),this._ctx.clip()),this._drawing=!0;for(var a=this._drawFirst;a;a=a.next)t=a.layer,(!n||t._pxBounds&&t._pxBounds.intersects(n))&&e.push(t);for(let t=0;t<e.length;t++)e[t]._updatePath();let l=e.filter(function(t){return t.options.labelStyle&&t.options.labelStyle.text}),o=l.filter(t=>{return 1!=(null!=t.options.labelStyle.collisionFlg?t.options.labelStyle:this.options.defaultLabelStyle).collisionFlg});o.sort((t,e)=>{return(t.options.labelStyle.zIndex||this.options.defaultLabelStyle.zIndex)-(e.options.labelStyle.zIndex||this.options.defaultLabelStyle.zIndex)}).forEach(t=>{this._updateText(this._ctx,t)});let r=l.filter(t=>{return 1==(null!=t.options.labelStyle.collisionFlg?t.options.labelStyle:this.options.defaultLabelStyle).collisionFlg});r.sort((t,e)=>{return-(t.options.labelStyle.zIndex||this.options.defaultLabelStyle.zIndex)+(e.options.labelStyle.zIndex||this.options.defaultLabelStyle.zIndex)}).forEach(t=>{this._updateText(this._ctx,t)}),this._drawing=!1,this._ctx.restore()},_updateText:function(a,l){if(l.options.labelStyle&&l.options.labelStyle.text){var o=L.latLng(l.options.labelStyle.center);if(!o)if(l.getLatLng)o=l.getLatLng();else{if(0==l._parts.length||0==l._parts[0].length)return;o=l.getCenter()}if(this._latlngBounds.contains(o)){let t=l.options.labelStyle;var r=L.extend({},this.options.defaultLabelStyle);"function"==typeof t&&(t=t(l));var s=L.extend(r,l.options.labelStyle);if(!(s.minZoom&&this._map.getZoom()<s.minZoom||s.maxZoom&&this._map.getZoom()>s.maxZoom)){a.save(),a.font=s.font,a.fillStyle=s.fillStyle,a.lineCap=s.lineCap,a.lineDash=s.lineDash,a.lineDashOffset=s.lineDashOffset,a.lineJoin=s.lineJoin,a.strokeStyle=s.strokeStyle,a.textAlign=s.textAlign,a.textBaseline=s.textBaseline,a.lineWidth=s.lineWidth;var h=s.offsetX,r=s.offsetY,l=this._map.latLngToLayerPoint(o),o=l.x+h,h=l.y+r;a.translate(o,h),1!=s.scale&&a.scale(s.scale,s.scale),0!=s.rotation&&a.rotate(s.rotation);l=a.measureText(s.text).width*s.scale,r=s.defaultHeight*s.scale;let t,e,i,n;"center"==s.textAlign?(t=o-l/2,i=o+l/2):"start"==s.textAlign||"left"==s.textAlign?(t=o,i=o+l):"end"==s.textAlign||"right"==s.textAlign?(t=o-l,i=o):console.error("textAlign的值必须是start，end，left，center，right中的一个！"),"middle"==s.textBaseline?(e=h-r/2,n=h+r/2):"top"==s.textBaseline||"hanging"==s.textBaseline?(e=h,n=h+r):"bottom"==s.textBaseline||"alphabetic"==s.textBaseline?(e=h-r,n=h):console.error("textBaseline的值必须是middle，top，hanging，bottom，alphabetic中的一个！");h={minX:t,minY:e,maxX:i,maxY:n};1==s.collisionFlg&&this._textBounds.collides(h)||(a.strokeText(s.text,0,0),a.fillText(s.text,0,0),this._textBounds.insert(h)),a.restore()}}}}})})()})();